@rule With(List(Set(~a, Coeff(~Q6, ~x, 0)), Set(~b, Coeff(~Q6, ~x, 2)), Set(~c, Coeff(~Q6, ~x, 3)), Set(~d, Coeff(~Q6, ~x, 4)), Set(~e, Coeff(~Q6, ~x, 6))), Condition((((~a)^(-2~p))*(3^(-3~p)))*integrate(ExpandIntegrand(((3~a + ~b*((~x)^2) + 3~x*(Rt(~a, 3)^2)*Rt(~c, 3))^~p)*((3~a + ~b*((~x)^2) + 3~x*((-1)^((2//1)*(1//3)))*(Rt(~a, 3)^2)*Rt(~c, 3))^~p)*((3~a + ~b*((~x)^2) - 3~x*((-1)^(3^-1))*(Rt(~a, 3)^2)*Rt(~c, 3))^~p), ~x), ~x), And(EqQ((~b)^2 - 3~a*~d, 0), EqQ((~b)^3 - 27~e*((~a)^2), 0)))) => integrate(((~d + ~e*((~x)^4))^-1)*sqrt(~v), ~x)

@rule With(List(Set(~a, Coeff(~v, ~x, 0)), Set(~b, Coeff(~v, ~x, 2)), Set(~c, Coeff(~v, ~x, 4))), Condition(~a*((~d)^-1)*Subst(integrate((1 + ((~x)^4)*((~b)^2 - 4~a*~c) - 2~b*((~x)^2))^-1, ~x), ~x, ~x*(sqrt(~v)^-1)), And(EqQ(~c*~d + ~a*~e, 0), PosQ(~a*~c)))) => integrate(((~d + ~e*((~x)^4))^-1)*sqrt(~a + ~b*((~x)^2) + ~c*((~x)^4)), ~x)

@rule With(List(Set(~q, sqrt((~b)^2 - 4~a*~c))), ~a*(0.35355339059327373((~d)^-1)*(Rt(-~a*~c, 2)^-1))*sqrt(~q - ~b)*ArcTanh(~x*(~b + ~q + 2~c*((~x)^2))*(0.35355339059327373(sqrt(~a + ~b*((~x)^2) + ~c*((~x)^4))^-1)*(Rt(-~a*~c, 2)^-1))*sqrt(~q - ~b)) - ~a*(0.35355339059327373((~d)^-1)*(Rt(-~a*~c, 2)^-1))*sqrt(~b + ~q)*ArcTan(~x*(~b + 2~c*((~x)^2) - ~q)*(0.35355339059327373(sqrt(~a + ~b*((~x)^2) + ~c*((~x)^4))^-1)*(Rt(-~a*~c, 2)^-1))*sqrt(~b + ~q))) => integrate(((~P)^~p)*((~Q)^~q), ~x)

@rule With(List(Set(~PP, Factor(ReplaceAll(~P, Rule(~x, sqrt(~x)))))), Condition(integrate(ExpandIntegrand(((~Q)^~q)*(ReplaceAll(~PP, Rule(~x, (~x)^2))^~p), ~x), ~x), Not(SumQ(NonfreeFactors(~PP, ~x))))) => integrate(((~P)^~p)*((~Q)^~q), ~x)

@rule With(List(Set(~PP, Factor(~P))), Condition(integrate(ExpandIntegrand((~PP^~p)*((~Q)^~q), ~x), ~x), Not(SumQ(NonfreeFactors(~PP, ~x))))) => integrate(~Qm*((~P)^~p), ~x)

@rule With(List(Set(~PP, Factor(~P))), Condition(integrate(ExpandIntegrand(~Qm*(~PP^~p), ~x), ~x), QuadraticProductQ(~PP, ~x))) => integrate(((~e + ~f*~x)^~m)*((~a + ~b*~x + ~d*((~x)^3))^~p), ~x)

@rule (((~a)^(-2~p))*(3^(-3~p)))*integrate(((~e + ~f*~x)^~m)*((3~a - ~b*~x)^~p)*((3~a + 2~b*~x)^(2~p)), ~x) => integrate(((~e + ~f*~x)^~m)*((~a + ~b*~x + ~d*((~x)^3))^~p), ~x)

@rule ((~a + ~b*~x + ~d*((~x)^3))^~p)*(((3~a - ~b*~x)^(-~p))*((3~a + 2~b*~x)^(-2~p)))*integrate(((~e + ~f*~x)^~m)*((3~a - ~b*~x)^~p)*((3~a + 2~b*~x)^(2~p)), ~x) => integrate(((~e + ~f*~x)^~m)*((~a + ~b*~x + ~d*((~x)^3))^~p), ~x)

@rule integrate(ExpandIntegrand(((~e + ~f*~x)^~m)*((~a + ~b*~x + ~d*((~x)^3))^~p), ~x), ~x) => integrate(((~e + ~f*~x)^~m)*((~a + ~b*~x + ~d*((~x)^3))^~p), ~x)

@rule With(List(Set(~r, Rt(1.7320508075688772~d*sqrt(4~d*((~b)^3) + 27((~a)^2)*((~d)^2)) - 9~a*((~d)^2), 3))), ((~d)^(-2~p))*integrate(((~e + ~f*~x)^~m)*(Simp(~d*~x + ~b*~d*((1//3)*((~r)^-1))*(18^(3^-1)) - ~r*(18^(-(1//3))), ~x)^~p)*(Simp(((~d)^2)*((~x)^2) + ((~r)^2)*((1//3)*(12^(-(1//3)))) + (1//3)*~b*~d + ((~b)^2)*((~d)^2)*((1//3)*((~r)^-2))*(12^(3^-1)) - ~d*~x*(~b*~d*(((~r)^-1)*(3^(-(1//3))))*(2^(3^-1)) - ~r*(18^(-(1//3)))), ~x)^~p), ~x)) => integrate(((~e + ~f*~x)^~m)*((~a + ~b*~x + ~d*((~x)^3))^~p), ~x)

@rule With(List(Set(~r, Rt(1.7320508075688772~d*sqrt(4~d*((~b)^3) + 27((~a)^2)*((~d)^2)) - 9~a*((~d)^2), 3))), ((~a + ~b*~x + ~d*((~x)^3))^~p)*((Simp(~d*~x + ~b*~d*((1//3)*((~r)^-1))*(18^(3^-1)) - ~r*(18^(-(1//3))), ~x)^(-~p))*(Simp(((~d)^2)*((~x)^2) + ((~r)^2)*((1//3)*(12^(-(1//3)))) + (1//3)*~b*~d + ((~b)^2)*((~d)^2)*((1//3)*((~r)^-2))*(12^(3^-1)) - ~d*~x*(~b*~d*(((~r)^-1)*(3^(-(1//3))))*(2^(3^-1)) - ~r*(18^(-(1//3)))), ~x)^(-~p)))*integrate(((~e + ~f*~x)^~m)*(Simp(~d*~x + ~b*~d*((1//3)*((~r)^-1))*(18^(3^-1)) - ~r*(18^(-(1//3))), ~x)^~p)*(Simp(((~d)^2)*((~x)^2) + ((~r)^2)*((1//3)*(12^(-(1//3)))) + (1//3)*~b*~d + ((~b)^2)*((~d)^2)*((1//3)*((~r)^-2))*(12^(3^-1)) - ~d*~x*(~b*~d*(((~r)^-1)*(3^(-(1//3))))*(2^(3^-1)) - ~r*(18^(-(1//3)))), ~x)^~p), ~x)) => integrate((~P3^~p)*((~e + ~f*~x)^~m), ~x)

@rule With(List(Set(~a, Coeff(~P3, ~x, 0)), Set(~b, Coeff(~P3, ~x, 1)), Set(~c, Coeff(~P3, ~x, 2)), Set(~d, Coeff(~P3, ~x, 3))), Condition(Subst(integrate(((~f*~x + (3~d*~e - ~c*~f)*((1//3)*((~d)^-1)))^~m)*(Simp(~d*((~x)^3) + (2((~c)^3) + 27~a*((~d)^2) - 9~b*~c*~d)*((1//27)*((~d)^-2)) - ~x*((~c)^2 - 3~b*~d)*((1//3)*((~d)^-1)), ~x)^~p), ~x), ~x, ~x + ~c*((1//3)*((~d)^-1))), NeQ(~c, 0))) => integrate(~x*(sqrt(~a + ~b*~x + ~c*((~x)^2) + ~e*((~x)^4))^-1), ~x)

@rule With(List(Set(~Px, (1//320)*(40~e*((~a)^2) + 6~a*((~c)^2) + 33~c*((~b)^2)) + ((~e)^3)*((~x)^8) + 2~c*((~e)^2)*((~x)^6) + (1//4)*~e*((~x)^4)*(5((~c)^2) + 4~a*~e) + 4*(1//3)*~b*((~e)^2)*((~x)^5) + 22*(1//15)*~b*~c*~e*((~x)^3) - 22*(1//5)*~a*~c*~e*((~x)^2))), ((1//8)*(Rt(~e, 2)^-1))*Log(~Px + sqrt(~a + ~b*~x + ~c*((~x)^2) + ~e*((~x)^4))*Dist((8~x*Rt(~e, 2))^-1, D(~Px, ~x), ~x))) => integrate((~A + ~B*~x)*(sqrt(~a + ~b*~x + ~c*((~x)^2) + ~d*((~x)^3) + ~e*((~x)^4))^-1), ~x)

@rule ~B*Subst(integrate(~x*(sqrt(~e*((~x)^4) + (256~a*((~e)^3) + 16~c*~e*((~d)^2) - 3((~d)^4) - 64~b*~d*((~e)^2))*((1//256)*((~e)^-3)) + ~x*((~d)^3 + 8~b*((~e)^2) - 4~c*~d*~e)*((1//8)*((~e)^-2)) - ((~x)^2)*(3((~d)^2) - 8~c*~e)*((1//8)*((~e)^-1)))^-1), ~x), ~x, ~x + ~d*((1//4)*((~e)^-1))) => integrate((~f + ~g*((~x)^2))*(((~d + ~d*((~x)^2) + ~e*~x)^-1)*(sqrt(~a + ~b*~x + ~c*((~x)^2) + ~b*((~x)^3) + ~a*((~x)^4))^-1)), ~x)

@rule ~a*~f*(((~d)^-1)*(Rt(((~a)^2)*(2~a - ~c), 2)^-1))*ArcTan((~a*~b + ~x*((~b)^2 + 4((~a)^2) - 2~a*~c) + ~a*~b*((~x)^2))*((1//2)*(sqrt(~a + ~b*~x + ~c*((~x)^2) + ~b*((~x)^3) + ~a*((~x)^4))^-1)*(Rt(((~a)^2)*(2~a - ~c), 2)^-1))) => integrate((~f + ~g*((~x)^2))*(((~d + ~d*((~x)^2) + ~e*~x)^-1)*(sqrt(~a + ~b*~x + ~c*((~x)^2) + ~b*((~x)^3) + ~a*((~x)^4))^-1)), ~x)

@rule -~a*~f*(((~d)^-1)*(Rt(-((~a)^2)*(2~a - ~c), 2)^-1))*ArcTanh((~a*~b + ~x*((~b)^2 + 4((~a)^2) - 2~a*~c) + ~a*~b*((~x)^2))*((1//2)*(sqrt(~a + ~b*~x + ~c*((~x)^2) + ~b*((~x)^3) + ~a*((~x)^4))^-1)*(Rt(-((~a)^2)*(2~a - ~c), 2)^-1))) => integrate(~P3*((~a + ~b*~x + ~c*((~x)^2) + ~d*((~x)^3) + ~e*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, sqrt((~b)^2 + 8((~a)^2) - 4~a*~c)), Set(~A, Coeff(~P3, ~x, 0)), Set(~B, Coeff(~P3, ~x, 1)), Set(~C, Coeff(~P3, ~x, 2)), Set(~D, Coeff(~P3, ~x, 3))), ((~q)^-1)*integrate((~A*~b + ~A*~q + ~x*(~D*~b + ~D*~q + 2~A*~a - 2~C*~a) + 2~D*~a - 2~B*~a)*((2~a + ~x*(~b + ~q) + 2~a*((~x)^2))^-1), ~x) - ((~q)^-1)*integrate((~A*~b + ~x*(~D*~b + 2~A*~a - 2~C*~a - ~D*~q) + 2~D*~a - ~A*~q - 2~B*~a)*((2~a + ~x*(~b - ~q) + 2~a*((~x)^2))^-1), ~x)) => integrate(~P3*((~x)^~m)*((~a + ~b*~x + ~c*((~x)^2) + ~d*((~x)^3) + ~e*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, sqrt((~b)^2 + 8((~a)^2) - 4~a*~c)), Set(~A, Coeff(~P3, ~x, 0)), Set(~B, Coeff(~P3, ~x, 1)), Set(~C, Coeff(~P3, ~x, 2)), Set(~D, Coeff(~P3, ~x, 3))), ((~q)^-1)*integrate((~A*~b + ~A*~q + ~x*(~D*~b + ~D*~q + 2~A*~a - 2~C*~a) + 2~D*~a - 2~B*~a)*((~x)^~m)*((2~a + ~x*(~b + ~q) + 2~a*((~x)^2))^-1), ~x) - ((~q)^-1)*integrate((~A*~b + ~x*(~D*~b + 2~A*~a - 2~C*~a - ~D*~q) + 2~D*~a - ~A*~q - 2~B*~a)*((~x)^~m)*((2~a + ~x*(~b - ~q) + 2~a*((~x)^2))^-1), ~x)) => integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2) + ~d*((~x)^3) + ~e*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, Rt(~C*(~C*((~d)^2 - 4~c*~e) + 2~e*(~B*~d - 4~A*~e)), 2))), 2((~C)^2)*((~q)^-1)*ArcTanh(~C*(12~A*~B*~e + 4~B*~C*~c + 4~C*~x*(2~A*~e + 2~C*~c - ~B*~d) + 8~e*((~C)^2)*((~x)^3) + 4~C*((~x)^2)*(2~C*~d - ~B*~e) - 3~d*((~B)^2) - 4~A*~C*~d)*(((~q)^-1)*(((~B)^2 - 4~A*~C)^-1))) - 2((~C)^2)*((~q)^-1)*ArcTanh((~C*~d + 2~C*~e*~x - ~B*~e)*((~q)^-1))) => integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2) + ~d*((~x)^3) + ~e*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, Rt(~C*(~C*((~d)^2 - 4~c*~e) - 8~A*((~e)^2)), 2))), 2((~C)^2)*((~q)^-1)*ArcTanh(~C*(~A*~d - ~x*(2~A*~e + 2~C*~c) - 2~C*~d*((~x)^2) - 2~C*~e*((~x)^3))*(((~A)^-1)*((~q)^-1))) - 2((~C)^2)*((~q)^-1)*ArcTanh(~C*(~d + 2~e*~x)*((~q)^-1))) => integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2) + ~d*((~x)^3) + ~e*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, Rt(-~C*(~C*((~d)^2 - 4~c*~e) + 2~e*(~B*~d - 4~A*~e)), 2))), 2((~C)^2)*((~q)^-1)*ArcTan((~C*~d + 2~C*~e*~x - ~B*~e)*((~q)^-1)) - 2((~C)^2)*((~q)^-1)*ArcTan(~C*(12~A*~B*~e + 4~B*~C*~c + 4~C*~x*(2~A*~e + 2~C*~c - ~B*~d) + 8~e*((~C)^2)*((~x)^3) + 4~C*((~x)^2)*(2~C*~d - ~B*~e) - 3~d*((~B)^2) - 4~A*~C*~d)*(((~q)^-1)*(((~B)^2 - 4~A*~C)^-1)))) => integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2) + ~d*((~x)^3) + ~e*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, Rt(-~C*(~C*((~d)^2 - 4~c*~e) - 8~A*((~e)^2)), 2))), 2((~C)^2)*((~q)^-1)*ArcTan(((~q)^-1)*(~C*~d + 2~C*~e*~x)) - 2((~C)^2)*((~q)^-1)*ArcTan(-~C*(~x*(2~A*~e + 2~C*~c) + 2~C*~d*((~x)^2) + 2~C*~e*((~x)^3) - ~A*~d)*(((~A)^-1)*((~q)^-1)))) => integrate(~Px*(~P4^~p), ~x)

@rule With(List(Set(~a, Coeff(~P4, ~x, 0)), Set(~b, Coeff(~P4, ~x, 1)), Set(~c, Coeff(~P4, ~x, 2)), Set(~d, Coeff(~P4, ~x, 3)), Set(~e, Coeff(~P4, ~x, 4))), Condition(((~a)^(-3~p))*integrate(ExpandIntegrand(~Px*((~a - ~b*~x)^(-~p))*(((~a)^5 - ((~b)^5)*((~x)^5))^~p), ~x), ~x), And(NeQ(~a, 0), EqQ(~c, ((~a)^-1)*((~b)^2)), EqQ(~d, ((~a)^-2)*((~b)^3)), EqQ(~e, ((~a)^-3)*((~b)^4))))) => integrate((~A + ~B*((~x)^~n))*((~a + ~b*((~x)^2) + ~c*((~x)^~n) + ~d*((~x)^~n2))^-1), ~x)

@rule ((~A)^2)*(~n - 1)*Subst(integrate((~a + ~b*((~A)^2)*((~x)^2)*((~n - 1)^2))^-1, ~x), ~x, ~x*((~A*(~n - 1) - ~B*((~x)^~n))^-1)) => integrate((~A + ~B*((~x)^~n))*((~x)^~m)*((~a + ~b*((~x)^~k) + ~c*((~x)^~n) + ~d*((~x)^~n2))^-1), ~x)

@rule (1 + ~m - ~n)*((~A)^2)*((1 + ~m)^-1)*Subst(integrate((~a + ~b*((~A)^2)*((~x)^2)*((1 + ~m - ~n)^2))^-1, ~x), ~x, ((~x)^(1 + ~m))*((~A*(1 + ~m - ~n) + ~B*(1 + ~m)*((~x)^~n))^-1)) => integrate((~a + ~b*((~x)^2) + ~c*((~x)^4))*((~d + ~e*((~x)^2) + ~f*((~x)^4) + ~g*((~x)^6))^-1), ~x)

@rule With(List(Set(~q, Rt((~f*(3~d*((~c)^2) - 2~a*~b*~g) + 12((~a)^2)*((~g)^2) - ~a*~c*((~f)^2))*(((~c)^-1)*((~g)^-1)*((3~c*~d - ~a*~f)^-1)), 2)), Set(~r, Rt((~a*~c*((~f)^2) + 4~g*(~g*((~a)^2) + ~b*~c*~d) - ~f*(3~d*((~c)^2) + 2~a*~b*~g))*(((~c)^-1)*((~g)^-1)*((3~c*~d - ~a*~f)^-1)), 2))), ~c*(((~g)^-1)*((~q)^-1))*ArcTan(((~q)^-1)*(~r + 2~x)) - ~c*(((~g)^-1)*((~q)^-1))*ArcTan(((~q)^-1)*(~r - 2~x)) - ~c*(((~g)^-1)*((~q)^-1))*ArcTan(~x*(3~c*~d - ~a*~f)*(~c*(2((~a)^2)*((~g)^2) + 3~d*~f*((~c)^2) - ~a*~c*((~f)^2) - ~b*~c*~d*~g)*((~x)^2) + ~b*~d*~f*((~c)^2) + 6~b*((~a)^2)*((~g)^2) + ~g*((~c)^2)*((~x)^4)*(3~c*~d - ~a*~f) - 2~c*~f*~g*((~a)^2) - ~a*~f*~g*((~b)^2))*(((~g)^-1)*((~q)^-1)*((~b*~c*~d - 2~g*((~a)^2))^-1)*((~b*~c*~d + 4~g*((~a)^2) - ~a*~b*~f)^-1)))) => integrate((~a + ~c*((~x)^4))*((~d + ~e*((~x)^2) + ~f*((~x)^4) + ~g*((~x)^6))^-1), ~x)

@rule With(List(Set(~q, Rt((12((~a)^2)*((~g)^2) + 3~d*~f*((~c)^2) - ~a*~c*((~f)^2))*(((~c)^-1)*((~g)^-1)*((3~c*~d - ~a*~f)^-1)), 2)), Set(~r, Rt((~a*~c*((~f)^2) + 4((~a)^2)*((~g)^2) - 3~d*~f*((~c)^2))*(((~c)^-1)*((~g)^-1)*((3~c*~d - ~a*~f)^-1)), 2))), ~c*(((~g)^-1)*((~q)^-1))*ArcTan(((~q)^-1)*(~r + 2~x)) - ~c*(((~g)^-1)*((~q)^-1))*ArcTan(((~q)^-1)*(~r - 2~x)) - ~c*(((~g)^-1)*((~q)^-1))*ArcTan(~c*~x*(3~c*~d - ~a*~f)*(2~f*~g*((~a)^2) - (2((~a)^2)*((~g)^2) + 3~d*~f*((~c)^2) - ~a*~c*((~f)^2))*((~x)^2) - ~c*~g*((~x)^4)*(3~c*~d - ~a*~f))*((1//8)*((~a)^-4)*((~g)^-3)*((~q)^-1)))) => integrate(~u*(~Q6^~p), ~x)

@rule With(List(Set(~a, Coeff(~Q6, ~x, 0)), Set(~b, Coeff(~Q6, ~x, 2)), Set(~c, Coeff(~Q6, ~x, 3)), Set(~d, Coeff(~Q6, ~x, 4)), Set(~e, Coeff(~Q6, ~x, 6))), Condition((((~a)^(-2~p))*(3^(-3~p)))*integrate(ExpandIntegrand(~u*((3~a + ~b*((~x)^2) + 3~x*(Rt(~a, 3)^2)*Rt(~c, 3))^~p)*((3~a + ~b*((~x)^2) + 3~x*((-1)^((2//1)*(1//3)))*(Rt(~a, 3)^2)*Rt(~c, 3))^~p)*((3~a + ~b*((~x)^2) - 3~x*((-1)^(3^-1))*(Rt(~a, 3)^2)*Rt(~c, 3))^~p), ~x), ~x), And(EqQ((~b)^2 - 3~a*~d, 0), EqQ((~b)^3 - 27~e*((~a)^2), 0)))) => integrate(~Pm*(~Qn^-1), ~x)

@rule With(List(Set(~m, Expon(~Pm, ~x)), Set(~n, Expon(~Qn, ~x))), Condition(Simplify(~Pm - (((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m)*D(~Qn, ~x))*integrate(~Qn^-1, ~x) + (((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m)*Log(~Qn), And(EqQ(~m, ~n - 1), EqQ(D(Simplify(~Pm - (((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m)*D(~Qn, ~x)), ~x), 0)))) => integrate(~Pm*(~Qn^~p), ~x)

@rule With(List(Set(~m, Expon(~Pm, ~x)), Set(~n, Expon(~Qn, ~x))), Condition(Simplify(~Pm - (((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m)*D(~Qn, ~x))*integrate(~Qn^~p, ~x) + (~Qn^(1 + ~p))*(((~n)^-1)*((1 + ~p)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m), And(EqQ(~m, ~n - 1), EqQ(D(Simplify(~Pm - (((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m)*D(~Qn, ~x)), ~x), 0)))) => integrate(~Pm*(~Qn^-1), ~x)

@rule With(List(Set(~m, Expon(~Pm, ~x)), Set(~n, Expon(~Qn, ~x))), Condition((((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*integrate((~Qn^-1)*ExpandToSum(~Pm*~n*Coeff(~Qn, ~x, ~n) - Coeff(~Pm, ~x, ~m)*D(~Qn, ~x), ~x), ~x) + (((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m)*Log(~Qn), EqQ(~m, ~n - 1))) => integrate(~Pm*(~Qn^~p), ~x)

@rule With(List(Set(~m, Expon(~Pm, ~x)), Set(~n, Expon(~Qn, ~x))), Condition((((~n)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*integrate((~Qn^~p)*ExpandToSum(~Pm*~n*Coeff(~Qn, ~x, ~n) - Coeff(~Pm, ~x, ~m)*D(~Qn, ~x), ~x), ~x) + (~Qn^(1 + ~p))*(((~n)^-1)*((1 + ~p)^-1)*(Coeff(~Qn, ~x, ~n)^-1))*Coeff(~Pm, ~x, ~m), EqQ(~m, ~n - 1))) => integrate(~Pm*(~Qn^~p), ~x)


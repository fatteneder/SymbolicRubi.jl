@rule ((~u)^~m)*(((~v)^(-~m))*(Coefficient(~v, ~x, 1)^-1))*Subst(integrate(((~x)^~m)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p)*SubstFor(~v, ~Pq, ~x), ~x), ~x, ~v) => integrate((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r))^~p, ~x)

@rule integrate(((~a + ~b + ~c)*((~x)^~n))^~p, ~x) => integrate((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r))^~p, ~x)

@rule integrate(((~x)^(~p*~q))*((~a + ~b*((~x)^(~n - ~q)) + ~c*((~x)^(2~n - 2~q)))^~p), ~x) => integrate(sqrt(~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r)), ~x)

@rule (((~x)^(-(1//2)*~q))*(sqrt(~a + ~b*((~x)^(~n - ~q)) + ~c*((~x)^(2~n - 2~q)))^-1))*sqrt(~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))*integrate(((~x)^((1//2)*~q))*sqrt(~a + ~b*((~x)^(~n - ~q)) + ~c*((~x)^(2~n - 2~q))), ~x) => integrate(sqrt(~a*((~x)^2) + ~b*((~x)^~n) + ~c*((~x)^~r))^-1, ~x)

@rule -2((~n - 2)^-1)*Subst(integrate((4~a - ((~x)^2))^-1, ~x), ~x, ~x*(2~a + ~b*((~x)^(~n - 2)))*(sqrt(~a*((~x)^2) + ~b*((~x)^~n) + ~c*((~x)^~r))^-1)) => integrate(sqrt(~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r))^-1, ~x)

@rule ((~x)^((1//2)*~q))*(sqrt(~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))^-1)*sqrt(~a + ~b*((~x)^(~n - ~q)) + ~c*((~x)^(2~n - 2~q)))*integrate((((~x)^((1//2)*~q))*sqrt(~a + ~b*((~x)^(~n - ~q)) + ~c*((~x)^(2~n - 2~q))))^-1, ~x) => integrate((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r))^~p, ~x)

@rule ~x*((1 + ~p*(2~n - ~q))^-1)*((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))^~p) + ~p*(~n - ~q)*((1 + ~p*(2~n - ~q))^-1)*integrate(((~x)^~q)*((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))^(~p - 1))*(2~a + ~b*((~x)^(~n - ~q))), ~x) => integrate((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r))^~p, ~x)

@rule (((~a)^-1)*((1 + ~p)^-1)*((~n - ~q)^-1)*(((~b)^2 - 4~a*~c)^-1))*integrate(((1 + ~p*~q)*((~b)^2 - 2~a*~c) + (1 + ~p)*(~n - ~q)*((~b)^2 - 4~a*~c) + ~b*~c*(1 + ~p*~q + (~n - ~q)*(3 + 2~p))*((~x)^(~n - ~q)))*((~x)^(-~q))*((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))^(1 + ~p)), ~x) - ((~b)^2 + ~b*~c*((~x)^(~n - ~q)) - 2~a*~c)*((~x)^(1 - ~q))*((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))^(1 + ~p))*(((~a)^-1)*((1 + ~p)^-1)*((~n - ~q)^-1)*(((~b)^2 - 4~a*~c)^-1)) => integrate((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r))^~p, ~x)

@rule ((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))^~p)*(((~x)^(-~p*~q))*((~a + ~b*((~x)^(~n - ~q)) + ~c*((~x)^(2~n - 2~q)))^(-~p)))*integrate(((~x)^(~p*~q))*((~a + ~b*((~x)^(~n - ~q)) + ~c*((~x)^(2~n - 2~q)))^~p), ~x) => integrate((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^~r))^~p, ~x)

@rule Unintegrable((~a*((~x)^~q) + ~b*((~x)^~n) + ~c*((~x)^(2~n - ~q)))^~p, ~x) => integrate((~a*((~u)^~q) + ~b*((~u)^~n) + ~c*((~u)^~r))^~p, ~x)


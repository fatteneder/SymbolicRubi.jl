@rule ((~u)^~m)*(((~v)^(-~m))*(Coefficient(~v, ~x, 1)^-1))*Subst(integrate(((~x)^~m)*((~a*((~x)^~j) + ~b*((~x)^~n))^~p), ~x), ~x, ~v) => integrate(((~x)^~m)*((~c + ~d*((~x)^~n))^~q)*((~a*((~x)^~j) + ~b*((~x)^~k))^~p), ~x)

@rule ((~n)^-1)*Subst(integrate(((~x)^(Simplify((1 + ~m)*((~n)^-1)) - 1))*((~c + ~d*~x)^~q)*((~a*((~x)^Simplify(~j*((~n)^-1))) + ~b*((~x)^Simplify(~k*((~n)^-1))))^~p), ~x), ~x, (~x)^~n) => integrate(((~c + ~d*((~x)^~n))^~q)*((~a*((~x)^~j) + ~b*((~x)^~k))^~p)*((~e*~x)^~m), ~x)

@rule ((~e)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~e*~x)^FracPart(~m))*integrate(((~x)^~m)*((~c + ~d*((~x)^~n))^~q)*((~a*((~x)^~j) + ~b*((~x)^~k))^~p), ~x) => integrate((~c + ~d*((~x)^~n))*((~a*((~x)^~j) + ~b*((~x)^~jn))^~p)*((~e*~x)^~m), ~x)

@rule ~c*((~e)^(~j - 1))*(((~a)^-1)*((1 + ~m + ~j*~p)^-1))*((~a*((~x)^~j) + ~b*((~x)^(~j + ~n)))^(1 + ~p))*((~e*~x)^(1 + ~m - ~j)) => integrate((~c + ~d*((~x)^~n))*((~a*((~x)^~j) + ~b*((~x)^~jn))^~p)*((~e*~x)^~m), ~x)

@rule -((~e)^~j)*(~a*~d*(1 + ~m + ~j*~p) - ~b*~c*(1 + ~m + ~n + ~p*(~j + ~n)))*(((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a*((~x)^~j) + ~b*((~x)^(~j + ~n)))^(1 + ~p))*((~e*~x)^(~m - ~j)), ~x) - ((~e)^(~j - 1))*((~a*((~x)^~j) + ~b*((~x)^(~j + ~n)))^(1 + ~p))*(~b*~c - ~a*~d)*((~e*~x)^(1 + ~m - ~j))*(((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate((~c + ~d*((~x)^~n))*((~a*((~x)^~j) + ~b*((~x)^~jn))^~p)*((~e*~x)^~m), ~x)

@rule (~a*~d*(1 + ~m + ~j*~p) - ~b*~c*(1 + ~m + ~n + ~p*(~j + ~n)))*(((~a)^-1)*((~e)^(-~n))*((1 + ~m + ~j*~p)^-1))*integrate(((~a*((~x)^~j) + ~b*((~x)^(~j + ~n)))^~p)*((~e*~x)^(~m + ~n)), ~x) + ~c*((~e)^(~j - 1))*(((~a)^-1)*((1 + ~m + ~j*~p)^-1))*((~a*((~x)^~j) + ~b*((~x)^(~j + ~n)))^(1 + ~p))*((~e*~x)^(1 + ~m - ~j)) => integrate((~c + ~d*((~x)^~n))*((~a*((~x)^~j) + ~b*((~x)^~jn))^~p)*((~e*~x)^~m), ~x)

@rule ~d*((~e)^(~j - 1))*(((~b)^-1)*((1 + ~m + ~n + ~p*(~j + ~n))^-1))*((~a*((~x)^~j) + ~b*((~x)^(~j + ~n)))^(1 + ~p))*((~e*~x)^(1 + ~m - ~j)) - (~a*~d*(1 + ~m + ~j*~p) - ~b*~c*(1 + ~m + ~n + ~p*(~j + ~n)))*(((~b)^-1)*((1 + ~m + ~n + ~p*(~j + ~n))^-1))*integrate(((~a*((~x)^~j) + ~b*((~x)^(~j + ~n)))^~p)*((~e*~x)^~m), ~x) => integrate(((~x)^~m)*((~c + ~d*((~x)^~n))^~q)*((~a*((~x)^~j) + ~b*((~x)^~k))^~p), ~x)

@rule ((1 + ~m)^-1)*Subst(integrate(((~a*((~x)^Simplify(~j*((1 + ~m)^-1))) + ~b*((~x)^Simplify(~k*((1 + ~m)^-1))))^~p)*((~c + ~d*((~x)^Simplify(~n*((1 + ~m)^-1))))^~q), ~x), ~x, (~x)^(1 + ~m)) => integrate(((~c + ~d*((~x)^~n))^~q)*((~a*((~x)^~j) + ~b*((~x)^~k))^~p)*((~e*~x)^~m), ~x)

@rule ((~e)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~e*~x)^FracPart(~m))*integrate(((~x)^~m)*((~c + ~d*((~x)^~n))^~q)*((~a*((~x)^~j) + ~b*((~x)^~k))^~p), ~x) => integrate(((~c + ~d*((~x)^~n))^~q)*((~a*((~x)^~j) + ~b*((~x)^~jn))^~p)*((~e*~x)^~m), ~x)


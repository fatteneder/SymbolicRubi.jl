@rule ((~u)^~m)*(((~v)^(-~m))*(Coefficient(~v, ~x, 1)^-1))*Subst(integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x), ~x, ~v) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule integrate(ExpandIntegrand(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule integrate(((~x)^(~n*(~p + ~q)))*((~b + ~a*((~x)^(-~n)))^~p)*((~d + ~c*((~x)^(-~n)))^~q), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule -Subst(integrate(((~x)^-2)*((~a + ~b*((~x)^(-~n)))^~p)*((~c + ~d*((~x)^(-~n)))^~q), ~x), ~x, (~x)^-1) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule With(List(Set(~g, Denominator(~n))), ~g*Subst(integrate(((~x)^(~g - 1))*((~a + ~b*((~x)^(~g*~n)))^~p)*((~c + ~d*((~x)^(~g*~n)))^~q), ~x), ~x, (~x)^((~g)^-1))) => integrate(((~c + ~d*((~x)^3))*((~a + ~b*((~x)^3))^(3^-1)))^-1, ~x)

@rule With(List(Set(~q, Rt(((~c)^-1)*(~b*~c - ~a*~d), 3))), ((1//6)*((~c)^-1)*((~q)^-1))*Log(~c + ~d*((~x)^3)) + (0.5773502691896258((~c)^-1)*((~q)^-1))*ArcTan(0.5773502691896258(1 + 2~q*~x*((~a + ~b*((~x)^3))^(-(1//3))))) - ((1//2)*((~c)^-1)*((~q)^-1))*Log(~q*~x - ((~a + ~b*((~x)^3))^(3^-1)))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^-1), ~x)

@rule Subst(integrate((~c - ((~x)^~n)*(~b*~c - ~a*~d))^-1, ~x), ~x, ~x*((~a + ~b*((~x)^~n))^(-((~n)^-1)))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule -~c*~q*(((~a)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(~q - 1)), ~x) - ~x*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^~q)*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ~x*((~a)^~p)*(((~c)^(-1 - ~p))*((~c + ~d*((~x)^~n))^(-((~n)^-1))))*Hypergeometric2F1((~n)^-1, -~p, 1 + (~n)^-1, ((~x)^~n)*(~a*~d - ~b*~c)*(((~a)^-1)*((~c + ~d*((~x)^~n))^-1))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ~x*((~a + ~b*((~x)^~n))^~p)*(((~c)^-1)*((~c + ~d*((~x)^~n))^(-~p - ((~n)^-1)))*((~c*(~a + ~b*((~x)^~n))*(((~a)^-1)*((~c + ~d*((~x)^~n))^-1)))^(-~p)))*Hypergeometric2F1((~n)^-1, -~p, 1 + (~n)^-1, ((~x)^~n)*(~a*~d - ~b*~c)*(((~a)^-1)*((~c + ~d*((~x)^~n))^-1))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ~x*((~a + ~b*((~x)^~n))^(1 + ~p))*(((~a)^-1)*((~c)^-1))*((~c + ~d*((~x)^~n))^(1 + ~q)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule (~b*~c + ~n*(1 + ~p)*(~b*~c - ~a*~d))*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*((~b*~c - ~a*~d)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^~q), ~x) - ~b*~x*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(1 + ~q))*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*((~b*~c - ~a*~d)^-1)) => integrate((~c + ~d*((~x)^~n))*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ~c*~x*((~a)^-1)*((~a + ~b*((~x)^~n))^(1 + ~p)) => integrate((~c + ~d*((~x)^~n))*((~a1 + ~b1*((~x)^~non2))^~p)*((~a2 + ~b2*((~x)^~non2))^~p), ~x)

@rule ~c*~x*((~a1 + ~b1*((~x)^((1//2)*~n)))^(1 + ~p))*((~a1^-1)*(~a2^-1))*((~a2 + ~b2*((~x)^((1//2)*~n)))^(1 + ~p)) => integrate((~c + ~d*((~x)^~n))*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ~x*((~a + ~b*((~x)^~n))^(1 + ~p))*(~a*~d - ~b*~c)*(((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1)) - (~a*~d - ~b*~c*(1 + ~n*(1 + ~p)))*(((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate((~a + ~b*((~x)^~n))^(1 + ~p), ~x) => integrate((~c + ~d*((~x)^~n))*((~a1 + ~b1*((~x)^~non2))^~p)*((~a2 + ~b2*((~x)^~non2))^~p), ~x)

@rule ~x*((~a1 + ~b1*((~x)^((1//2)*~n)))^(1 + ~p))*((~a2 + ~b2*((~x)^((1//2)*~n)))^(1 + ~p))*(~a1*~a2*~d - ~b1*~b2*~c)*((~a1^-1)*(~a2^-1)*(~b1^-1)*(~b2^-1)*((~n)^-1)*((1 + ~p)^-1)) - (~a1*~a2*~d - ~b1*~b2*~c*(1 + ~n*(1 + ~p)))*((~a1^-1)*(~a2^-1)*(~b1^-1)*(~b2^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a1 + ~b1*((~x)^((1//2)*~n)))^(1 + ~p))*((~a2 + ~b2*((~x)^((1//2)*~n)))^(1 + ~p)), ~x) => integrate((~c + ~d*((~x)^~n))*((~a + ~b*((~x)^~n))^-1), ~x)

@rule ~c*~x*((~a)^-1) - ((~a)^-1)*(~b*~c - ~a*~d)*integrate((~b + ~a*((~x)^(-~n)))^-1, ~x) => integrate((~c + ~d*((~x)^~n))*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ~d*~x*((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((1 + ~n*(1 + ~p))^-1)) - (~a*~d - ~b*~c*(1 + ~n*(1 + ~p)))*(((~b)^-1)*((1 + ~n*(1 + ~p))^-1))*integrate((~a + ~b*((~x)^~n))^~p, ~x) => integrate((~c + ~d*((~x)^~n))*((~a1 + ~b1*((~x)^~non2))^~p)*((~a2 + ~b2*((~x)^~non2))^~p), ~x)

@rule ~d*~x*((~a1 + ~b1*((~x)^((1//2)*~n)))^(1 + ~p))*((~a2 + ~b2*((~x)^((1//2)*~n)))^(1 + ~p))*((~b1^-1)*(~b2^-1)*((1 + ~n*(1 + ~p))^-1)) - (~a1*~a2*~d - ~b1*~b2*~c*(1 + ~n*(1 + ~p)))*((~b1^-1)*(~b2^-1)*((1 + ~n*(1 + ~p))^-1))*integrate(((~a1 + ~b1*((~x)^((1//2)*~n)))^~p)*((~a2 + ~b2*((~x)^((1//2)*~n)))^~p), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule integrate(PolynomialDivide((~a + ~b*((~x)^~n))^~p, (~c + ~d*((~x)^~n))^(-~q), ~x), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^-1), ~x)

@rule ~b*((~d)^-1)*integrate((~a + ~b*((~x)^~n))^(~p - 1), ~x) - ((~d)^-1)*(~b*~c - ~a*~d)*integrate(((~a + ~b*((~x)^~n))^(~p - 1))*((~c + ~d*((~x)^~n))^-1), ~x) => integrate(((~a + ~b*((~x)^~n))*(~c + ~d*((~x)^~n)))^-1, ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate((~a + ~b*((~x)^~n))^-1, ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate((~c + ~d*((~x)^~n))^-1, ~x) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(3^-1)))^-1, ~x)

@rule With(List(Set(~q, Rt(~b*((~a)^-1), 2))), ~q*((1//6)*((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTan(~q*~x) + ~q*(0.2886751345948129((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTanh(1.7320508075688772(((~q)^-1)*((~x)^-1))) + ~q*(0.2886751345948129((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTanh(1.7320508075688772((~a)^(3^-1) - ((~a + ~b*((~x)^2))^(3^-1))*(2^(3^-1)))*(((~a)^(-(1//3)))*((~q)^-1)*((~x)^-1))) - ~q*((1//2)*((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTan(~q*~x*((~a)^(3^-1))*(((~a)^(3^-1) + ((~a + ~b*((~x)^2))^(3^-1))*(2^(3^-1)))^-1))) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(3^-1)))^-1, ~x)

@rule With(List(Set(~q, Rt(-~b*((~a)^-1), 2))), ~q*(0.2886751345948129((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTan(1.7320508075688772(((~q)^-1)*((~x)^-1))) + ~q*(0.2886751345948129((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTan(1.7320508075688772((~a)^(3^-1) - ((~a + ~b*((~x)^2))^(3^-1))*(2^(3^-1)))*(((~a)^(-(1//3)))*((~q)^-1)*((~x)^-1))) + ~q*((1//2)*((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTanh(~q*~x*((~a)^(3^-1))*(((~a)^(3^-1) + ((~a + ~b*((~x)^2))^(3^-1))*(2^(3^-1)))^-1)) - ~q*((1//6)*((~a)^(-(1//3)))*((~d)^-1)*(2^((-2//1)*(1//3))))*ArcTanh(~q*~x)) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(3^-1)))^-1, ~x)

@rule With(List(Set(~q, Rt(~b*((~a)^-1), 2))), ~q*((1//12)*((~d)^-1)*(Rt(~a, 3)^-1))*ArcTan(((Rt(~a, 3) - ((~a + ~b*((~x)^2))^(3^-1)))^2)*((1//3)*((~q)^-1)*((~x)^-1)*(Rt(~a, 3)^-2))) + ~q*((1//12)*((~d)^-1)*(Rt(~a, 3)^-1))*ArcTan((1//3)*~q*~x) - ~q*(0.14433756729740646((~d)^-1)*(Rt(~a, 3)^-1))*ArcTanh((1.7320508075688772Rt(~a, 3) - 1.7320508075688772((~a + ~b*((~x)^2))^(3^-1)))*(((~q)^-1)*((~x)^-1)*(Rt(~a, 3)^-1)))) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(3^-1)))^-1, ~x)

@rule With(List(Set(~q, Rt(-~b*((~a)^-1), 2))), ~q*((1//12)*((~d)^-1)*(Rt(~a, 3)^-1))*ArcTanh(((Rt(~a, 3) - ((~a + ~b*((~x)^2))^(3^-1)))^2)*((1//3)*((~q)^-1)*((~x)^-1)*(Rt(~a, 3)^-2))) - ~q*((1//12)*((~d)^-1)*(Rt(~a, 3)^-1))*ArcTanh((1//3)*~q*~x) - ~q*(0.14433756729740646((~d)^-1)*(Rt(~a, 3)^-1))*ArcTan((1.7320508075688772Rt(~a, 3) - 1.7320508075688772((~a + ~b*((~x)^2))^(3^-1)))*(((~q)^-1)*((~x)^-1)*(Rt(~a, 3)^-1)))) => integrate(((~a + ~b*((~x)^2))^((2//1)*(1//3)))*((~c + ~d*((~x)^2))^-1), ~x)

@rule ~b*((~d)^-1)*integrate((~a + ~b*((~x)^2))^(-(1//3)), ~x) - ((~d)^-1)*(~b*~c - ~a*~d)*integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(3^-1)))^-1, ~x) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(4^-1)))^-1, ~x)

@rule With(List(Set(~q, Rt(((~a)^-1)*((~b)^2), 4))), -~b*((1//2)*((~a)^-1)*((~d)^-1)*((~q)^-1))*ArcTan((~b + ((~q)^2)*sqrt(~a + ~b*((~x)^2)))*(((~q)^-3)*((~x)^-1)*((~a + ~b*((~x)^2))^(-(1//4))))) - ~b*((1//2)*((~a)^-1)*((~d)^-1)*((~q)^-1))*ArcTanh((~b - ((~q)^2)*sqrt(~a + ~b*((~x)^2)))*(((~q)^-3)*((~x)^-1)*((~a + ~b*((~x)^2))^(-(1//4)))))) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(4^-1)))^-1, ~x)

@rule With(List(Set(~q, Rt(-((~a)^-1)*((~b)^2), 4))), ~b*(0.35355339059327373((~a)^-1)*((~d)^-1)*((~q)^-1))*ArcTan(~q*~x*(0.7071067811865475((~a + ~b*((~x)^2))^(-(1//4))))) + ~b*(0.35355339059327373((~a)^-1)*((~d)^-1)*((~q)^-1))*ArcTanh(~q*~x*(0.7071067811865475((~a + ~b*((~x)^2))^(-(1//4)))))) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^(4^-1)))^-1, ~x)

@rule 2((~x)^-1)*sqrt(-~b*((~a)^-1)*((~x)^2))*Subst(integrate(((~x)^2)*(((~b*~c + ~d*((~x)^4) - ~a*~d)^-1)*(sqrt(1 - ((~a)^-1)*((~x)^4))^-1)), ~x), ~x, (~a + ~b*((~x)^2))^(4^-1)) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^((3//1)*(1//4))))^-1, ~x)

@rule ((~c)^-1)*integrate((~a + ~b*((~x)^2))^((-3//1)*(1//4)), ~x) - ~d*((~c)^-1)*integrate(((~x)^2)*(((~a + ~b*((~x)^2))^((-3//1)*(1//4)))*((~c + ~d*((~x)^2))^-1)), ~x) => integrate(((~c + ~d*((~x)^2))*((~a + ~b*((~x)^2))^((3//1)*(1//4))))^-1, ~x)

@rule ((1//2)*((~x)^-1))*sqrt(-~b*((~a)^-1)*((~x)^2))*Subst(integrate(((~c + ~d*~x)*((~a + ~b*~x)^((3//1)*(1//4)))*sqrt(-~b*~x*((~a)^-1)))^-1, ~x), ~x, (~x)^2) => integrate(((~a + ~b*((~x)^2))^~p)*((~c + ~d*((~x)^2))^-1), ~x)

@rule ~b*((~d)^-1)*integrate((~a + ~b*((~x)^2))^(~p - 1), ~x) - ((~d)^-1)*(~b*~c - ~a*~d)*integrate(((~a + ~b*((~x)^2))^(~p - 1))*((~c + ~d*((~x)^2))^-1), ~x) => integrate(((~a + ~b*((~x)^2))^~p)*((~c + ~d*((~x)^2))^-1), ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate((~a + ~b*((~x)^2))^~p, ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate(((~a + ~b*((~x)^2))^(1 + ~p))*((~c + ~d*((~x)^2))^-1), ~x) => integrate(((~c + ~d*((~x)^4))^-1)*sqrt(~a + ~b*((~x)^4)), ~x)

@rule ~a*((~c)^-1)*Subst(integrate((1 - 4~a*~b*((~x)^4))^-1, ~x), ~x, ~x*(sqrt(~a + ~b*((~x)^4))^-1)) => integrate(((~c + ~d*((~x)^4))^-1)*sqrt(~a + ~b*((~x)^4)), ~x)

@rule With(List(Set(~q, Rt(-~a*~b, 4))), ~a*((1//2)*((~c)^-1)*((~q)^-1))*ArcTan(~q*~x*(~a + ((~q)^2)*((~x)^2))*(((~a)^-1)*(sqrt(~a + ~b*((~x)^4))^-1))) + ~a*((1//2)*((~c)^-1)*((~q)^-1))*ArcTanh(~q*~x*(~a - ((~q)^2)*((~x)^2))*(((~a)^-1)*(sqrt(~a + ~b*((~x)^4))^-1)))) => integrate(((~c + ~d*((~x)^4))^-1)*sqrt(~a + ~b*((~x)^4)), ~x)

@rule ~b*((~d)^-1)*integrate(sqrt(~a + ~b*((~x)^4))^-1, ~x) - ((~d)^-1)*(~b*~c - ~a*~d)*integrate(((~c + ~d*((~x)^4))*sqrt(~a + ~b*((~x)^4)))^-1, ~x) => integrate(((~a + ~b*((~x)^4))^(4^-1))*((~c + ~d*((~x)^4))^-1), ~x)

@rule sqrt(~a + ~b*((~x)^4))*sqrt(~a*((~a + ~b*((~x)^4))^-1))*Subst(integrate(((~c - ((~x)^4)*(~b*~c - ~a*~d))*sqrt(1 - ~b*((~x)^4)))^-1, ~x), ~x, ~x*((~a + ~b*((~x)^4))^(-(1//4)))) => integrate(((~a + ~b*((~x)^4))^((5//1)*(1//4)))*((~c + ~d*((~x)^4))^-1), ~x)

@rule ~b*((~d)^-1)*integrate((~a + ~b*((~x)^4))^(4^-1), ~x) - ((~d)^-1)*(~b*~c - ~a*~d)*integrate(((~a + ~b*((~x)^4))^(4^-1))*((~c + ~d*((~x)^4))^-1), ~x) => integrate(((~c + ~d*((~x)^4))*sqrt(~a + ~b*((~x)^4)))^-1, ~x)

@rule ((1//2)*((~c)^-1))*integrate(((1 + ((~x)^2)*Rt(-~d*((~c)^-1), 2))*sqrt(~a + ~b*((~x)^4)))^-1, ~x) + ((1//2)*((~c)^-1))*integrate(((1 - ((~x)^2)*Rt(-~d*((~c)^-1), 2))*sqrt(~a + ~b*((~x)^4)))^-1, ~x) => integrate(((~c + ~d*((~x)^4))*((~a + ~b*((~x)^4))^((3//1)*(1//4))))^-1, ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate((~a + ~b*((~x)^4))^((-3//1)*(1//4)), ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate(((~a + ~b*((~x)^4))^(4^-1))*((~c + ~d*((~x)^4))^-1), ~x) => integrate(((~a + ~b*((~x)^3))^(3^-1))*((~c + ~d*((~x)^3))^-1), ~x)

@rule With(List(Set(~q, Rt(~b*((~a)^-1), 3))), 9~a*(((~c)^-1)*((~q)^-1))*Subst(integrate(~x*(((4 - ~a*((~x)^3))^-1)*((1 + 2~a*((~x)^3))^-1)), ~x), ~x, ((~a + ~b*((~x)^3))^(-(1//3)))*(1 + ~q*~x))) => integrate(((~c + ~d*((~x)^3))*((~a + ~b*((~x)^3))^((2//1)*(1//3))))^-1, ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate((~a + ~b*((~x)^3))^((-2//1)*(1//3)), ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate(((~a + ~b*((~x)^3))^(3^-1))*((~c + ~d*((~x)^3))^-1), ~x) => integrate(((~c + ~d*((~x)^2))^((-3//1)*(1//2)))*sqrt(~a + ~b*((~x)^2)), ~x)

@rule (((~c)^-1)*(sqrt(~c + ~d*((~x)^2))^-1)*(sqrt(~c*(~a + ~b*((~x)^2))*(((~a)^-1)*((~c + ~d*((~x)^2))^-1)))^-1)*(Rt(~d*((~c)^-1), 2)^-1))*sqrt(~a + ~b*((~x)^2))*EllipticE(ArcTan(~x*Rt(~d*((~c)^-1), 2)), 1 - ~b*~c*(((~a)^-1)*((~d)^-1))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule (((~a)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(~q - 1))*Simp(~c*(1 + ~n*(1 + ~p)) + ~d*((~x)^~n)*(1 + ~n*(1 + ~p + ~q)), ~x), ~x) - ~x*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^~q)*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ~x*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(~q - 1))*(~a*~d - ~b*~c)*(((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1)) - (((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(~q - 2))*Simp(~c*(~a*~d - ~b*~c*(1 + ~n*(1 + ~p))) + ~d*((~x)^~n)*(~a*~d*(1 + ~n*(~q - 1)) - ~b*~c*(1 + ~n*(~p + ~q))), ~x), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule (((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*((~b*~c - ~a*~d)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^~q)*Simp(~b*~c + ~n*(1 + ~p)*(~b*~c - ~a*~d) + ~b*~d*((~x)^~n)*(1 + ~n*(2 + ~p + ~q)), ~x), ~x) - ~b*~x*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(1 + ~q))*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*((~b*~c - ~a*~d)^-1)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule integrate(ExpandIntegrand(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule (((~b)^-1)*((1 + ~n*(~p + ~q))^-1))*integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^(~q - 2))*Simp(~c*(~b*~c*(1 + ~n*(~p + ~q)) - ~a*~d) + ~d*((~x)^~n)*(~b*~c*(1 + ~n*(~p + 2~q - 1)) - ~a*~d*(1 + ~n*(~q - 1))), ~x), ~x) + ~d*~x*((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((1 + ~n*(~p + ~q))^-1))*((~c + ~d*((~x)^~n))^(~q - 1)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ~n*((1 + ~n*(~p + ~q))^-1)*integrate(((~a + ~b*((~x)^~n))^(~p - 1))*((~c + ~d*((~x)^~n))^(~q - 1))*Simp(((~x)^~n)*(~q*(~b*~c - ~a*~d) + ~a*~d*(~p + ~q)) + ~a*~c*(~p + ~q), ~x), ~x) + ~x*((1 + ~n*(~p + ~q))^-1)*((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q) => integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)))^-1, ~x)

@rule (((~a)^-1)*(sqrt(~c + ~d*((~x)^2))^-1)*(sqrt(~c*(~a + ~b*((~x)^2))*(((~a)^-1)*((~c + ~d*((~x)^2))^-1)))^-1)*(Rt(~d*((~c)^-1), 2)^-1))*sqrt(~a + ~b*((~x)^2))*EllipticF(ArcTan(~x*Rt(~d*((~c)^-1), 2)), 1 - ~b*~c*(((~a)^-1)*((~d)^-1))) => integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)))^-1, ~x)

@rule ((sqrt(~a)^-1)*(sqrt(~c)^-1)*(Rt(-~d*((~c)^-1), 2)^-1))*EllipticF(ArcSin(~x*Rt(-~d*((~c)^-1), 2)), ~b*~c*(((~a)^-1)*((~d)^-1))) => integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)))^-1, ~x)

@rule -((sqrt(~c)^-1)*(sqrt(~a - ~b*~c*((~d)^-1))^-1)*(Rt(-~d*((~c)^-1), 2)^-1))*EllipticF(ArcCos(~x*Rt(-~d*((~c)^-1), 2)), ~b*~c*((~b*~c - ~a*~d)^-1)) => integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)))^-1, ~x)

@rule (sqrt(~c + ~d*((~x)^2))^-1)*sqrt(1 + ~d*((~c)^-1)*((~x)^2))*integrate((sqrt(~a + ~b*((~x)^2))*sqrt(1 + ~d*((~c)^-1)*((~x)^2)))^-1, ~x) => integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2)), ~x)

@rule ~a*integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)))^-1, ~x) + ~b*integrate(((~x)^2)*((sqrt(~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1)), ~x) => integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2)), ~x)

@rule ~b*((~d)^-1)*integrate((sqrt(~a + ~b*((~x)^2))^-1)*sqrt(~c + ~d*((~x)^2)), ~x) - ((~d)^-1)*(~b*~c - ~a*~d)*integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)))^-1, ~x) => integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2)), ~x)

@rule ((sqrt(~c)^-1)*(Rt(-~d*((~c)^-1), 2)^-1))*sqrt(~a)*EllipticE(ArcSin(~x*Rt(-~d*((~c)^-1), 2)), ~b*~c*(((~a)^-1)*((~d)^-1))) => integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2)), ~x)

@rule -((sqrt(~c)^-1)*(Rt(-~d*((~c)^-1), 2)^-1))*sqrt(~a - ~b*~c*((~d)^-1))*EllipticE(ArcCos(~x*Rt(-~d*((~c)^-1), 2)), ~b*~c*((~b*~c - ~a*~d)^-1)) => integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2)), ~x)

@rule (sqrt(1 + ~b*((~a)^-1)*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2))*integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(1 + ~b*((~a)^-1)*((~x)^2)), ~x) => integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2)), ~x)

@rule (sqrt(~c + ~d*((~x)^2))^-1)*sqrt(1 + ~d*((~c)^-1)*((~x)^2))*integrate((sqrt(1 + ~d*((~c)^-1)*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule integrate(ExpandIntegrand(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ~x*((~a)^~p)*((~c)^~q)*AppellF1((~n)^-1, -~p, -~q, 1 + (~n)^-1, -~b*((~a)^-1)*((~x)^~n), -~d*((~c)^-1)*((~x)^~n)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ((~a)^IntPart(~p))*((1 + ~b*((~a)^-1)*((~x)^~n))^(-FracPart(~p)))*((~a + ~b*((~x)^~n))^FracPart(~p))*integrate(((~c + ~d*((~x)^~n))^~q)*((1 + ~b*((~a)^-1)*((~x)^~n))^~p), ~x) => integrate(((~a + ~b*((~u)^~n))^~p)*((~c + ~d*((~u)^~n))^~q), ~x)

@rule (Coefficient(~u, ~x, 1)^-1)*Subst(integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x), ~x, ~u) => integrate(((~u)^~p)*((~v)^~q), ~x)

@rule integrate((NormalizePseudoBinomial(~u, ~x)^~p)*(NormalizePseudoBinomial(~v, ~x)^~q), ~x) => integrate(((~u)^~p)*((~v)^~q)*((~x)^~m), ~x)

@rule integrate((NormalizePseudoBinomial(~v, ~x)^~q)*(NormalizePseudoBinomial(~u*((~x)^(~m*((~p)^-1))), ~x)^~p), ~x) => integrate(((~c + ~d*((~x)^~mn))^~q)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule integrate(((~x)^(-~n*~q))*((~a + ~b*((~x)^~n))^~p)*((~d + ~c*((~x)^~n))^~q), ~x) => integrate(((~c + ~d*((~x)^~mn))^~q)*((~a + ~b*((~x)^~n))^~p), ~x)


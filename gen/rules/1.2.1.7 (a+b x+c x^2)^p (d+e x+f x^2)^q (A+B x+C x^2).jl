@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~p, ~q), ~x), EqQ(~c*~d - ~a*~f, 0), EqQ(~b*~d - ~a*~e, 0), Or(IntegerQ(~p), GtQ(~c*((~f)^-1), 0)), Or(Not(IntegerQ(~q)), LessEqual(LeafCount(~d + ~e*~x + ~f*((~x)^2)), LeafCount(~a + ~b*~x + ~c*((~x)^2))))) 
 ((~c*((~f)^-1))^~p)*integrate((~A + ~B*~x + ~C*((~x)^2))*((~d + ~e*~x + ~f*((~x)^2))^(~p + ~q)), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~p, ~q), ~x), EqQ(~c*~d - ~a*~f, 0), EqQ(~b*~d - ~a*~e, 0), Or(IntegerQ(~p), GtQ(~c*((~f)^-1), 0)), Or(Not(IntegerQ(~q)), LessEqual(LeafCount(~d + ~e*~x + ~f*((~x)^2)), LeafCount(~a + ~b*~x + ~c*((~x)^2))))) 
 ((~c*((~f)^-1))^~p)*integrate((~A + ~C*((~x)^2))*((~d + ~e*~x + ~f*((~x)^2))^(~p + ~q)), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~p, ~q), ~x), EqQ(~c*~d - ~a*~f, 0), EqQ(~b*~d - ~a*~e, 0), Not(IntegerQ(~p)), Not(IntegerQ(~q)), Not(GtQ(~c*((~f)^-1), 0))) 
 ((~a)^IntPart(~p))*((~a + ~b*~x + ~c*((~x)^2))^FracPart(~p))*(((~d)^(-IntPart(~p)))*((~d + ~e*~x + ~f*((~x)^2))^(-FracPart(~p))))*integrate((~A + ~B*~x + ~C*((~x)^2))*((~d + ~e*~x + ~f*((~x)^2))^(~p + ~q)), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~p, ~q), ~x), EqQ(~c*~d - ~a*~f, 0), EqQ(~b*~d - ~a*~e, 0), Not(IntegerQ(~p)), Not(IntegerQ(~q)), Not(GtQ(~c*((~f)^-1), 0))) 
 ((~a)^IntPart(~p))*((~a + ~b*~x + ~c*((~x)^2))^FracPart(~p))*(((~d)^(-IntPart(~p)))*((~d + ~e*~x + ~f*((~x)^2))^(-FracPart(~p))))*integrate((~A + ~C*((~x)^2))*((~d + ~e*~x + ~f*((~x)^2))^(~p + ~q)), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~p, ~q), ~x), EqQ((~b)^2 - 4 * ~a*~c, 0)) 
 ((~a + ~b*~x + ~c*((~x)^2))^FracPart(~p))*(((~b + 2 * ~c*~x)^(-2FracPart(~p)))*((4 * ~c)^(-IntPart(~p))))*integrate((~A + ~B*~x + ~C*((~x)^2))*((~b + 2 * ~c*~x)^(2 * ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~p, ~q), ~x), EqQ((~b)^2 - 4 * ~a*~c, 0)) 
 ((~a + ~b*~x + ~c*((~x)^2))^FracPart(~p))*(((~b + 2 * ~c*~x)^(-2FracPart(~p)))*((4 * ~c)^(-IntPart(~p))))*integrate((~A + ~C*((~x)^2))*((~b + 2 * ~c*~x)^(2 * ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~B, ~C, ~p, ~q), ~x), EqQ((~b)^2 - 4 * ~a*~c, 0)) 
 ((~a + ~b*~x + ~c*((~x)^2))^FracPart(~p))*(((~b + 2 * ~c*~x)^(-2FracPart(~p)))*((4 * ~c)^(-IntPart(~p))))*integrate((~A + ~B*~x + ~C*((~x)^2))*((~b + 2 * ~c*~x)^(2 * ~p))*((~d + ~f*((~x)^2))^~q), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~C, ~p, ~q), ~x), EqQ((~b)^2 - 4 * ~a*~c, 0)) 
 ((~a + ~b*~x + ~c*((~x)^2))^FracPart(~p))*(((~b + 2 * ~c*~x)^(-2FracPart(~p)))*((4 * ~c)^(-IntPart(~p))))*integrate((~A + ~C*((~x)^2))*((~b + 2 * ~c*~x)^(2 * ~p))*((~d + ~f*((~x)^2))^~q), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), GtQ(~q, 0), Not(IGtQ(~q, 0))) 
 (~C*~a*~b + ~A*~b*~c - ~x*(~c*(~B*~b - 2 * ~A*~c) - ~C*((~b)^2 - 2 * ~a*~c)) - 2 * ~B*~a*~c)*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q)*(((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)) - (((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1))*integrate(((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^(~q - 1))*Simp(~x*(2 * ~f*~q*(~C*~a*~b + ~A*~b*~c - 2 * ~B*~a*~c) - ~e*(~C*(2 * ~a*~c*(1 + ~q) - (2 + ~p + ~q)*((~b)^2)) + ~c*(~B*~b - 2 * ~A*~c)*(3 + ~q + 2 * ~p))) + ~e*~q*(~C*~a*~b + ~A*~b*~c - 2 * ~B*~a*~c) - ~d*(~C*(2 * ~a*~c - ((~b)^2)*(2 + ~p)) + ~c*(3 + 2 * ~p)*(~B*~b - 2 * ~A*~c)) - ~f*((~x)^2)*(~C*(2 * ~a*~c*(1 + 2 * ~q) - (2 + ~p + 2 * ~q)*((~b)^2)) + ~c*(~B*~b - 2 * ~A*~c)*(3 + 2 * ~p + 2 * ~q)), ~x), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), GtQ(~q, 0), Not(IGtQ(~q, 0))) 
 (~x*(~C*((~b)^2 - 2 * ~a*~c) + 2 * ~A*((~c)^2)) + ~C*~a*~b + ~A*~b*~c)*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q)*(((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)) - (((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1))*integrate(((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^(~q - 1))*Simp(~x*(~C*(~e*(2 + ~p + ~q)*((~b)^2) + 2 * ~a*~b*~f*~q - 2 * ~a*~c*~e*(1 + ~q)) + 2 * ~A*~c*(~b*~f*~q + ~c*~e*(3 + ~q + 2 * ~p))) + ~A*~c*(~b*~e*~q + 2 * ~c*~d*(3 + 2 * ~p)) - ~C*(2 * ~a*~c*~d - ~d*((~b)^2)*(2 + ~p) - ~a*~b*~e*~q) - ~f*((~x)^2)*(~C*(2 * ~a*~c*(1 + 2 * ~q) - (2 + ~p + 2 * ~q)*((~b)^2)) - 2 * ~A*(3 + 2 * ~p + 2 * ~q)*((~c)^2)), ~x), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), GtQ(~q, 0), Not(IGtQ(~q, 0))) 
 ((~a + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q)*(~B*~a - ~x*(~A*~c - ~C*~a))*((1//2)*((~a)^-1)*((~c)^-1)*((1 + ~p)^-1)) - 2((-1//4)*((~a)^-1)*((~c)^-1)*((1 + ~p)^-1))*integrate(((~a + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^(~q - 1))*Simp(~x*(~A*~c*~e*(3 + ~q + 2 * ~p) - ~a*(~C*~e*(1 + ~q) + 2 * ~B*~f*~q)) + ~A*~c*~d*(3 + 2 * ~p) - ~a*(~C*~d + ~B*~e*~q) - ~f*((~x)^2)*(~C*~a*(1 + 2 * ~q) - ~A*~c*(3 + 2 * ~p + 2 * ~q)), ~x), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), GtQ(~q, 0), Not(IGtQ(~q, 0))) 
 2((1//4)*((~a)^-1)*((~c)^-1)*((1 + ~p)^-1))*integrate(((~a + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^(~q - 1))*Simp(~x*(~A*~c*~e*(3 + ~q + 2 * ~p) - ~C*~a*~e*(1 + ~q)) + ~A*~c*~d*(3 + 2 * ~p) - ~C*~a*~d - ~f*((~x)^2)*(~C*~a*(1 + 2 * ~q) - ~A*~c*(3 + 2 * ~p + 2 * ~q)), ~x), ~x) + ~x*((~a + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q)*(~C*~a - ~A*~c)*((1//2)*((~a)^-1)*((~c)^-1)*((1 + ~p)^-1))
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~B, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), LtQ(~p, -1), GtQ(~q, 0), Not(IGtQ(~q, 0))) 
 (~C*~a*~b + ~A*~b*~c - ~x*(~c*(~B*~b - 2 * ~A*~c) - ~C*((~b)^2 - 2 * ~a*~c)) - 2 * ~B*~a*~c)*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*(((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)) - (((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1))*integrate(((~d + ~f*((~x)^2))^(~q - 1))*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*Simp(2 * ~f*~q*~x*(~C*~a*~b + ~A*~b*~c - 2 * ~B*~a*~c) - ~d*(~C*(2 * ~a*~c - ((~b)^2)*(2 + ~p)) + ~c*(3 + 2 * ~p)*(~B*~b - 2 * ~A*~c)) - ~f*((~x)^2)*(~C*(2 * ~a*~c*(1 + 2 * ~q) - (2 + ~p + 2 * ~q)*((~b)^2)) + ~c*(~B*~b - 2 * ~A*~c)*(3 + 2 * ~p + 2 * ~q)), ~x), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), LtQ(~p, -1), GtQ(~q, 0), Not(IGtQ(~q, 0))) 
 (~x*(~C*((~b)^2 - 2 * ~a*~c) + 2 * ~A*((~c)^2)) + ~C*~a*~b + ~A*~b*~c)*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*(((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)) - (((~c)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1))*integrate(((~d + ~f*((~x)^2))^(~q - 1))*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*Simp(~x*(2 * ~C*~a*~b*~f*~q + 2 * ~A*~b*~c*~f*~q) + 2 * ~A*~d*((~c)^2)*(3 + 2 * ~p) - ~C*(2 * ~a*~c*~d - ~d*((~b)^2)*(2 + ~p)) - ~f*((~x)^2)*(~C*(2 * ~a*~c*(1 + 2 * ~q) - (2 + ~p + 2 * ~q)*((~b)^2)) - 2 * ~A*(3 + 2 * ~p + 2 * ~q)*((~c)^2)), ~x), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), NeQ((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f), 0), Not(And(Not(IntegerQ(~p)), ILtQ(~q, -1))), Not(IGtQ(~q, 0))) 
 (((1 + ~p)^-1)*(((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f))^-1)*(((~b)^2 - 4 * ~a*~c)^-1))*integrate(((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q)*Simp((~a*~f*(1 + ~p) - ~c*~d*(2 + ~p))*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f - ~B*~c*~e) - ~b*(~C*~a*~e + ~B*~a*~f + ~A*~c*~e + ~B*~c*~d)) + (1 + ~p)*((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f))*(~B*~b - 2 * ~C*~a - 2 * ~A*~c) - ~x*(2 * ~f*((~A*~b - ~B*~a)*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)) + (~A*~c - ~C*~a)*(2 * ~a*~c*~e - ~b*(~c*~d + ~a*~f)))*(2 + ~p + ~q) - (~b*~f*(1 + ~p) - ~c*~e*(4 + ~q + 2 * ~p))*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f - ~B*~c*~e) - ~b*(~C*~a*~e + ~B*~a*~f + ~A*~c*~e + ~B*~c*~d))) - ~e*((~A*~b - ~B*~a)*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)) + (~A*~c - ~C*~a)*(2 * ~a*~c*~e - ~b*(~c*~d + ~a*~f)))*(2 + ~p + ~q) - ~c*~f*(5 + 2 * ~p + 2 * ~q)*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f - ~B*~c*~e) - ~b*(~C*~a*~e + ~B*~a*~f + ~A*~c*~e + ~B*~c*~d))*((~x)^2), ~x), ~x) + ((~A*~b - ~B*~a)*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)) + (~A*~c - ~C*~a)*(2 * ~a*~c*~e - ~b*(~c*~d + ~a*~f)) + ~c*~x*(~A*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)) + ~C*(~d*((~b)^2) - 2 * ~a*(~c*~d - ~a*~f) - ~a*~b*~e) - ~B*(~a*~b*~f + ~b*~c*~d - 2 * ~a*~c*~e)))*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^(1 + ~q))*(((1 + ~p)^-1)*(((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f))^-1)*(((~b)^2 - 4 * ~a*~c)^-1))
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), NeQ((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f), 0), Not(And(Not(IntegerQ(~p)), ILtQ(~q, -1))), Not(IGtQ(~q, 0))) 
 (((1 + ~p)^-1)*(((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f))^-1)*(((~b)^2 - 4 * ~a*~c)^-1))*integrate(((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^~q)*Simp((~a*~f*(1 + ~p) - ~c*~d*(2 + ~p))*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - ~b*(~C*~a*~e + ~A*~c*~e) - 2 * ~a*(~C*~c*~d - ~C*~a*~f)) + (1 + ~p)*((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f))*(-2 * ~C*~a - 2 * ~A*~c) - ~x*(2 * ~f*((~A*~c - ~C*~a)*(2 * ~a*~c*~e - ~b*(~c*~d + ~a*~f)) + ~A*~b*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)))*(2 + ~p + ~q) - (~b*~f*(1 + ~p) - ~c*~e*(4 + ~q + 2 * ~p))*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - ~b*(~C*~a*~e + ~A*~c*~e) - 2 * ~a*(~C*~c*~d - ~C*~a*~f))) - ~e*((~A*~c - ~C*~a)*(2 * ~a*~c*~e - ~b*(~c*~d + ~a*~f)) + ~A*~b*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)))*(2 + ~p + ~q) - ~c*~f*(5 + 2 * ~p + 2 * ~q)*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - ~b*(~C*~a*~e + ~A*~c*~e) - 2 * ~a*(~C*~c*~d - ~C*~a*~f))*((~x)^2), ~x), ~x) + ((~A*~c - ~C*~a)*(2 * ~a*~c*~e - ~b*(~c*~d + ~a*~f)) + ~A*~b*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)) + ~c*~x*(~A*(~f*((~b)^2) + 2 * ~d*((~c)^2) - ~c*(~b*~e + 2 * ~a*~f)) + ~C*(~d*((~b)^2) - 2 * ~a*(~c*~d - ~a*~f) - ~a*~b*~e)))*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*((~d + ~e*~x + ~f*((~x)^2))^(1 + ~q))*(((1 + ~p)^-1)*(((~c*~d - ~a*~f)^2 - (~b*~d - ~a*~e)*(~c*~e - ~b*~f))^-1)*(((~b)^2 - 4 * ~a*~c)^-1))
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~q), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), NeQ((~c*~d - ~a*~f)^2 + ~a*~c*((~e)^2), 0), Not(And(Not(IntegerQ(~p)), ILtQ(~q, -1))), Not(IGtQ(~q, 0))) 
 (+)((*)((*)((*)((*)((*)(-1//4, (inv)(~a)), (inv)(~c)), (inv)((+)(1, ~p))), (inv)((+)((^)((+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)), 2), (*)((*)(~a, ~c), (^)(~e, 2))))), integrate((*)((*)((^)((+)(~a, (*)(~c, (^)(~x, 2))), (+)(1, ~p)), (^)((+)((+)(~d, (*)(~e, ~x)), (*)(~f, (^)(~x, 2))), ~q)), Simp((+)((+)((+)((+)((*)((+)((*)((*)(-2, ~a), (+)((+)((*)((*)(~C, ~c), ~d), (*)((*)((*)(-1, ~C), ~a), ~f)), (*)((*)((*)(-1, ~B), ~c), ~e))), (*)((*)((*)(2, ~A), ~c), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)))), (+)((*)((*)(~a, ~f), (+)(1, ~p)), (*)((*)((*)(-1, ~c), ~d), (+)(2, ~p)))), (*)((*)((+)(1, ~p), (+)((^)((+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)), 2), (*)((*)(~a, ~c), (^)(~e, 2)))), (+)((*)((*)(-2, ~C), ~a), (*)((*)(-2, ~A), ~c)))), (*)((*)(-1, ~x), (+)((*)((*)((*)(2, ~f), (+)((*)((*)((*)(-1, ~B), ~a), (+)((*)((*)(2, ~d), (^)(~c, 2)), (*)((*)((*)(-2, ~a), ~c), ~f))), (*)((*)((*)((*)(2, ~a), ~c), ~e), (+)((*)(~A, ~c), (*)((*)(-1, ~C), ~a))))), (+)((+)(2, ~p), ~q)), (*)((*)((*)(~c, ~e), (+)((*)((*)(-2, ~a), (+)((+)((*)((*)(~C, ~c), ~d), (*)((*)((*)(-1, ~C), ~a), ~f)), (*)((*)((*)(-1, ~B), ~c), ~e))), (*)((*)((*)(2, ~A), ~c), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f))))), (+)((+)(4, ~q), (*)(2, ~p)))))), (*)((*)((*)(-1, ~e), (+)((*)((*)((*)(-1, ~B), ~a), (+)((*)((*)(2, ~d), (^)(~c, 2)), (*)((*)((*)(-2, ~a), ~c), ~f))), (*)((*)((*)((*)(2, ~a), ~c), ~e), (+)((*)(~A, ~c), (*)((*)(-1, ~C), ~a))))), (+)((+)(2, ~p), ~q))), (*)((*)((*)((*)((*)(-1, ~c), ~f), (+)((*)((*)(-2, ~a), (+)((+)((*)((*)(~C, ~c), ~d), (*)((*)((*)(-1, ~C), ~a), ~f)), (*)((*)((*)(-1, ~B), ~c), ~e))), (*)((*)((*)(2, ~A), ~c), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f))))), (+)((+)(5, (*)(2, ~p)), (*)(2, ~q))), (^)(~x, 2))), ~x)), ~x)), (*)((*)((*)((+)((+)((*)((*)(~c, ~x), (+)((+)((*)(~A, (+)((*)((*)(2, ~d), (^)(~c, 2)), (*)((*)((*)(-2, ~a), ~c), ~f))), (*)((*)((*)(-2, ~C), ~a), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)))), (*)((*)((*)((*)(2, ~B), ~a), ~c), ~e))), (*)((*)((*)(-1, ~B), ~a), (+)((*)((*)(2, ~d), (^)(~c, 2)), (*)((*)((*)(-2, ~a), ~c), ~f)))), (*)((*)((*)((*)(2, ~a), ~c), ~e), (+)((*)(~A, ~c), (*)((*)(-1, ~C), ~a)))), (^)((+)(~a, (*)(~c, (^)(~x, 2))), (+)(1, ~p))), (^)((+)((+)(~d, (*)(~e, ~x)), (*)(~f, (^)(~x, 2))), (+)(1, ~q))), (*)((*)((*)((*)(-1//4, (inv)(~a)), (inv)(~c)), (inv)((+)(1, ~p))), (inv)((+)((^)((+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)), 2), (*)((*)(~a, ~c), (^)(~e, 2)))))))
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~C, ~q), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0), LtQ(~p, -1), NeQ((~c*~d - ~a*~f)^2 + ~a*~c*((~e)^2), 0), Not(And(Not(IntegerQ(~p)), ILtQ(~q, -1))), Not(IGtQ(~q, 0))) 
 (+)((*)((*)((*)((*)((*)(-1//4, (inv)(~a)), (inv)(~c)), (inv)((+)(1, ~p))), (inv)((+)((^)((+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)), 2), (*)((*)(~a, ~c), (^)(~e, 2))))), integrate((*)((*)((^)((+)(~a, (*)(~c, (^)(~x, 2))), (+)(1, ~p)), (^)((+)((+)(~d, (*)(~e, ~x)), (*)(~f, (^)(~x, 2))), ~q)), Simp((+)((+)((+)((+)((*)((+)((*)((*)(-2, ~a), (+)((*)((*)(~C, ~c), ~d), (*)((*)((*)(-1, ~C), ~a), ~f))), (*)((*)((*)(2, ~A), ~c), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)))), (+)((*)((*)(~a, ~f), (+)(1, ~p)), (*)((*)((*)(-1, ~c), ~d), (+)(2, ~p)))), (*)((*)(-1, ~x), (+)((*)((*)((*)(~c, ~e), (+)((*)((*)(-2, ~a), (+)((*)((*)(~C, ~c), ~d), (*)((*)((*)(-1, ~C), ~a), ~f))), (*)((*)((*)(2, ~A), ~c), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f))))), (+)((+)(4, ~q), (*)(2, ~p))), (*)((*)((*)((*)((*)((*)(4, ~a), ~c), ~e), ~f), (+)((*)(~A, ~c), (*)((*)(-1, ~C), ~a))), (+)((+)(2, ~p), ~q))))), (*)((*)((+)(1, ~p), (+)((^)((+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)), 2), (*)((*)(~a, ~c), (^)(~e, 2)))), (+)((*)((*)(-2, ~C), ~a), (*)((*)(-2, ~A), ~c)))), (*)((*)((*)((*)((*)(-1, ~c), ~f), (+)((+)(5, (*)(2, ~p)), (*)(2, ~q))), (^)(~x, 2)), (+)((*)((*)(-2, ~a), (+)((*)((*)(~C, ~c), ~d), (*)((*)((*)(-1, ~C), ~a), ~f))), (*)((*)((*)(2, ~A), ~c), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)))))), (*)((*)((*)((*)((*)(-2, ~a), ~c), (+)((+)(2, ~p), ~q)), (^)(~e, 2)), (+)((*)(~A, ~c), (*)((*)(-1, ~C), ~a)))), ~x)), ~x)), (*)((*)((*)((^)((+)(~a, (*)(~c, (^)(~x, 2))), (+)(1, ~p)), (^)((+)((+)(~d, (*)(~e, ~x)), (*)(~f, (^)(~x, 2))), (+)(1, ~q))), (+)((*)((*)(~c, ~x), (+)((*)(~A, (+)((*)((*)(2, ~d), (^)(~c, 2)), (*)((*)((*)(-2, ~a), ~c), ~f))), (*)((*)((*)(-2, ~C), ~a), (+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f))))), (*)((*)((*)((*)(2, ~a), ~c), ~e), (+)((*)(~A, ~c), (*)((*)(-1, ~C), ~a))))), (*)((*)((*)((*)(-1//4, (inv)(~a)), (inv)(~c)), (inv)((+)(1, ~p))), (inv)((+)((^)((+)((*)(~c, ~d), (*)((*)(-1, ~a), ~f)), 2), (*)((*)(~a, ~c), (^)(~e, 2)))))))
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~B, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), LtQ(~p, -1), NeQ((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2), 0), Not(And(Not(IntegerQ(~p)), ILtQ(~q, -1))), Not(IGtQ(~q, 0))) 
 (((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)*(((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2))^-1))*integrate(((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*Simp((~a*~f*(1 + ~p) - ~c*~d*(2 + ~p))*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f) - ~b*(~B*~a*~f + ~B*~c*~d)) + (1 + ~p)*((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2))*(~B*~b - 2 * ~C*~a - 2 * ~A*~c) - ~x*(2 * ~f*((~A*~b - ~B*~a)*(~f*((~b)^2) + 2 * ~d*((~c)^2) - 2 * ~a*~c*~f) - ~b*(~A*~c - ~C*~a)*(~c*~d + ~a*~f))*(2 + ~p + ~q) - ~b*~f*(1 + ~p)*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f) - ~b*(~B*~a*~f + ~B*~c*~d))) - ~c*~f*(5 + 2 * ~p + 2 * ~q)*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f) - ~b*(~B*~a*~f + ~B*~c*~d))*((~x)^2), ~x), ~x) + ((~A*~b - ~B*~a)*(~f*((~b)^2) + 2 * ~d*((~c)^2) - 2 * ~a*~c*~f) + ~c*~x*(~C*(~d*((~b)^2) - 2 * ~a*(~c*~d - ~a*~f)) + ~A*(~f*((~b)^2) + 2 * ~d*((~c)^2) - 2 * ~a*~c*~f) - ~B*(~a*~b*~f + ~b*~c*~d)) - ~b*(~A*~c - ~C*~a)*(~c*~d + ~a*~f))*((~d + ~f*((~x)^2))^(1 + ~q))*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*(((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)*(((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2))^-1))
 end

@rule integrate((~A + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), LtQ(~p, -1), NeQ((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2), 0), Not(And(Not(IntegerQ(~p)), ILtQ(~q, -1))), Not(IGtQ(~q, 0))) 
 (((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)*(((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2))^-1))*integrate(((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*Simp((~a*~f*(1 + ~p) - ~c*~d*(2 + ~p))*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f)) + (1 + ~p)*((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2))*(-2 * ~C*~a - 2 * ~A*~c) - ~x*(2 * ~f*(~A*~b*(~f*((~b)^2) + 2 * ~d*((~c)^2) - 2 * ~a*~c*~f) - ~b*(~A*~c - ~C*~a)*(~c*~d + ~a*~f))*(2 + ~p + ~q) - ~b*~f*(1 + ~p)*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f))) - ~c*~f*(5 + 2 * ~p + 2 * ~q)*(((~b)^2)*(~A*~f + ~C*~d) + 2 * ~A*~c*(~c*~d - ~a*~f) - 2 * ~a*(~C*~c*~d - ~C*~a*~f))*((~x)^2), ~x), ~x) + (~A*~b*(~f*((~b)^2) + 2 * ~d*((~c)^2) - 2 * ~a*~c*~f) + ~c*~x*(~C*(~d*((~b)^2) - 2 * ~a*(~c*~d - ~a*~f)) + ~A*(~f*((~b)^2) + 2 * ~d*((~c)^2) - 2 * ~a*~c*~f)) - ~b*(~A*~c - ~C*~a)*(~c*~d + ~a*~f))*((~d + ~f*((~x)^2))^(1 + ~q))*((~a + ~b*~x + ~c*((~x)^2))^(1 + ~p))*(((1 + ~p)^-1)*(((~b)^2 - 4 * ~a*~c)^-1)*(((~c*~d - ~a*~f)^2 + ~d*~f*((~b)^2))^-1))
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0), GtQ(~p, 0), NeQ(1 + ~p + ~q, 0), NeQ(3 + 2 * ~p + 2 * ~q, 0), Not(IGtQ(~p, 0)), Not(IGtQ(~q, 0))) 
 (~C*(~b*~f*~p - ~c*~e*(2 + ~q + 2 * ~p)) + ~B*~c*~f*(3 + 2 * ~p + 2 * ~q) + 2 * ~C*~c*~f*~x*(1 + ~p + ~q))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^(1 + ~q))*((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1)) - ((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1))*integrate(((~a + ~b*~x + ~c*((~x)^2))^(~p - 1))*((~d + ~e*~x + ~f*((~x)^2))^~q)*Simp(~x*((~C*~e*~f*~p*((~b)^2 - 4 * ~a*~c) - ~b*~c*(~C*((~e)^2 - 4 * ~d*~f)*(2 + ~q + 2 * ~p) + ~f*(3 + 2 * ~p + 2 * ~q)*(2 * ~A*~f + 2 * ~C*~d - ~B*~e)))*(1 + ~p + ~q) + 2 * ~p*(~c*~d - ~a*~f)*(~C*(1 + ~q)*(~c*~e - ~b*~f) - ~c*(~C*~e - ~B*~f)*(3 + 2 * ~p + 2 * ~q))) + ((~x)^2)*((~C*~p*((~f)^2)*((~b)^2 - 4 * ~a*~c) - ((~c)^2)*(~C*((~e)^2 - 4 * ~d*~f)*(2 + ~q + 2 * ~p) + ~f*(3 + 2 * ~p + 2 * ~q)*(2 * ~A*~f + 2 * ~C*~d - ~B*~e)))*(1 + ~p + ~q) + ~p*(~c*~e - ~b*~f)*(~C*(1 + ~q)*(~c*~e - ~b*~f) - ~c*(~C*~e - ~B*~f)*(3 + 2 * ~p + 2 * ~q))) + (~a*~c*(~C*(2 * ~d*~f - (2 + ~q + 2 * ~p)*((~e)^2)) + ~f*(~B*~e - 2 * ~A*~f)*(3 + 2 * ~p + 2 * ~q)) + ~C*~d*~f*~p*((~b)^2))*(1 + ~p + ~q) + ~p*(~b*~d - ~a*~e)*(~C*(1 + ~q)*(~c*~e - ~b*~f) - ~c*(~C*~e - ~B*~f)*(3 + 2 * ~p + 2 * ~q)), ~x), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0), GtQ(~p, 0), NeQ(1 + ~p + ~q, 0), NeQ(3 + 2 * ~p + 2 * ~q, 0), Not(IGtQ(~p, 0)), Not(IGtQ(~q, 0))) 
 ((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^(1 + ~q))*(~C*(~b*~f*~p - ~c*~e*(2 + ~q + 2 * ~p)) + 2 * ~C*~c*~f*~x*(1 + ~p + ~q))*((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1)) - ((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1))*integrate(((~a + ~b*~x + ~c*((~x)^2))^(~p - 1))*((~d + ~e*~x + ~f*((~x)^2))^~q)*Simp(((~x)^2)*((~C*~p*((~f)^2)*((~b)^2 - 4 * ~a*~c) - ((~c)^2)*(~f*(2 * ~A*~f + 2 * ~C*~d)*(3 + 2 * ~p + 2 * ~q) + ~C*((~e)^2 - 4 * ~d*~f)*(2 + ~q + 2 * ~p)))*(1 + ~p + ~q) + ~p*(~c*~e - ~b*~f)*(~C*(1 + ~q)*(~c*~e - ~b*~f) - ~C*~c*~e*(3 + 2 * ~p + 2 * ~q))) + ~x*((~C*~e*~f*~p*((~b)^2 - 4 * ~a*~c) - ~b*~c*(~f*(2 * ~A*~f + 2 * ~C*~d)*(3 + 2 * ~p + 2 * ~q) + ~C*((~e)^2 - 4 * ~d*~f)*(2 + ~q + 2 * ~p)))*(1 + ~p + ~q) + 2 * ~p*(~c*~d - ~a*~f)*(~C*(1 + ~q)*(~c*~e - ~b*~f) - ~C*~c*~e*(3 + 2 * ~p + 2 * ~q))) + (~a*~c*(~C*(2 * ~d*~f - (2 + ~q + 2 * ~p)*((~e)^2)) - 2 * ~A*(3 + 2 * ~p + 2 * ~q)*((~f)^2)) + ~C*~d*~f*~p*((~b)^2))*(1 + ~p + ~q) + ~p*(~b*~d - ~a*~e)*(~C*(1 + ~q)*(~c*~e - ~b*~f) - ~C*~c*~e*(3 + 2 * ~p + 2 * ~q)), ~x), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~q), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0), GtQ(~p, 0), NeQ(1 + ~p + ~q, 0), NeQ(3 + 2 * ~p + 2 * ~q, 0), Not(IGtQ(~p, 0)), Not(IGtQ(~q, 0))) 
 (~B*~c*~f*(3 + 2 * ~p + 2 * ~q) + 2 * ~C*~c*~f*~x*(1 + ~p + ~q) - ~C*~c*~e*(2 + ~q + 2 * ~p))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^(1 + ~q))*((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1)) - ((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1))*integrate(((~a + ~c*((~x)^2))^(~p - 1))*((~d + ~e*~x + ~f*((~x)^2))^~q)*Simp(((~x)^2)*((-((~c)^2)*(~C*((~e)^2 - 4 * ~d*~f)*(2 + ~q + 2 * ~p) + ~f*(3 + 2 * ~p + 2 * ~q)*(2 * ~A*~f + 2 * ~C*~d - ~B*~e)) - 4 * ~C*~a*~c*~p*((~f)^2))*(1 + ~p + ~q) + ~c*~e*~p*(~C*~c*~e*(1 + ~q) - ~c*(~C*~e - ~B*~f)*(3 + 2 * ~p + 2 * ~q))) + ~x*(2 * ~p*(~c*~d - ~a*~f)*(~C*~c*~e*(1 + ~q) - ~c*(~C*~e - ~B*~f)*(3 + 2 * ~p + 2 * ~q)) - 4 * ~C*~a*~c*~e*~f*~p*(1 + ~p + ~q)) + ~a*~c*(~C*(2 * ~d*~f - (2 + ~q + 2 * ~p)*((~e)^2)) + ~f*(~B*~e - 2 * ~A*~f)*(3 + 2 * ~p + 2 * ~q))*(1 + ~p + ~q) - ~a*~e*~p*(~C*~c*~e*(1 + ~q) - ~c*(~C*~e - ~B*~f)*(3 + 2 * ~p + 2 * ~q)), ~x), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~C, ~q), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0), GtQ(~p, 0), NeQ(1 + ~p + ~q, 0), NeQ(3 + 2 * ~p + 2 * ~q, 0), Not(IGtQ(~p, 0)), Not(IGtQ(~q, 0))) 
 ((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^(1 + ~q))*(2 * ~C*~c*~f*~x*(1 + ~p + ~q) - ~C*~c*~e*(2 + ~q + 2 * ~p))*((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1)) - ((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1))*integrate(((~a + ~c*((~x)^2))^(~p - 1))*((~d + ~e*~x + ~f*((~x)^2))^~q)*Simp(~x*(2 * ~p*(~c*~d - ~a*~f)*(~C*~c*~e*(1 + ~q) - ~C*~c*~e*(3 + 2 * ~p + 2 * ~q)) - 4 * ~C*~a*~c*~e*~f*~p*(1 + ~p + ~q)) + ((~x)^2)*((-((~c)^2)*(~f*(2 * ~A*~f + 2 * ~C*~d)*(3 + 2 * ~p + 2 * ~q) + ~C*((~e)^2 - 4 * ~d*~f)*(2 + ~q + 2 * ~p)) - 4 * ~C*~a*~c*~p*((~f)^2))*(1 + ~p + ~q) + ~c*~e*~p*(~C*~c*~e*(1 + ~q) - ~C*~c*~e*(3 + 2 * ~p + 2 * ~q))) + ~a*~c*(~C*(2 * ~d*~f - (2 + ~q + 2 * ~p)*((~e)^2)) - 2 * ~A*(3 + 2 * ~p + 2 * ~q)*((~f)^2))*(1 + ~p + ~q) - ~a*~e*~p*(~C*~c*~e*(1 + ~q) - ~C*~c*~e*(3 + 2 * ~p + 2 * ~q)), ~x), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~B, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), GtQ(~p, 0), NeQ(1 + ~p + ~q, 0), NeQ(3 + 2 * ~p + 2 * ~q, 0), Not(IGtQ(~p, 0)), Not(IGtQ(~q, 0))) 
 (~B*~c*~f*(3 + 2 * ~p + 2 * ~q) + ~C*~b*~f*~p + 2 * ~C*~c*~f*~x*(1 + ~p + ~q))*((~d + ~f*((~x)^2))^(1 + ~q))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1)) - ((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1))*integrate(((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^(~p - 1))*Simp(~x*(2 * ~p*(~c*~d - ~a*~f)*(~B*~c*~f*(3 + 2 * ~p + 2 * ~q) - ~C*~b*~f*(1 + ~q)) - ~b*~c*(~f*(2 * ~A*~f + 2 * ~C*~d)*(3 + 2 * ~p + 2 * ~q) - 4 * ~C*~d*~f*(2 + ~q + 2 * ~p))*(1 + ~p + ~q)) + ((~x)^2)*((~C*~p*((~f)^2)*((~b)^2 - 4 * ~a*~c) - ((~c)^2)*(~f*(2 * ~A*~f + 2 * ~C*~d)*(3 + 2 * ~p + 2 * ~q) - 4 * ~C*~d*~f*(2 + ~q + 2 * ~p)))*(1 + ~p + ~q) - ~b*~f*~p*(~B*~c*~f*(3 + 2 * ~p + 2 * ~q) - ~C*~b*~f*(1 + ~q))) + (~a*~c*(2 * ~C*~d*~f - 2 * ~A*(3 + 2 * ~p + 2 * ~q)*((~f)^2)) + ~C*~d*~f*~p*((~b)^2))*(1 + ~p + ~q) + ~b*~d*~p*(~B*~c*~f*(3 + 2 * ~p + 2 * ~q) - ~C*~b*~f*(1 + ~q)), ~x), ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^~p), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~C, ~q), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), GtQ(~p, 0), NeQ(1 + ~p + ~q, 0), NeQ(3 + 2 * ~p + 2 * ~q, 0), Not(IGtQ(~p, 0)), Not(IGtQ(~q, 0))) 
 ((~d + ~f*((~x)^2))^(1 + ~q))*((~a + ~b*~x + ~c*((~x)^2))^~p)*(~C*~b*~f*~p + 2 * ~C*~c*~f*~x*(1 + ~p + ~q))*((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1)) - ((1//2)*((~c)^-1)*((~f)^-2)*((1 + ~p + ~q)^-1)*((3 + 2 * ~p + 2 * ~q)^-1))*integrate(((~d + ~f*((~x)^2))^~q)*((~a + ~b*~x + ~c*((~x)^2))^(~p - 1))*Simp(((~x)^2)*((~C*~p*((~f)^2)*((~b)^2 - 4 * ~a*~c) - ((~c)^2)*(~f*(2 * ~A*~f + 2 * ~C*~d)*(3 + 2 * ~p + 2 * ~q) - 4 * ~C*~d*~f*(2 + ~q + 2 * ~p)))*(1 + ~p + ~q) + ~C*~p*((~b)^2)*((~f)^2)*(1 + ~q)) + ~x*(-~b*~c*(~f*(2 * ~A*~f + 2 * ~C*~d)*(3 + 2 * ~p + 2 * ~q) - 4 * ~C*~d*~f*(2 + ~q + 2 * ~p))*(1 + ~p + ~q) - 2 * ~C*~b*~f*~p*(1 + ~q)*(~c*~d - ~a*~f)) + (~a*~c*(2 * ~C*~d*~f - 2 * ~A*(3 + 2 * ~p + 2 * ~q)*((~f)^2)) + ~C*~d*~f*~p*((~b)^2))*(1 + ~p + ~q) - ~C*~d*~f*~p*((~b)^2)*(1 + ~q), ~x), ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*(((~a + ~b*~x + ~c*((~x)^2))^-1)*((~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0)) 
 With(List(Set(~q, ((~c)^2)*((~d)^2) + ((~a)^2)*((~f)^2) + ~a*~c*((~e)^2) + ~d*~f*((~b)^2) - ~b*~c*~d*~e - ~a*~b*~e*~f - 2 * ~a*~c*~d*~f)), Condition(((~q)^-1)*integrate((~C*~c*((~d)^2) + ~A*~c*((~e)^2) + ~A*~a*((~f)^2) + ~B*~b*~d*~f - ~f*~x*(~C*~a*~e + ~A*~b*~f + ~B*~c*~d - ~B*~a*~f - ~C*~b*~d - ~A*~c*~e) - ~A*~c*~d*~f - ~B*~c*~d*~e - ~C*~a*~d*~f - ~A*~b*~e*~f)*((~d + ~e*~x + ~f*((~x)^2))^-1), ~x) + ((~q)^-1)*integrate((~A*~f*((~b)^2) + ~C*~f*((~a)^2) + ~c*~x*(~C*~a*~e + ~A*~b*~f + ~B*~c*~d - ~B*~a*~f - ~C*~b*~d - ~A*~c*~e) + ~A*~d*((~c)^2) + ~B*~a*~c*~e - ~A*~b*~c*~e - ~A*~a*~c*~f - ~B*~a*~b*~f - ~C*~a*~c*~d)*((~a + ~b*~x + ~c*((~x)^2))^-1), ~x), NeQ(~q, 0)))
 end

@rule integrate((~A + ~C*((~x)^2))*(((~a + ~b*~x + ~c*((~x)^2))^-1)*((~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0)) 
 With(List(Set(~q, ((~c)^2)*((~d)^2) + ((~a)^2)*((~f)^2) + ~a*~c*((~e)^2) + ~d*~f*((~b)^2) - ~b*~c*~d*~e - ~a*~b*~e*~f - 2 * ~a*~c*~d*~f)), Condition(((~q)^-1)*integrate((~C*~c*((~d)^2) + ~A*~c*((~e)^2) + ~A*~a*((~f)^2) - ~f*~x*(~C*~a*~e + ~A*~b*~f - ~C*~b*~d - ~A*~c*~e) - ~A*~c*~d*~f - ~C*~a*~d*~f - ~A*~b*~e*~f)*((~d + ~e*~x + ~f*((~x)^2))^-1), ~x) + ((~q)^-1)*integrate((~A*~f*((~b)^2) + ~C*~f*((~a)^2) + ~c*~x*(~C*~a*~e + ~A*~b*~f - ~C*~b*~d - ~A*~c*~e) + ~A*~d*((~c)^2) - ~A*~b*~c*~e - ~A*~a*~c*~f - ~C*~a*~c*~d)*((~a + ~b*~x + ~c*((~x)^2))^-1), ~x), NeQ(~q, 0)))
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*(((~d + ~f*((~x)^2))^-1)*((~a + ~b*~x + ~c*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~B, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0)) 
 With(List(Set(~q, ((~c)^2)*((~d)^2) + ((~a)^2)*((~f)^2) + ~d*~f*((~b)^2) - 2 * ~a*~c*~d*~f)), Condition(((~q)^-1)*integrate((~C*~c*((~d)^2) + ~A*~a*((~f)^2) + ~B*~b*~d*~f - ~f*~x*(~A*~b*~f + ~B*~c*~d - ~B*~a*~f - ~C*~b*~d) - ~A*~c*~d*~f - ~C*~a*~d*~f)*((~d + ~f*((~x)^2))^-1), ~x) + ((~q)^-1)*integrate((~c*~x*(~A*~b*~f + ~B*~c*~d - ~B*~a*~f - ~C*~b*~d) + ~A*~f*((~b)^2) + ~C*~f*((~a)^2) + ~A*~d*((~c)^2) - ~A*~a*~c*~f - ~B*~a*~b*~f - ~C*~a*~c*~d)*((~a + ~b*~x + ~c*((~x)^2))^-1), ~x), NeQ(~q, 0)))
 end

@rule integrate((~A + ~C*((~x)^2))*(((~d + ~f*((~x)^2))^-1)*((~a + ~b*~x + ~c*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0)) 
 With(List(Set(~q, ((~c)^2)*((~d)^2) + ((~a)^2)*((~f)^2) + ~d*~f*((~b)^2) - 2 * ~a*~c*~d*~f)), Condition(((~q)^-1)*integrate((~C*~c*((~d)^2) + ~A*~a*((~f)^2) - ~f*~x*(~A*~b*~f - ~C*~b*~d) - ~A*~c*~d*~f - ~C*~a*~d*~f)*((~d + ~f*((~x)^2))^-1), ~x) + ((~q)^-1)*integrate((~A*~f*((~b)^2) + ~C*~f*((~a)^2) + ~A*~d*((~c)^2) + ~c*~x*(~A*~b*~f - ~C*~b*~d) - ~A*~a*~c*~f - ~C*~a*~c*~d)*((~a + ~b*~x + ~c*((~x)^2))^-1), ~x), NeQ(~q, 0)))
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0)) 
 ((~c)^-1)*integrate((~A*~c + ~x*(~B*~c - ~C*~b) - ~C*~a)*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) + ~C*((~c)^-1)*integrate(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1, ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0), NeQ((~e)^2 - 4 * ~d*~f, 0)) 
 ((~c)^-1)*integrate((~A*~c - ~C*~a - ~C*~b*~x)*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) + ~C*((~c)^-1)*integrate(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1, ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*(((~a + ~c*((~x)^2))^-1)*(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0)) 
 ((~c)^-1)*integrate((~A*~c + ~B*~c*~x - ~C*~a)*(((~a + ~c*((~x)^2))^-1)*(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) + ~C*((~c)^-1)*integrate(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1, ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*(((~a + ~c*((~x)^2))^-1)*(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ((~e)^2 - 4 * ~d*~f, 0)) 
 ((~c)^-1)*(~A*~c - ~C*~a)*integrate(((~a + ~c*((~x)^2))*Sqrt(~d + ~e*~x + ~f*((~x)^2)))^-1, ~x) + ~C*((~c)^-1)*integrate(Sqrt(~d + ~e*~x + ~f*((~x)^2))^-1, ~x)
 end

@rule integrate((~A + ~B*~x + ~C*((~x)^2))*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~B, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0)) 
 ((~c)^-1)*integrate((~A*~c + ~x*(~B*~c - ~C*~b) - ~C*~a)*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~f*((~x)^2))^-1)), ~x) + ~C*((~c)^-1)*integrate(Sqrt(~d + ~f*((~x)^2))^-1, ~x)
 end

@rule integrate((~A + ~C*((~x)^2))*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~f*((~x)^2))^-1)), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~f, ~A, ~C), ~x), NeQ((~b)^2 - 4 * ~a*~c, 0)) 
 ((~c)^-1)*integrate((~A*~c - ~C*~a - ~C*~b*~x)*(((~a + ~b*~x + ~c*((~x)^2))^-1)*(Sqrt(~d + ~f*((~x)^2))^-1)), ~x) + ~C*((~c)^-1)*integrate(Sqrt(~d + ~f*((~x)^2))^-1, ~x)
 end

@rule integrate((~A + ~B*~u + ~C*((~u)^2))*((~a + ~b*~u + ~c*((~u)^2))^~p)*((~d + ~e*~u + ~f*((~u)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~p, ~q), ~x), LinearQ(~u, ~x), NeQ(~u, ~x)) 
 (Coefficient(~u, ~x, 1)^-1)*Subst(integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x), ~x, ~u)
 end

@rule integrate((~A + ~B*~u)*((~a + ~b*~u + ~c*((~u)^2))^~p)*((~d + ~e*~u + ~f*((~u)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~p, ~q), ~x), LinearQ(~u, ~x), NeQ(~u, ~x)) 
 (Coefficient(~u, ~x, 1)^-1)*Subst(integrate((~A + ~B*~x)*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x), ~x, ~u)
 end

@rule integrate((~A + ~C*((~u)^2))*((~a + ~b*~u + ~c*((~u)^2))^~p)*((~d + ~e*~u + ~f*((~u)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~p, ~q), ~x), LinearQ(~u, ~x), NeQ(~u, ~x)) 
 (Coefficient(~u, ~x, 1)^-1)*Subst(integrate((~A + ~C*((~x)^2))*((~a + ~b*~x + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x), ~x, ~u)
 end

@rule integrate((~A + ~B*~u + ~C*((~u)^2))*((~a + ~c*((~u)^2))^~p)*((~d + ~e*~u + ~f*((~u)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~p, ~q), ~x), LinearQ(~u, ~x), NeQ(~u, ~x)) 
 (Coefficient(~u, ~x, 1)^-1)*Subst(integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x), ~x, ~u)
 end

@rule integrate((~A + ~B*~u)*((~a + ~c*((~u)^2))^~p)*((~d + ~e*~u + ~f*((~u)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~p, ~q), ~x), LinearQ(~u, ~x), NeQ(~u, ~x)) 
 (Coefficient(~u, ~x, 1)^-1)*Subst(integrate((~A + ~B*~x)*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x), ~x, ~u)
 end

@rule integrate((~A + ~C*((~u)^2))*((~a + ~c*((~u)^2))^~p)*((~d + ~e*~u + ~f*((~u)^2))^~q), ~x) =>  if And(FreeQ(List(~a, ~c, ~d, ~e, ~f, ~A, ~C, ~p, ~q), ~x), LinearQ(~u, ~x), NeQ(~u, ~x)) 
 (Coefficient(~u, ~x, 1)^-1)*Subst(integrate((~A + ~C*((~x)^2))*((~a + ~c*((~x)^2))^~p)*((~d + ~e*~x + ~f*((~x)^2))^~q), ~x), ~x, ~u)
 end


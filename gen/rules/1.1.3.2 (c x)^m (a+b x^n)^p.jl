@rule With(List(Set(~s, Denominator(~q))), ~s*Subst(integrate(((~x)^(~s - 1))*((~a + ~b*((~d*((~x)^(~q*~s)))^~n))^~p), ~x), ~x, (~x)^((~s)^-1))) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule integrate(((~a1*~a2 + ~b1*~b2*((~x)^(2~n)))^~p)*((~c*~x)^~m), ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule (((~b)^-1)*((~n)^-1))*Log(RemoveContent(~a + ~b*((~x)^~n), ~x)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((1//2)*(~b1^-1)*(~b2^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule integrate(((~x)^(~m + ~n*~p))*((~b + ~a*((~x)^(-~n)))^~p), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*(((~a)^-1)*((~c)^-1)*((1 + ~m)^-1)) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*((~a1^-1)*(~a2^-1)*((~c)^-1)*((1 + ~m)^-1)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~n)^-1)*Subst(integrate(((~x)^(Simplify((1 + ~m)*((~n)^-1)) - 1))*((~a + ~b*~x)^~p), ~x), ~x, (~x)^~n) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((~n)^-1)*Subst(integrate(((~x)^(Simplify((1 + ~m)*((~n)^-1)) - 1))*((~a1 + ~b1*~x)^~p)*((~a2 + ~b2*~x)^~p), ~x), ~x, (~x)^~n) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule integrate(ExpandIntegrand(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x), ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~x)^(1 + ~m))*((~a + ~b*((~x)^~n))^(1 + ~p))*(((~a)^-1)*((1 + ~m)^-1)) - ~b*(1 + ~m + ~n*(1 + ~p))*(((~a)^-1)*((1 + ~m)^-1))*integrate(((~x)^(~m + ~n))*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((~x)^(1 + ~m))*((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~a1^-1)*(~a2^-1)*((1 + ~m)^-1)) - ~b1*~b2*(1 + ~m + 2~n*(1 + ~p))*((~a1^-1)*(~a2^-1)*((1 + ~m)^-1))*integrate(((~x)^(~m + 2~n))*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule (1 + ~m + ~n*(1 + ~p))*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^~m), ~x) - ((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*(((~a)^-1)*((~c)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule (1 + ~m + 2~n*(1 + ~p))*((1//2)*(~a1^-1)*(~a2^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^~m), ~x) - ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*((1//2)*(~a1^-1)*(~a2^-1)*((~c)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule With(List(Set(~k, GCD(1 + ~m, ~n))), Condition(((~k)^-1)*Subst(integrate(((~x)^(((~k)^-1)*(1 + ~m) - 1))*((~a + ~b*((~x)^(~n*((~k)^-1))))^~p), ~x), ~x, (~x)^~k), Unequal(~k, 1))) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule With(List(Set(~k, GCD(1 + ~m, 2~n))), Condition(((~k)^-1)*Subst(integrate(((~x)^(((~k)^-1)*(1 + ~m) - 1))*((~a1 + ~b1*((~x)^(~n*((~k)^-1))))^~p)*((~a2 + ~b2*((~x)^(~n*((~k)^-1))))^~p), ~x), ~x, (~x)^~k), Unequal(~k, 1))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a + ~b*((~x)^~n))^~p)*(((~c)^-1)*((1 + ~m)^-1))*((~c*~x)^(1 + ~m)) - ~b*~n*~p*(((~c)^(-~n))*((1 + ~m)^-1))*integrate(((~a + ~b*((~x)^~n))^(~p - 1))*((~c*~x)^(~m + ~n)), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*(((~c)^-1)*((1 + ~m)^-1))*((~c*~x)^(1 + ~m)) - 2~b1*~b2*~n*~p*(((~c)^(-2~n))*((1 + ~m)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^(~p - 1))*((~a2 + ~b2*((~x)^~n))^(~p - 1))*((~c*~x)^(~m + 2~n)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a + ~b*((~x)^~n))^~p)*(((~c)^-1)*((1 + ~m + ~n*~p)^-1))*((~c*~x)^(1 + ~m)) + ~a*~n*~p*((1 + ~m + ~n*~p)^-1)*integrate(((~a + ~b*((~x)^~n))^(~p - 1))*((~c*~x)^~m), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*(((~c)^-1)*((1 + ~m + 2~n*~p)^-1))*((~c*~x)^(1 + ~m)) + 2~a1*~a2*~n*~p*((1 + ~m + 2~n*~p)^-1)*integrate(((~a1 + ~b1*((~x)^~n))^(~p - 1))*((~a2 + ~b2*((~x)^~n))^(~p - 1))*((~c*~x)^~m), ~x) => integrate(((~x)^2)*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x)

@rule ~x*(((~b)^-1)*((~a + ~b*((~x)^4))^(-(1//4))))*((1 + ~a*(((~b)^-1)*((~x)^-4)))^(4^-1))*integrate((((~x)^3)*((1 + ~a*(((~b)^-1)*((~x)^-4)))^((5//1)*(1//4))))^-1, ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x)

@rule ((~x)^(~m - 3))*(((~b)^-1)*((~m - 4)^-1)*((~a + ~b*((~x)^4))^(-(1//4)))) - ~a*(~m - 3)*(((~b)^-1)*((~m - 4)^-1))*integrate(((~x)^(~m - 4))*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x)

@rule ((~x)^(1 + ~m))*(((~a)^-1)*((1 + ~m)^-1)*((~a + ~b*((~x)^4))^(-(1//4)))) - ~b*~m*(((~a)^-1)*((1 + ~m)^-1))*integrate(((~x)^(4 + ~m))*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x) => integrate(((~a + ~b*((~x)^2))^((-5//1)*(1//4)))*sqrt(~c*~x), ~x)

@rule (((~b)^-1)*((~a + ~b*((~x)^2))^(-(1//4))))*((1 + ~a*(((~b)^-1)*((~x)^-2)))^(4^-1))*sqrt(~c*~x)*integrate((((~x)^2)*((1 + ~a*(((~b)^-1)*((~x)^-2)))^((5//1)*(1//4))))^-1, ~x) => integrate(((~a + ~b*((~x)^2))^((-5//1)*(1//4)))*((~c*~x)^~m), ~x)

@rule 2~c*((~c*~x)^(~m - 1))*(((~b)^-1)*((2~m - 3)^-1)*((~a + ~b*((~x)^2))^(-(1//4)))) - 2~a*((~c)^2)*(~m - 1)*(((~b)^-1)*((2~m - 3)^-1))*integrate(((~a + ~b*((~x)^2))^((-5//1)*(1//4)))*((~c*~x)^(~m - 2)), ~x) => integrate(((~a + ~b*((~x)^2))^((-5//1)*(1//4)))*((~c*~x)^~m), ~x)

@rule ((~c*~x)^(1 + ~m))*(((~a)^-1)*((~c)^-1)*((1 + ~m)^-1)*((~a + ~b*((~x)^2))^(-(1//4)))) - ~b*(1 + 2~m)*((1//2)*((~a)^-1)*((~c)^-2)*((1 + ~m)^-1))*integrate(((~a + ~b*((~x)^2))^((-5//1)*(1//4)))*((~c*~x)^(2 + ~m)), ~x) => integrate(((~x)^2)*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x)

@rule -((~b)^-1)*integrate((((~x)^2)*((~a + ~b*((~x)^4))^(4^-1)))^-1, ~x) - ((~b)^-1)*((~x)^-1)*((~a + ~b*((~x)^4))^(-(1//4))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^(~n - 1))*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m - ~n))*(((~b)^-1)*((~n)^-1)*((1 + ~p)^-1)) - (1 + ~m - ~n)*((~c)^~n)*(((~b)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(~m - ~n)), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^(2~n - 1))*((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m - 2~n))*((1//2)*(~b1^-1)*(~b2^-1)*((~n)^-1)*((1 + ~p)^-1)) - (1 + ~m - 2~n)*((~c)^(2~n))*((1//2)*(~b1^-1)*(~b2^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(~m - 2~n)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule (1 + ~m + ~n*(1 + ~p))*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^~m), ~x) - ((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*(((~a)^-1)*((~c)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule (1 + ~m + 2~n*(1 + ~p))*((1//2)*(~a1^-1)*(~a2^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^~m), ~x) - ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*((1//2)*(~a1^-1)*(~a2^-1)*((~c)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(~x*((~a + ~b*((~x)^3))^-1), ~x)

@rule ((1//3)*(Rt(~a, 3)^-1)*(Rt(~b, 3)^-1))*integrate(((((~x)^2)*(Rt(~b, 3)^2) + Rt(~a, 3)^2 - ~x*Rt(~a, 3)*Rt(~b, 3))^-1)*(~x*Rt(~b, 3) + Rt(~a, 3)), ~x) - ((1//3)*(Rt(~a, 3)^-1)*(Rt(~b, 3)^-1))*integrate((~x*Rt(~b, 3) + Rt(~a, 3))^-1, ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule Module(List(Set(~r, Numerator(Rt(~a*((~b)^-1), ~n))), Set(~s, Denominator(Rt(~a*((~b)^-1), ~n))), ~k, ~u), CompoundExpression(Set(~u, integrate((((~r)^2 + ((~s)^2)*((~x)^2) - 2~r*~s*~x*cos(~Pi*((~n)^-1)*(2~k - 1)))^-1)*(~r*cos(~Pi*~m*((~n)^-1)*(2~k - 1)) - ~s*~x*cos(~Pi*(1 + ~m)*((~n)^-1)*(2~k - 1))), ~x)), Dist(2((~r)^(1 + ~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m))), Sum(~u, List(~k, 1, (1//2)*(~n - 1))), ~x) - ((-~r)^(1 + ~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m)))*integrate((~r + ~s*~x)^-1, ~x))) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule Module(List(Set(~r, Numerator(Rt(-~a*((~b)^-1), ~n))), Set(~s, Denominator(Rt(-~a*((~b)^-1), ~n))), ~k, ~u), CompoundExpression(Set(~u, integrate((((~r)^2 + ((~s)^2)*((~x)^2) + 2~r*~s*~x*cos(~Pi*((~n)^-1)*(2~k - 1)))^-1)*(~r*cos(~Pi*~m*((~n)^-1)*(2~k - 1)) + ~s*~x*cos(~Pi*(1 + ~m)*((~n)^-1)*(2~k - 1))), ~x)), ((~r)^(1 + ~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m)))*integrate((~r - ~s*~x)^-1, ~x) - Dist(2((-~r)^(1 + ~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m))), Sum(~u, List(~k, 1, (1//2)*(~n - 1))), ~x))) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule Module(List(Set(~r, Numerator(Rt(~a*((~b)^-1), ~n))), Set(~s, Denominator(Rt(~a*((~b)^-1), ~n))), ~k, ~u), CompoundExpression(Set(~u, integrate((((~r)^2 + ((~s)^2)*((~x)^2) + 2~r*~s*~x*cos(~Pi*((~n)^-1)*(2~k - 1)))^-1)*(~r*cos(~Pi*~m*((~n)^-1)*(2~k - 1)) + ~s*~x*cos(~Pi*(1 + ~m)*((~n)^-1)*(2~k - 1))), ~x) + integrate((((~r)^2 + ((~s)^2)*((~x)^2) - 2~r*~s*~x*cos(~Pi*((~n)^-1)*(2~k - 1)))^-1)*(~r*cos(~Pi*~m*((~n)^-1)*(2~k - 1)) - ~s*~x*cos(~Pi*(1 + ~m)*((~n)^-1)*(2~k - 1))), ~x)), 2((~r)^(2 + ~m))*((-1)^((1//2)*~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m)))*integrate(((~r)^2 + ((~s)^2)*((~x)^2))^-1, ~x) + Dist(2((~r)^(1 + ~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m))), Sum(~u, List(~k, 1, (1//4)*(~n - 2))), ~x))) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule Module(List(Set(~r, Numerator(Rt(-~a*((~b)^-1), ~n))), Set(~s, Denominator(Rt(-~a*((~b)^-1), ~n))), ~k, ~u), CompoundExpression(Set(~u, integrate((((~r)^2 + ((~s)^2)*((~x)^2) + 2~r*~s*~x*cos(2~Pi*~k*((~n)^-1)))^-1)*(~r*cos(2~Pi*~k*~m*((~n)^-1)) + ~s*~x*cos(2~Pi*~k*(1 + ~m)*((~n)^-1))), ~x) + integrate((((~r)^2 + ((~s)^2)*((~x)^2) - 2~r*~s*~x*cos(2~Pi*~k*((~n)^-1)))^-1)*(~r*cos(2~Pi*~k*~m*((~n)^-1)) - ~s*~x*cos(2~Pi*~k*(1 + ~m)*((~n)^-1))), ~x)), 2((~r)^(2 + ~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m)))*integrate(((~r)^2 - ((~s)^2)*((~x)^2))^-1, ~x) + Dist(2((~r)^(1 + ~m))*(((~a)^-1)*((~n)^-1)*((~s)^(-~m))), Sum(~u, List(~k, 1, (1//4)*(~n - 2))), ~x))) => integrate(((~x)^2)*((~a + ~b*((~x)^4))^-1), ~x)

@rule With(List(Set(~r, Numerator(Rt(~a*((~b)^-1), 2))), Set(~s, Denominator(Rt(~a*((~b)^-1), 2)))), ((1//2)*((~s)^-1))*integrate((~r + ~s*((~x)^2))*((~a + ~b*((~x)^4))^-1), ~x) - ((1//2)*((~s)^-1))*integrate((~r - ~s*((~x)^2))*((~a + ~b*((~x)^4))^-1), ~x)) => integrate(((~x)^2)*((~a + ~b*((~x)^4))^-1), ~x)

@rule With(List(Set(~r, Numerator(Rt(-~a*((~b)^-1), 2))), Set(~s, Denominator(Rt(-~a*((~b)^-1), 2)))), ~s*((1//2)*((~b)^-1))*integrate((~r + ~s*((~x)^2))^-1, ~x) - ~s*((1//2)*((~b)^-1))*integrate((~r - ~s*((~x)^2))^-1, ~x)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule With(List(Set(~r, Numerator(Rt(~a*((~b)^-1), 4))), Set(~s, Denominator(Rt(~a*((~b)^-1), 4)))), ((~s)^3)*(0.35355339059327373((~b)^-1)*((~r)^-1))*integrate(((~x)^(~m - (1//4)*~n))*(((~r)^2 + ((~s)^2)*((~x)^((1//2)*~n)) - 1.4142135623730951~r*~s*((~x)^((1//4)*~n)))^-1), ~x) - ((~s)^3)*(0.35355339059327373((~b)^-1)*((~r)^-1))*integrate(((~x)^(~m - (1//4)*~n))*(((~r)^2 + ((~s)^2)*((~x)^((1//2)*~n)) + 1.4142135623730951~r*~s*((~x)^((1//4)*~n)))^-1), ~x)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule With(List(Set(~r, Numerator(Rt(-~a*((~b)^-1), 2))), Set(~s, Denominator(Rt(-~a*((~b)^-1), 2)))), ~r*((1//2)*((~a)^-1))*integrate(((~x)^~m)*((~r + ~s*((~x)^((1//2)*~n)))^-1), ~x) + ~r*((1//2)*((~a)^-1))*integrate(((~x)^~m)*((~r - ~s*((~x)^((1//2)*~n)))^-1), ~x)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule With(List(Set(~r, Numerator(Rt(-~a*((~b)^-1), 2))), Set(~s, Denominator(Rt(-~a*((~b)^-1), 2)))), ~s*((1//2)*((~b)^-1))*integrate(((~x)^(~m - (1//2)*~n))*((~r + ~s*((~x)^((1//2)*~n)))^-1), ~x) - ~s*((1//2)*((~b)^-1))*integrate(((~x)^(~m - (1//2)*~n))*((~r - ~s*((~x)^((1//2)*~n)))^-1), ~x)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule integrate(PolynomialDivide((~x)^~m, ~a + ~b*((~x)^~n), ~x), ~x) => integrate(~x*(sqrt(~a + ~b*((~x)^3))^-1), ~x)

@rule With(List(Set(~r, Numer(Rt(~b*((~a)^-1), 3))), Set(~s, Denom(Rt(~b*((~a)^-1), 3)))), ((~r)^-1)*integrate((~r*~x - 0.7320508075688772~s)*(sqrt(~a + ~b*((~x)^3))^-1), ~x) + 0.7320508075688772~s*((~r)^-1)*integrate(sqrt(~a + ~b*((~x)^3))^-1, ~x)) => integrate(~x*(sqrt(~a + ~b*((~x)^3))^-1), ~x)

@rule With(List(Set(~r, Numer(Rt(~b*((~a)^-1), 3))), Set(~s, Denom(Rt(~b*((~a)^-1), 3)))), ((~r)^-1)*integrate((2.732050807568877~s + ~r*~x)*(sqrt(~a + ~b*((~x)^3))^-1), ~x) - 2.732050807568877~s*((~r)^-1)*integrate(sqrt(~a + ~b*((~x)^3))^-1, ~x)) => integrate(((~x)^2)*(sqrt(~a + ~b*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, Rt(~b*((~a)^-1), 2))), ((~q)^-1)*integrate(sqrt(~a + ~b*((~x)^4))^-1, ~x) - ((~q)^-1)*integrate((1 - ~q*((~x)^2))*(sqrt(~a + ~b*((~x)^4))^-1), ~x)) => integrate(((~x)^2)*(sqrt(~a + ~b*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, Rt(-~b*((~a)^-1), 2))), ((~q)^-1)*integrate(sqrt(~a + ~b*((~x)^4))^-1, ~x) - ((~q)^-1)*integrate((1 - ~q*((~x)^2))*(sqrt(~a + ~b*((~x)^4))^-1), ~x)) => integrate(((~x)^2)*(sqrt(~a + ~b*((~x)^4))^-1), ~x)

@rule With(List(Set(~q, Rt(-~b*((~a)^-1), 2))), ((~q)^-1)*integrate((1 + ~q*((~x)^2))*(sqrt(~a + ~b*((~x)^4))^-1), ~x) - ((~q)^-1)*integrate(sqrt(~a + ~b*((~x)^4))^-1, ~x)) => integrate(((~x)^4)*(sqrt(~a + ~b*((~x)^6))^-1), ~x)

@rule With(List(Set(~r, Numer(Rt(~b*((~a)^-1), 3))), Set(~s, Denom(Rt(~b*((~a)^-1), 3)))), 0.7320508075688772((~s)^2)*((1//2)*((~r)^-2))*integrate(sqrt(~a + ~b*((~x)^6))^-1, ~x) - ((1//2)*((~r)^-2))*integrate((0.7320508075688772((~s)^2) - 2((~r)^2)*((~x)^4))*(sqrt(~a + ~b*((~x)^6))^-1), ~x)) => integrate(((~x)^2)*(sqrt(~a + ~b*((~x)^8))^-1), ~x)

@rule ((1//2)*(Rt(~b*((~a)^-1), 4)^-1))*integrate((1 + ((~x)^2)*Rt(~b*((~a)^-1), 4))*(sqrt(~a + ~b*((~x)^8))^-1), ~x) - ((1//2)*(Rt(~b*((~a)^-1), 4)^-1))*integrate((1 - ((~x)^2)*Rt(~b*((~a)^-1), 4))*(sqrt(~a + ~b*((~x)^8))^-1), ~x) => integrate(((~x)^2)*((~a + ~b*((~x)^4))^(-(1//4))), ~x)

@rule ((~x)^3)*((1//2)*((~a + ~b*((~x)^4))^(-(1//4)))) - (1//2)*~a*integrate(((~x)^2)*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x) => integrate(((~x)^2)*((~a + ~b*((~x)^4))^(-(1//4))), ~x)

@rule ((~a + ~b*((~x)^4))^((3//1)*(1//4)))*((1//2)*((~b)^-1)*((~x)^-1)) + ~a*((1//2)*((~b)^-1))*integrate((((~x)^2)*((~a + ~b*((~x)^4))^(4^-1)))^-1, ~x) => integrate((((~x)^2)*((~a + ~b*((~x)^4))^(4^-1)))^-1, ~x)

@rule -~b*integrate(((~x)^2)*((~a + ~b*((~x)^4))^((-5//1)*(1//4))), ~x) - ((~x)^-1)*((~a + ~b*((~x)^4))^(-(1//4))) => integrate((((~x)^2)*((~a + ~b*((~x)^4))^(4^-1)))^-1, ~x)

@rule ~x*((1 + ~a*(((~b)^-1)*((~x)^-4)))^(4^-1))*((~a + ~b*((~x)^4))^(-(1//4)))*integrate((((~x)^3)*((1 + ~a*(((~b)^-1)*((~x)^-4)))^(4^-1)))^-1, ~x) => integrate(((~a + ~b*((~x)^2))^(-(1//4)))*sqrt(~c*~x), ~x)

@rule ~x*((~a + ~b*((~x)^2))^(-(1//4)))*sqrt(~c*~x) - (1//2)*~a*integrate(((~a + ~b*((~x)^2))^((-5//1)*(1//4)))*sqrt(~c*~x), ~x) => integrate(((~a + ~b*((~x)^2))^(-(1//4)))*sqrt(~c*~x), ~x)

@rule ~c*((~a + ~b*((~x)^2))^((3//1)*(1//4)))*(((~b)^-1)*(sqrt(~c*~x)^-1)) + ~a*((~c)^2)*((1//2)*((~b)^-1))*integrate((((~a + ~b*((~x)^2))^(4^-1))*((~c*~x)^((3//1)*(1//2))))^-1, ~x) => integrate((((~a + ~b*((~x)^2))^(4^-1))*((~c*~x)^((3//1)*(1//2))))^-1, ~x)

@rule (-2//1)*((~c)^-1)*((~a + ~b*((~x)^2))^(-(1//4)))*(sqrt(~c*~x)^-1) - ~b*((~c)^-2)*integrate(((~a + ~b*((~x)^2))^((-5//1)*(1//4)))*sqrt(~c*~x), ~x) => integrate((((~a + ~b*((~x)^2))^(4^-1))*((~c*~x)^((3//1)*(1//2))))^-1, ~x)

@rule (((~c)^-2)*((~a + ~b*((~x)^2))^(-(1//4))))*((1 + ~a*(((~b)^-1)*((~x)^-2)))^(4^-1))*sqrt(~c*~x)*integrate((((~x)^2)*((1 + ~a*(((~b)^-1)*((~x)^-2)))^(4^-1)))^-1, ~x) => integrate((sqrt(~a + ~b*((~x)^2))^-1)*sqrt(~x), ~x)

@rule -2(((-~b*((~a)^-1))^((-3//1)*(1//4)))*(sqrt(~a)^-1))*Subst(integrate((sqrt(1 - ((~x)^2))^-1)*sqrt(1 - 2((~x)^2)), ~x), ~x, 0.7071067811865475sqrt(1 - ~x*sqrt(-~b*((~a)^-1)))) => integrate((sqrt(~a + ~b*((~x)^2))^-1)*sqrt(~x), ~x)

@rule (sqrt(~a + ~b*((~x)^2))^-1)*sqrt(1 + ~b*((~a)^-1)*((~x)^2))*integrate((sqrt(1 + ~b*((~a)^-1)*((~x)^2))^-1)*sqrt(~x), ~x) => integrate((sqrt(~a + ~b*((~x)^2))^-1)*sqrt(~c*~x), ~x)

@rule (sqrt(~x)^-1)*sqrt(~c*~x)*integrate((sqrt(~a + ~b*((~x)^2))^-1)*sqrt(~x), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^(~n - 1))*((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((1 + ~m + ~n*~p)^-1))*((~c*~x)^(1 + ~m - ~n)) - ~a*(1 + ~m - ~n)*((~c)^~n)*(((~b)^-1)*((1 + ~m + ~n*~p)^-1))*integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^(~m - ~n)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^(~n - 1))*((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((1 + ~m + ~n*~p)^-1))*((~c*~x)^(1 + ~m - ~n)) - ~a*(1 + ~m - ~n)*((~c)^~n)*(((~b)^-1)*((1 + ~m + ~n*~p)^-1))*integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^(~m - ~n)), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^(2~n - 1))*((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m - 2~n))*((~b1^-1)*(~b2^-1)*((1 + ~m + 2~n*~p)^-1)) - ~a1*~a2*(1 + ~m - 2~n)*((~c)^(2~n))*((~b1^-1)*(~b2^-1)*((1 + ~m + 2~n*~p)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^(~m - 2~n)), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^(2~n - 1))*((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m - 2~n))*((~b1^-1)*(~b2^-1)*((1 + ~m + 2~n*~p)^-1)) - ~a1*~a2*(1 + ~m - 2~n)*((~c)^(2~n))*((~b1^-1)*(~b2^-1)*((1 + ~m + 2~n*~p)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^(~m - 2~n)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*(((~a)^-1)*((~c)^-1)*((1 + ~m)^-1)) - ~b*(1 + ~m + ~n*(1 + ~p))*(((~a)^-1)*((~c)^(-~n))*((1 + ~m)^-1))*integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^(~m + ~n)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*(((~a)^-1)*((~c)^-1)*((1 + ~m)^-1)) - ~b*(1 + ~m + ~n*(1 + ~p))*(((~a)^-1)*((~c)^(-~n))*((1 + ~m)^-1))*integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^(~m + ~n)), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*((~a1^-1)*(~a2^-1)*((~c)^-1)*((1 + ~m)^-1)) - ~b1*~b2*(1 + ~m + 2~n*(1 + ~p))*((~a1^-1)*(~a2^-1)*((~c)^(-2~n))*((1 + ~m)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^(~m + 2~n)), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*((~a1^-1)*(~a2^-1)*((~c)^-1)*((1 + ~m)^-1)) - ~b1*~b2*(1 + ~m + 2~n*(1 + ~p))*((~a1^-1)*(~a2^-1)*((~c)^(-2~n))*((1 + ~m)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^(~m + 2~n)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule With(List(Set(~k, Denominator(~m))), ~k*((~c)^-1)*Subst(integrate(((~x)^(~k*(1 + ~m) - 1))*((~a + ~b*((~c)^(-~n))*((~x)^(~k*~n)))^~p), ~x), ~x, (~c*~x)^((~k)^-1))) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule With(List(Set(~k, Denominator(~m))), ~k*((~c)^-1)*Subst(integrate(((~x)^(~k*(1 + ~m) - 1))*((~a1 + ~b1*((~c)^(-~n))*((~x)^(~k*~n)))^~p)*((~a2 + ~b2*((~c)^(-~n))*((~x)^(~k*~n)))^~p), ~x), ~x, (~c*~x)^((~k)^-1))) => integrate(~x*((~a + ~b*((~x)^3))^((-2//1)*(1//3))), ~x)

@rule With(List(Set(~q, Rt(~b, 3))), -((1//2)*((~q)^-2))*Log(~q*~x - ((~a + ~b*((~x)^3))^(3^-1))) - (0.5773502691896258((~q)^-2))*ArcTan(0.5773502691896258(1 + 2~q*~x*((~a + ~b*((~x)^3))^(-(1//3)))))) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~a)^(~p + (1 + ~m)*((~n)^-1)))*Subst(integrate(((~x)^~m)*((1 - ~b*((~x)^~n))^(-1 - ~p - (1 + ~m)*((~n)^-1))), ~x), ~x, ~x*((~a + ~b*((~x)^~n))^(-((~n)^-1)))) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((~a1*~a2)^(~p + (1 + ~m)*((1//2)*((~n)^-1))))*Subst(integrate(((~x)^~m)*(((1 - ~b1*((~x)^~n))^(-1 - ~p - (1 + ~m)*((1//2)*((~n)^-1))))*((1 - ~b2*((~x)^~n))^(-1 - ~p - (1 + ~m)*((1//2)*((~n)^-1))))), ~x), ~x, ~x*(((~a1 + ~b1*((~x)^~n))^(-((1//2)*((~n)^-1))))*((~a2 + ~b2*((~x)^~n))^(-((1//2)*((~n)^-1)))))) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~a + ~b*((~x)^~n))^(~p + (1 + ~m)*((~n)^-1)))*((~a*((~a + ~b*((~x)^~n))^-1))^(~p + (1 + ~m)*((~n)^-1)))*Subst(integrate(((~x)^~m)*((1 - ~b*((~x)^~n))^(-1 - ~p - (1 + ~m)*((~n)^-1))), ~x), ~x, ~x*((~a + ~b*((~x)^~n))^(-((~n)^-1)))) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^(~p + (1 + ~m)*((1//2)*((~n)^-1))))*((~a2 + ~b2*((~x)^~n))^(~p + (1 + ~m)*((1//2)*((~n)^-1))))*((~a1*((~a1 + ~b1*((~x)^~n))^-1))^(~p + (1 + ~m)*((1//2)*((~n)^-1))))*((~a2*((~a2 + ~b2*((~x)^~n))^-1))^(~p + (1 + ~m)*((1//2)*((~n)^-1))))*Subst(integrate(((~x)^~m)*(((1 - ~b1*((~x)^~n))^(-1 - ~p - (1 + ~m)*((1//2)*((~n)^-1))))*((1 - ~b2*((~x)^~n))^(-1 - ~p - (1 + ~m)*((1//2)*((~n)^-1))))), ~x), ~x, ~x*(((~a1 + ~b1*((~x)^~n))^(-((1//2)*((~n)^-1))))*((~a2 + ~b2*((~x)^~n))^(-((1//2)*((~n)^-1)))))) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule -Subst(integrate(((~x)^(-2 - ~m))*((~a + ~b*((~x)^(-~n)))^~p), ~x), ~x, (~x)^-1) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule -Subst(integrate(((~x)^(-2 - ~m))*((~a1 + ~b1*((~x)^(-~n)))^~p)*((~a2 + ~b2*((~x)^(-~n)))^~p), ~x), ~x, (~x)^-1) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule With(List(Set(~k, Denominator(~m))), -~k*((~c)^-1)*Subst(integrate(((~x)^(-1 - ~k*(1 + ~m)))*((~a + ~b*((~c)^(-~n))*((~x)^(-~k*~n)))^~p), ~x), ~x, (~c*~x)^(-((~k)^-1)))) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule With(List(Set(~k, Denominator(~m))), -~k*((~c)^-1)*Subst(integrate(((~x)^(-1 - ~k*(1 + ~m)))*((~a1 + ~b1*((~c)^(-~n))*((~x)^(-~k*~n)))^~p)*((~a2 + ~b2*((~c)^(-~n))*((~x)^(-~k*~n)))^~p), ~x), ~x, (~c*~x)^(-((~k)^-1)))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule -((~c)^-1)*((~x)^(-1 - ~m))*((~c*~x)^(1 + ~m))*Subst(integrate(((~x)^(-2 - ~m))*((~a + ~b*((~x)^(-~n)))^~p), ~x), ~x, (~x)^-1) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule -((~c)^-1)*((~x)^(-1 - ~m))*((~c*~x)^(1 + ~m))*Subst(integrate(((~x)^(-2 - ~m))*((~a1 + ~b1*((~x)^(-~n)))^~p)*((~a2 + ~b2*((~x)^(-~n)))^~p), ~x), ~x, (~x)^-1) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule With(List(Set(~k, Denominator(~n))), ~k*Subst(integrate(((~x)^(~k*(1 + ~m) - 1))*((~a + ~b*((~x)^(~k*~n)))^~p), ~x), ~x, (~x)^((~k)^-1))) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule With(List(Set(~k, Denominator(2~n))), ~k*Subst(integrate(((~x)^(~k*(1 + ~m) - 1))*((~a1 + ~b1*((~x)^(~k*~n)))^~p)*((~a2 + ~b2*((~x)^(~k*~n)))^~p), ~x), ~x, (~x)^((~k)^-1))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((1 + ~m)^-1)*Subst(integrate((~a + ~b*((~x)^Simplify(~n*((1 + ~m)^-1))))^~p, ~x), ~x, (~x)^(1 + ~m)) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((1 + ~m)^-1)*Subst(integrate(((~a1 + ~b1*((~x)^Simplify(~n*((1 + ~m)^-1))))^~p)*((~a2 + ~b2*((~x)^Simplify(~n*((1 + ~m)^-1))))^~p), ~x), ~x, (~x)^(1 + ~m)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~x)^(1 + ~m))*((1 + ~m)^-1)*((~a + ~b*((~x)^~n))^~p) - ~b*~n*~p*((1 + ~m)^-1)*integrate(((~x)^(~m + ~n))*((~a + ~b*((~x)^~n))^(~p - 1)), ~x) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((~x)^(1 + ~m))*((1 + ~m)^-1)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p) - 2~b1*~b2*~n*~p*((1 + ~m)^-1)*integrate(((~x)^(~m + 2~n))*((~a1 + ~b1*((~x)^~n))^(~p - 1))*((~a2 + ~b2*((~x)^~n))^(~p - 1)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a + ~b*((~x)^~n))^~p)*(((~c)^-1)*((1 + ~m + ~n*~p)^-1))*((~c*~x)^(1 + ~m)) + ~a*~n*~p*((1 + ~m + ~n*~p)^-1)*integrate(((~a + ~b*((~x)^~n))^(~p - 1))*((~c*~x)^~m), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*(((~c)^-1)*((1 + ~m + 2~n*~p)^-1))*((~c*~x)^(1 + ~m)) + 2~a1*~a2*~n*~p*((1 + ~m + 2~n*~p)^-1)*integrate(((~a1 + ~b1*((~x)^~n))^(~p - 1))*((~a2 + ~b2*((~x)^~n))^(~p - 1))*((~c*~x)^~m), ~x) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule With(List(Set(~k, Denominator(~p))), ~k*((~a)^(~p + Simplify((1 + ~m)*((~n)^-1))))*((~n)^-1)*Subst(integrate(((~x)^(~k*Simplify((1 + ~m)*((~n)^-1)) - 1))*((1 - ~b*((~x)^~k))^(-1 - ~p - Simplify((1 + ~m)*((~n)^-1)))), ~x), ~x, ((~x)^(~n*((~k)^-1)))*((~a + ~b*((~x)^~n))^(-((~k)^-1))))) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule With(List(Set(~k, Denominator(~p))), ~k*((~a1*~a2)^(~p + Simplify((1 + ~m)*((1//2)*((~n)^-1)))))*((1//2)*((~n)^-1))*Subst(integrate(((~x)^(~k*Simplify((1 + ~m)*((1//2)*((~n)^-1))) - 1))*((1 - ~b1*~b2*((~x)^~k))^(-1 - ~p - Simplify((1 + ~m)*((1//2)*((~n)^-1))))), ~x), ~x, ((~x)^(2~n*((~k)^-1)))*(((~a1 + ~b1*((~x)^~n))^(-((~k)^-1)))*((~a2 + ~b2*((~x)^~n))^(-((~k)^-1)))))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule (1 + ~m + ~n*(1 + ~p))*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^~m), ~x) - ((~a + ~b*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*(((~a)^-1)*((~c)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule (1 + ~m + 2~n*(1 + ~p))*((1//2)*(~a1^-1)*(~a2^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^~m), ~x) - ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((~c*~x)^(1 + ~m))*((1//2)*(~a1^-1)*(~a2^-1)*((~c)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule With(List(Set(~mn, Simplify(~m - ~n))), ((~x)^(1 + ~mn))*(((~b)^-1)*((1 + ~mn)^-1)) - ~a*((~b)^-1)*integrate(((~x)^~mn)*((~a + ~b*((~x)^~n))^-1), ~x)) => integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x)

@rule ((~x)^(1 + ~m))*(((~a)^-1)*((1 + ~m)^-1)) - ~b*((~a)^-1)*integrate(((~x)^Simplify(~m + ~n))*((~a + ~b*((~x)^~n))^-1), ~x) => integrate(((~a + ~b*((~x)^~n))^-1)*((~c*~x)^~m), ~x)

@rule ((~c)^IntPart(~m))*((~x)^(-FracPart(~m)))*((~c*~x)^FracPart(~m))*integrate(((~x)^~m)*((~a + ~b*((~x)^~n))^-1), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a)^~p)*(((~c)^-1)*((1 + ~m)^-1))*((~c*~x)^(1 + ~m))*Hypergeometric2F1(-~p, (1 + ~m)*((~n)^-1), 1 + (1 + ~m)*((~n)^-1), -~b*((~a)^-1)*((~x)^~n)) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a)^IntPart(~p))*((1 + ~b*((~a)^-1)*((~x)^~n))^(-FracPart(~p)))*((~a + ~b*((~x)^~n))^FracPart(~p))*integrate(((1 + ~b*((~a)^-1)*((~x)^~n))^~p)*((~c*~x)^~m), ~x) => integrate(((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p)*((~c*~x)^~m), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^FracPart(~p))*((~a2 + ~b2*((~x)^~n))^FracPart(~p))*((~a1*~a2 + ~b1*~b2*((~x)^(2~n)))^(-FracPart(~p)))*integrate(((~a1*~a2 + ~b1*~b2*((~x)^(2~n)))^~p)*((~c*~x)^~m), ~x) => integrate(((~a + ~b*((~c*~x)^~n))^~p)*((~d*~x)^~m), ~x)

@rule ((~c)^-1)*Subst(integrate(((~a + ~b*((~x)^~n))^~p)*((~d*~x*((~c)^-1))^~m), ~x), ~x, ~c*~x) => integrate(((~a + ~b*((~c*((~x)^~q))^~n))^~p)*((~d*~x)^~m), ~x)

@rule (((~d)^-1)*((~c*((~x)^~q))^(-(1 + ~m)*((~q)^-1))))*((~d*~x)^(1 + ~m))*Subst(integrate(((~x)^~m)*((~a + ~b*((~x)^(~n*~q)))^~p), ~x), ~x, (~c*((~x)^~q))^((~q)^-1)) => integrate(((~a + ~b*((~c*((~x)^~q))^~n))^~p)*((~d*~x)^~m), ~x)

@rule With(List(Set(~k, Denominator(~n))), Subst(integrate(((~a + ~b*((~c)^~n)*((~x)^(~n*~q)))^~p)*((~d*~x)^~m), ~x), (~x)^((~k)^-1), ((~c*((~x)^~q))^((~k)^-1))*(((~c)^(-((~k)^-1)))*((~x)^(-((~k)^-1)*(~q - 1)))))) => integrate(((~a + ~b*((~c*((~x)^~q))^~n))^~p)*((~d*~x)^~m), ~x)

@rule Subst(integrate(((~a + ~b*((~c)^~n)*((~x)^(~n*~q)))^~p)*((~d*~x)^~m), ~x), (~x)^(~n*~q), ((~c)^(-~n))*((~c*((~x)^~q))^~n)) => integrate(((~x)^~m)*((~a + ~b*((~v)^~n))^~p), ~x)

@rule With(List(Set(~c, Coefficient(~v, ~x, 0)), Set(~d, Coefficient(~v, ~x, 1))), Condition(((~d)^(-1 - ~m))*Subst(integrate(SimplifyIntegrand(((~x - ~c)^~m)*((~a + ~b*((~x)^~n))^~p), ~x), ~x), ~x, ~v), NeQ(~c, 0))) => integrate(((~u)^~m)*((~a + ~b*((~v)^~n))^~p), ~x)


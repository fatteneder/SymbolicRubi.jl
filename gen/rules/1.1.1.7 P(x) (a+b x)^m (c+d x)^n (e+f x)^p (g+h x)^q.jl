@rule With(List(Set(~q, Expon(~Px, ~x)), Set(~k, Coeff(~Px, ~x, Expon(~Px, ~x)))), Condition((((~b)^(-~q))*((~d)^-1)*((~f)^-1)*((1 + ~m + ~n + ~p + ~q)^-1))*integrate(((~a + ~b*~x)^~m)*((~c + ~d*~x)^~n)*((~e + ~f*~x)^~p)*ExpandToSum(~k*(~b*~x*(~a*~d*~f*(~n + ~p + 2~m + 2~q) - ~b*(~d*~e*(~m + ~n + ~q) + ~c*~f*(~m + ~p + ~q))) + ~d*~f*(1 + ~m + ~n + ~p + ~q)*((~a)^2) - ~b*(~a*(~d*~e*(1 + ~n) + ~c*~f*(1 + ~p)) + ~b*~c*~e*(~m + ~q - 1)))*((~a + ~b*~x)^(~q - 2)) + ~Px*~d*~f*(1 + ~m + ~n + ~p + ~q)*((~b)^~q) - ~d*~f*~k*(1 + ~m + ~n + ~p + ~q)*((~a + ~b*~x)^~q), ~x), ~x) + ~k*((~a + ~b*~x)^(~m + ~q - 1))*((~c + ~d*~x)^(1 + ~n))*((~e + ~f*~x)^(1 + ~p))*(((~b)^(1 - ~q))*((~d)^-1)*((~f)^-1)*((1 + ~m + ~n + ~p + ~q)^-1)), NeQ(1 + ~m + ~n + ~p + ~q, 0))) => integrate(~Px*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((~n)^-1)*((1 + ~p)^-1))*Coeff(~Px, ~x, ~n - 1) + integrate((~Px - ((~x)^(~n - 1))*Coeff(~Px, ~x, ~n - 1))*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(~Px*((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x)

@rule ((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((~n)^-1)*((1 + ~p)^-1))*Coeff(~Px, ~x, ~n - 1 - ~m) + integrate((~Px - ((~x)^(~n - 1 - ~m))*Coeff(~Px, ~x, ~n - 1 - ~m))*((~x)^~m)*((~a + ~b*((~x)^~n))^~p), ~x) => integrate(~u*((~x)^~m)*((~a*((~x)^~p) + ~b*((~x)^~q))^~n), ~x)

@rule integrate(~u*((~x)^(~m + ~n*~p))*((~a + ~b*((~x)^(~q - ~p)))^~n), ~x) => integrate(~u*((~x)^~m)*((~a*((~x)^~p) + ~b*((~x)^~q) + ~c*((~x)^~r))^~n), ~x)

@rule integrate(~u*((~x)^(~m + ~n*~p))*((~a + ~b*((~x)^(~q - ~p)) + ~c*((~x)^(~r - ~p)))^~n), ~x) => integrate(~u*(~Px^~p)*(~Qx^~q), ~x)

@rule integrate(~u*(~Qx^(~p + ~q))*(PolynomialQuotient(~Px, ~Qx, ~x)^~p), ~x) => integrate(~Pp*(~Qq^-1), ~x)

@rule With(List(Set(~p, Expon(~Pp, ~x)), Set(~q, Expon(~Qq, ~x))), Condition((((~q)^-1)*(Coeff(~Qq, ~x, ~q)^-1))*Coeff(~Pp, ~x, ~p)*Log(RemoveContent(~Qq, ~x)), And(EqQ(~p, ~q - 1), EqQ(~Pp, Simplify((((~q)^-1)*(Coeff(~Qq, ~x, ~q)^-1))*Coeff(~Pp, ~x, ~p)*D(~Qq, ~x)))))) => integrate(~Pp*(~Qq^~m), ~x)

@rule With(List(Set(~p, Expon(~Pp, ~x)), Set(~q, Expon(~Qq, ~x))), Condition((~Qq^(1 + ~m))*((~x)^(1 + ~p - ~q))*(((1 + ~p + ~m*~q)^-1)*(Coeff(~Qq, ~x, ~q)^-1))*Coeff(~Pp, ~x, ~p), And(NeQ(1 + ~p + ~m*~q, 0), EqQ(~Pp*(1 + ~p + ~m*~q)*Coeff(~Qq, ~x, ~q), ((~x)^(~p - ~q))*(~Qq*(1 + ~p - ~q) + ~x*(1 + ~m)*D(~Qq, ~x))*Coeff(~Pp, ~x, ~p))))) => integrate(((~x)^~m)*((~a1 + ~b1*((~x)^~n))^~p)*((~a2 + ~b2*((~x)^~n))^~p), ~x)

@rule ((~a1 + ~b1*((~x)^~n))^(1 + ~p))*((~a2 + ~b2*((~x)^~n))^(1 + ~p))*((1//2)*(~b1^-1)*(~b2^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate(~Pp*(~Qq^~m)*(~Rr^~n), ~x)

@rule With(List(Set(~p, Expon(~Pp, ~x)), Set(~q, Expon(~Qq, ~x)), Set(~r, Expon(~Rr, ~x))), Condition((~Qq^(1 + ~m))*(~Rr^(1 + ~n))*((~x)^(1 + ~p - ~q - ~r))*(((1 + ~p + ~m*~q + ~n*~r)^-1)*(Coeff(~Qq, ~x, ~q)^-1)*(Coeff(~Rr, ~x, ~r)^-1))*Coeff(~Pp, ~x, ~p), And(NeQ(1 + ~p + ~m*~q + ~n*~r, 0), EqQ(~Pp*(1 + ~p + ~m*~q + ~n*~r)*Coeff(~Qq, ~x, ~q)*Coeff(~Rr, ~x, ~r), (~Qq*~Rr*(1 + ~p - ~q - ~r) + ~Rr*~x*(1 + ~m)*D(~Qq, ~x) + ~Qq*~x*(1 + ~n)*D(~Rr, ~x))*((~x)^(~p - ~q - ~r))*Coeff(~Pp, ~x, ~p))))) => integrate(~Qr*((~a + ~b*(~Pq^~n))^~p), ~x)

@rule With(List(Set(~q, Expon(~Pq, ~x)), Set(~r, Expon(~Qr, ~x))), Condition((((~q)^-1)*(Coeff(~Pq, ~x, ~q)^-1))*Coeff(~Qr, ~x, ~r)*Subst(integrate((~a + ~b*((~x)^~n))^~p, ~x), ~x, ~Pq), And(EqQ(~r, ~q - 1), EqQ(Coeff(~Qr, ~x, ~r)*D(~Pq, ~x), ~Qr*~q*Coeff(~Pq, ~x, ~q))))) => integrate(~Qr*((~a + ~b*(~Pq^~n) + ~c*(~Pq^~n2))^~p), ~x)

@rule Module(List(Set(~q, Expon(~Pq, ~x)), Set(~r, Expon(~Qr, ~x))), Condition((((~q)^-1)*(Coeff(~Pq, ~x, ~q)^-1))*Coeff(~Qr, ~x, ~r)*Subst(integrate((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p, ~x), ~x, ~Pq), And(EqQ(~r, ~q - 1), EqQ(Coeff(~Qr, ~x, ~r)*D(~Pq, ~x), ~Qr*~q*Coeff(~Pq, ~x, ~q))))) => integrate(~u*((~a*((~x)^~p) + ~b*((~x)^~q))^~n), ~x)

@rule integrate(~u*((~x)^(~n*~p))*((~a + ~b*((~x)^(~q - ~p)))^~n), ~x) => integrate(~u*((~a*((~x)^~p) + ~b*((~x)^~q) + ~c*((~x)^~r))^~n), ~x)

@rule integrate(~u*((~x)^(~n*~p))*((~a + ~b*((~x)^(~q - ~p)) + ~c*((~x)^(~r - ~p)))^~n), ~x) => integrate((~A + ~B*~x)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~a + ~b*~x), ~x)

@rule ~B*(~b*~e - ~a*~f)*(~b*~g - ~a*~h)*((1//2)*((~d)^-1)*((~f)^-1)*((~h)^-1))*integrate((((~a + ~b*~x)^((-3//1)*(1//2)))*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~c + ~d*~x), ~x) + ~B*~b*(((~d)^-1)*((~f)^-1)*((~h)^-1)*(sqrt(~a + ~b*~x)^-1))*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) - ~B*(~b*~g - ~a*~h)*((1//2)*((~f)^-1)*((~h)^-1))*integrate(((sqrt(~a + ~b*~x)^-1)*(sqrt(~c + ~d*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~e + ~f*~x), ~x) => integrate((~A + ~B*~x)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~a + ~b*~x), ~x)

@rule (~B*(~a*~d*~f*~h - ~b*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) + 2~A*~b*~d*~f*~h)*((1//2)*((~b)^-1)*((~d)^-1)*((~f)^-1)*((~h)^-1))*integrate(((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~a + ~b*~x), ~x) + ~B*(((~f)^-1)*((~h)^-1)*(sqrt(~c + ~d*~x)^-1))*sqrt(~a + ~b*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) + ~B*(~d*~e - ~c*~f)*(~d*~g - ~c*~h)*((1//2)*((~d)^-1)*((~f)^-1)*((~h)^-1))*integrate((((~c + ~d*~x)^((-3//1)*(1//2)))*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~a + ~b*~x), ~x) - ~B*(~b*~e - ~a*~f)*(~b*~g - ~a*~h)*((1//2)*((~b)^-1)*((~f)^-1)*((~h)^-1))*integrate((sqrt(~a + ~b*~x)*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x))^-1, ~x) => integrate((~A + ~B*~x)*((~a + ~b*~x)^~m)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule (((~d)^-1)*((~f)^-1)*((~h)^-1)*((3 + 2~m)^-1))*integrate(((~a + ~b*~x)^(~m - 1))*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(~A*~a*~d*~f*~h*(3 + 2~m) + ~d*~f*~h*~x*(~A*~b + ~B*~a)*(3 + 2~m) + ~B*~b*~d*~f*~h*((~x)^2)*(3 + 2~m), ~x), ~x) => integrate((~A + ~B*~x)*((sqrt(~a + ~b*~x)^-1)*(sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule ~B*((~b)^-1)*integrate(((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~a + ~b*~x), ~x) + ((~b)^-1)*(~A*~b - ~B*~a)*integrate((sqrt(~a + ~b*~x)*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x))^-1, ~x) => integrate((~A + ~B*~x)*((~a + ~b*~x)^~m)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule ((~a + ~b*~x)^(1 + ~m))*(~A*((~b)^2) - ~B*~a*~b)*(((1 + ~m)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1)*((~b*~g - ~a*~h)^-1))*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) - (((2 + 2~m)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1)*((~b*~g - ~a*~h)^-1))*integrate(((~a + ~b*~x)^(1 + ~m))*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(~A*(((~b)^2)*(3 + 2~m)*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~d*~f*~h*((~a)^2)*(1 + ~m) - 2~a*~b*(1 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) + ~d*~f*~h*((~x)^2)*(5 + 2~m)*(~A*((~b)^2) - ~B*~a*~b) - ~B*~b*(~a*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~b*~c*~e*~g*(1 + ~m)) - 2~x*(~A*~b - ~B*~a)*(~a*~d*~f*~h*(1 + ~m) - ~b*(2 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)), ~x), ~x) => integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x)^~m)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule (((~d)^-1)*((~f)^-1)*((~h)^-1)*((3 + 2~m)^-1))*integrate(((~a + ~b*~x)^(~m - 1))*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(~x*(~d*~f*~h*(~A*~b + ~B*~a)*(3 + 2~m) - ~C*(~b*(1 + 2~m)*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~a*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h))) + ((~x)^2)*(2~C*(~a*~d*~f*~h*~m - ~b*(1 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) + ~B*~b*~d*~f*~h*(3 + 2~m)) + ~A*~a*~d*~f*~h*(3 + 2~m) - ~C*(~a*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~b*~c*~e*~g*~m), ~x), ~x) + 2~C*((~a + ~b*~x)^~m)*(((~d)^-1)*((~f)^-1)*((~h)^-1)*((3 + 2~m)^-1))*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) => integrate((~A + ~C*((~x)^2))*((~a + ~b*~x)^~m)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule (((~d)^-1)*((~f)^-1)*((~h)^-1)*((3 + 2~m)^-1))*integrate(((~a + ~b*~x)^(~m - 1))*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(~x*(~A*~b*~d*~f*~h*(3 + 2~m) - ~C*(~b*(1 + 2~m)*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~a*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h))) + 2~C*((~x)^2)*(~a*~d*~f*~h*~m - ~b*(1 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) + ~A*~a*~d*~f*~h*(3 + 2~m) - ~C*(~a*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~b*~c*~e*~g*~m), ~x), ~x) + 2~C*((~a + ~b*~x)^~m)*(((~d)^-1)*((~f)^-1)*((~h)^-1)*((3 + 2~m)^-1))*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) => integrate((~A + ~B*~x + ~C*((~x)^2))*((sqrt(~a + ~b*~x)^-1)*(sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule ((1//2)*((~b)^-1)*((~d)^-1)*((~f)^-1)*((~h)^-1))*integrate(((sqrt(~a + ~b*~x)^-1)*(sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(~x*(2~B*~b*~d*~f*~h - ~C*(~b*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h) + ~a*~d*~f*~h)) + 2~A*~b*~d*~f*~h - ~C*(~a*~c*~f*~h + ~b*~d*~e*~g), ~x), ~x) + ~C*(((~b)^-1)*((~f)^-1)*((~h)^-1)*(sqrt(~c + ~d*~x)^-1))*sqrt(~a + ~b*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) + ~C*(~d*~e - ~c*~f)*(~d*~g - ~c*~h)*((1//2)*((~b)^-1)*((~d)^-1)*((~f)^-1)*((~h)^-1))*integrate((((~c + ~d*~x)^((-3//1)*(1//2)))*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~a + ~b*~x), ~x) => integrate((~A + ~C*((~x)^2))*((sqrt(~a + ~b*~x)^-1)*(sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule ((1//2)*((~b)^-1)*((~d)^-1)*((~f)^-1)*((~h)^-1))*integrate(((sqrt(~a + ~b*~x)^-1)*(sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(2~A*~b*~d*~f*~h - ~C*(~a*~c*~f*~h + ~b*~d*~e*~g) - ~C*~x*(~b*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h) + ~a*~d*~f*~h), ~x), ~x) + ~C*(((~b)^-1)*((~f)^-1)*((~h)^-1)*(sqrt(~c + ~d*~x)^-1))*sqrt(~a + ~b*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) + ~C*(~d*~e - ~c*~f)*(~d*~g - ~c*~h)*((1//2)*((~b)^-1)*((~d)^-1)*((~f)^-1)*((~h)^-1))*integrate((((~c + ~d*~x)^((-3//1)*(1//2)))*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*sqrt(~a + ~b*~x), ~x) => integrate((~A + ~B*~x + ~C*((~x)^2))*((~a + ~b*~x)^~m)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule (~A*((~b)^2) + ~C*((~a)^2) - ~B*~a*~b)*((~a + ~b*~x)^(1 + ~m))*(((1 + ~m)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1)*((~b*~g - ~a*~h)^-1))*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) - (((2 + 2~m)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1)*((~b*~g - ~a*~h)^-1))*integrate(((~a + ~b*~x)^(1 + ~m))*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(~A*(((~b)^2)*(3 + 2~m)*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~d*~f*~h*((~a)^2)*(1 + ~m) - 2~a*~b*(1 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) + ~d*~f*~h*(~A*((~b)^2) + ~C*((~a)^2) - ~B*~a*~b)*((~x)^2)*(5 + 2~m) - (~B*~b - ~C*~a)*(~a*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~b*~c*~e*~g*(1 + ~m)) - ~x*(2(~A*~b - ~B*~a)*(~a*~d*~f*~h*(1 + ~m) - ~b*(2 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) - 2~C*((~c*~f*~h + ~d*~f*~g + ~d*~e*~h)*((~a)^2) + ~a*~b*(1 + ~m)*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) - ~c*~e*~g*((~b)^2)*(1 + ~m))), ~x), ~x) => integrate((~A + ~C*((~x)^2))*((~a + ~b*~x)^~m)*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1)), ~x)

@rule ((~a + ~b*~x)^(1 + ~m))*(~A*((~b)^2) + ~C*((~a)^2))*(((1 + ~m)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1)*((~b*~g - ~a*~h)^-1))*sqrt(~c + ~d*~x)*sqrt(~e + ~f*~x)*sqrt(~g + ~h*~x) - (((2 + 2~m)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1)*((~b*~g - ~a*~h)^-1))*integrate(((~a + ~b*~x)^(1 + ~m))*((sqrt(~c + ~d*~x)^-1)*(sqrt(~e + ~f*~x)^-1)*(sqrt(~g + ~h*~x)^-1))*Simp(~A*(((~b)^2)*(3 + 2~m)*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~d*~f*~h*((~a)^2)*(1 + ~m) - 2~a*~b*(1 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) + ~C*~a*(~a*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) + 2~b*~c*~e*~g*(1 + ~m)) + ~d*~f*~h*((~x)^2)*(5 + 2~m)*(~A*((~b)^2) + ~C*((~a)^2)) - ~x*(2~A*~b*(~a*~d*~f*~h*(1 + ~m) - ~b*(2 + ~m)*(~c*~f*~h + ~d*~f*~g + ~d*~e*~h)) - 2~C*((~c*~f*~h + ~d*~f*~g + ~d*~e*~h)*((~a)^2) + ~a*~b*(1 + ~m)*(~c*~f*~g + ~c*~e*~h + ~d*~e*~g) - ~c*~e*~g*((~b)^2)*(1 + ~m))), ~x), ~x) => integrate(~Px*((~a + ~b*~x)^~m)*((~c + ~d*~x)^~n)*((~e + ~f*~x)^~p)*((~g + ~h*~x)^~q), ~x)

@rule integrate(ExpandIntegrand(~Px*((~a + ~b*~x)^~m)*((~c + ~d*~x)^~n)*((~e + ~f*~x)^~p)*((~g + ~h*~x)^~q), ~x), ~x) => integrate(~Px*((~a + ~b*~x)^~m)*((~c + ~d*~x)^~n)*((~e + ~f*~x)^~p)*((~g + ~h*~x)^~q), ~x)

@rule PolynomialRemainder(~Px, ~a + ~b*~x, ~x)*integrate(((~a + ~b*~x)^~m)*((~c + ~d*~x)^~n)*((~e + ~f*~x)^~p)*((~g + ~h*~x)^~q), ~x) + integrate(((~a + ~b*~x)^(1 + ~m))*((~c + ~d*~x)^~n)*((~e + ~f*~x)^~p)*((~g + ~h*~x)^~q)*PolynomialQuotient(~Px, ~a + ~b*~x, ~x), ~x) => integrate(~Px*((~a + ~b*~x)^~m)*((~c + ~d*~x)^~n)*((~e + ~f*~x)^~p)*((~g + ~h*~x)^~q), ~x)


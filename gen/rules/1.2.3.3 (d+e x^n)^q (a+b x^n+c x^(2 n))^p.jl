@rule ((~u)^~m)*(((~v)^(-~m))*(Coefficient(~v, ~x, 1)^-1))*Subst(integrate(((~x)^~m)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x), ~x, ~v) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~d + ~e*((~x)^~n))^(-2~p))*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p)*integrate((~d + ~e*((~x)^~n))^(~q + 2~p), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^FracPart(~p))*(((~c)^(-IntPart(~p)))*(((1//2)*~b + ~c*((~x)^~n))^(-2FracPart(~p))))*integrate((((1//2)*~b + ~c*((~x)^~n))^(2~p))*((~d + ~e*((~x)^~n))^~q), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(((~x)^(~n*(~q + 2~p)))*((~e + ~d*((~x)^(-~n)))^~q)*((~c + ~b*((~x)^(-~n)) + ~a*((~x)^(-2~n)))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule integrate(((~x)^(~n*(~q + 2~p)))*((~e + ~d*((~x)^(-~n)))^~q)*((~c + ~a*((~x)^(-2~n)))^~p), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule -Subst(integrate(((~x)^-2)*((~d + ~e*((~x)^(-~n)))^~q)*((~a + ~b*((~x)^(-~n)) + ~c*((~x)^(-2~n)))^~p), ~x), ~x, (~x)^-1) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule -Subst(integrate(((~x)^-2)*((~d + ~e*((~x)^(-~n)))^~q)*((~a + ~c*((~x)^(-2~n)))^~p), ~x), ~x, (~x)^-1) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule With(List(Set(~g, Denominator(~n))), ~g*Subst(integrate(((~x)^(~g - 1))*((~d + ~e*((~x)^(~g*~n)))^~q)*((~a + ~b*((~x)^(~g*~n)) + ~c*((~x)^(2~g*~n)))^~p), ~x), ~x, (~x)^((~g)^-1))) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule With(List(Set(~g, Denominator(~n))), ~g*Subst(integrate(((~x)^(~g - 1))*((~d + ~e*((~x)^(~g*~n)))^~q)*((~a + ~c*((~x)^(2~g*~n)))^~p), ~x), ~x, (~x)^((~g)^-1))) => integrate((~d + ~e*((~x)^~n))*((~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ~e*((~c)^-1)*integrate(((~x)^(-~n))*((~b*((~x)^~n) + ~c*((~x)^(2~n)))^(1 + ~p)), ~x) + ((~b*((~x)^~n) + ~c*((~x)^(2~n)))^(1 + ~p))*(~b*~e - ~c*~d)*(((~b)^-1)*((~c)^-1)*((~n)^-1)*((~x)^(-2~n*(1 + ~p)))*((1 + ~p)^-1)) => integrate((~d + ~e*((~x)^~n))*((~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ~e*((~x)^(1 - ~n))*(((~c)^-1)*((1 + ~n*(1 + 2~p))^-1))*((~b*((~x)^~n) + ~c*((~x)^(2~n)))^(1 + ~p)) => integrate((~d + ~e*((~x)^~n))*((~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ~e*((~x)^(1 - ~n))*(((~c)^-1)*((1 + ~n*(1 + 2~p))^-1))*((~b*((~x)^~n) + ~c*((~x)^(2~n)))^(1 + ~p)) - (~b*~e*(1 + ~n*~p) - ~c*~d*(1 + ~n*(1 + 2~p)))*(((~c)^-1)*((1 + ~n*(1 + 2~p))^-1))*integrate((~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p, ~x) => integrate(((~b*((~x)^~n) + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule (((~x)^(-~n*FracPart(~p)))*((~b + ~c*((~x)^~n))^(-FracPart(~p))))*((~b*((~x)^~n) + ~c*((~x)^(2~n)))^FracPart(~p))*integrate(((~x)^(~n*~p))*((~b + ~c*((~x)^~n))^~p)*((~d + ~e*((~x)^~n))^~q), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^FracPart(~p))*(((~d + ~e*((~x)^~n))^(-FracPart(~p)))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^(-FracPart(~p))))*integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule ((~a + ~c*((~x)^(2~n)))^FracPart(~p))*(((~d + ~e*((~x)^~n))^(-FracPart(~p)))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^(-FracPart(~p))))*integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))*((~d + ~e*((~x)^~n))^~q), ~x)

@rule integrate(ExpandIntegrand((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))*((~d + ~e*((~x)^~n))^~q), ~x), ~x) => integrate((~a + ~c*((~x)^~n2))*((~d + ~e*((~x)^~n))^~q), ~x)

@rule integrate(ExpandIntegrand((~a + ~c*((~x)^(2~n)))*((~d + ~e*((~x)^~n))^~q), ~x), ~x) => integrate((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))*((~d + ~e*((~x)^~n))^~q), ~x)

@rule (((~d)^-1)*((~e)^-2)*((~n)^-1)*((1 + ~q)^-1))*integrate(((~d + ~e*((~x)^~n))^(1 + ~q))*Simp(~c*((~d)^2) + ~a*((~e)^2)*(1 + ~n*(1 + ~q)) + ~c*~d*~e*~n*(1 + ~q)*((~x)^~n) - ~b*~d*~e, ~x), ~x) + ~x*(~b*~d*~e - ~a*((~e)^2) - ~c*((~d)^2))*((~d + ~e*((~x)^~n))^(1 + ~q))*(((~d)^-1)*((~e)^-2)*((~n)^-1)*((1 + ~q)^-1)) => integrate((~a + ~c*((~x)^~n2))*((~d + ~e*((~x)^~n))^~q), ~x)

@rule (((~d)^-1)*((~e)^-2)*((~n)^-1)*((1 + ~q)^-1))*integrate(((~d + ~e*((~x)^~n))^(1 + ~q))*Simp(~c*((~d)^2) + ~a*((~e)^2)*(1 + ~n*(1 + ~q)) + ~c*~d*~e*~n*(1 + ~q)*((~x)^~n), ~x), ~x) + ~x*((~d + ~e*((~x)^~n))^(1 + ~q))*(-~a*((~e)^2) - ~c*((~d)^2))*(((~d)^-1)*((~e)^-2)*((~n)^-1)*((1 + ~q)^-1)) => integrate((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))*((~d + ~e*((~x)^~n))^~q), ~x)

@rule (((~e)^-1)*((1 + ~n*(2 + ~q))^-1))*integrate(((~d + ~e*((~x)^~n))^~q)*(~a*~e*(1 + ~n*(2 + ~q)) - ((~x)^~n)*(~c*~d*(1 + ~n) - ~b*~e*(1 + ~n*(2 + ~q)))), ~x) + ~c*((~x)^(1 + ~n))*((~d + ~e*((~x)^~n))^(1 + ~q))*(((~e)^-1)*((1 + ~n*(2 + ~q))^-1)) => integrate((~a + ~c*((~x)^~n2))*((~d + ~e*((~x)^~n))^~q), ~x)

@rule (((~e)^-1)*((1 + ~n*(2 + ~q))^-1))*integrate(((~d + ~e*((~x)^~n))^~q)*(~a*~e*(1 + ~n*(2 + ~q)) - ~c*~d*(1 + ~n)*((~x)^~n)), ~x) + ~c*((~x)^(1 + ~n))*((~d + ~e*((~x)^~n))^(1 + ~q))*(((~e)^-1)*((1 + ~n*(2 + ~q))^-1)) => integrate((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt(2~d*~e, 2))), ((~e)^2)*((1//2)*((~c)^-1))*integrate((~d + ~e*((~x)^~n) + ~q*((~x)^((1//2)*~n)))^-1, ~x) + ((~e)^2)*((1//2)*((~c)^-1))*integrate((~d + ~e*((~x)^~n) - ~q*((~x)^((1//2)*~n)))^-1, ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt(-2~d*~e, 2))), ~d*((1//2)*((~a)^-1))*integrate((~d + ~q*((~x)^((1//2)*~n)))*((~d + ~q*((~x)^((1//2)*~n)) - ~e*((~x)^~n))^-1), ~x) + ~d*((1//2)*((~a)^-1))*integrate((~d - ~q*((~x)^((1//2)*~n)))*((~d - ~e*((~x)^~n) - ~q*((~x)^((1//2)*~n)))^-1), ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt(~a*((~c)^-1), 4))), (0.35355339059327373((~c)^-1)*((~q)^-3))*integrate((((~q)^2 + (~x)^~n + 1.4142135623730951~q*((~x)^((1//2)*~n)))^-1)*((~d - ~e*((~q)^2))*((~x)^((1//2)*~n)) + 1.4142135623730951~d*~q), ~x) + (0.35355339059327373((~c)^-1)*((~q)^-3))*integrate((((~q)^2 + (~x)^~n - 1.4142135623730951~q*((~x)^((1//2)*~n)))^-1)*(1.4142135623730951~d*~q - (~d - ~e*((~q)^2))*((~x)^((1//2)*~n))), ~x)) => integrate((~d + ~e*((~x)^3))*((~a + ~c*((~x)^6))^-1), ~x)

@rule With(List(Set(~q, Rt(~c*((~a)^-1), 6))), ((1//3)*((~a)^-1)*((~q)^-2))*integrate(((1 + ((~q)^2)*((~x)^2))^-1)*(~d*((~q)^2) - ~e*~x), ~x) + ((1//6)*((~a)^-1)*((~q)^-2))*integrate(((1 + ((~q)^2)*((~x)^2) + 1.7320508075688772~q*~x)^-1)*(~x*(~e + 1.7320508075688772~d*((~q)^3)) + 2~d*((~q)^2)), ~x) + ((1//6)*((~a)^-1)*((~q)^-2))*integrate(((1 + ((~q)^2)*((~x)^2) - 1.7320508075688772~q*~x)^-1)*(2~d*((~q)^2) - ~x*(1.7320508075688772~d*((~q)^3) - ~e)), ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt(-~a*((~c)^-1), 2))), (1//2)*(~d + ~e*~q)*integrate((~a + ~c*~q*((~x)^~n))^-1, ~x) + (1//2)*(~d - ~e*~q)*integrate((~a - ~c*~q*((~x)^~n))^-1, ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule ~d*integrate((~a + ~c*((~x)^(2~n)))^-1, ~x) + ~e*integrate(((~x)^~n)*((~a + ~c*((~x)^(2~n)))^-1), ~x) => integrate((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt(2~d*((~e)^-1) - ~b*((~c)^-1), 2))), ~e*((1//2)*((~c)^-1))*integrate(Simp(~d*((~e)^-1) + ~q*((~x)^((1//2)*~n)) + (~x)^~n, ~x)^-1, ~x) + ~e*((1//2)*((~c)^-1))*integrate(Simp(~d*((~e)^-1) + (~x)^~n - ~q*((~x)^((1//2)*~n)), ~x)^-1, ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt((~b)^2 - 4~a*~c, 2))), ((1//2)*~e + (2~c*~d - ~b*~e)*((1//2)*((~q)^-1)))*integrate(((1//2)*~b + ~c*((~x)^~n) - (1//2)*~q)^-1, ~x) + ((1//2)*~e - (2~c*~d - ~b*~e)*((1//2)*((~q)^-1)))*integrate(((1//2)*~b + (1//2)*~q + ~c*((~x)^~n))^-1, ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt(-~b*((~c)^-1) - 2~d*((~e)^-1), 2))), ~e*((1//2)*((~c)^-1)*((~q)^-1))*integrate((~q - 2((~x)^((1//2)*~n)))*(Simp(~d*((~e)^-1) + ~q*((~x)^((1//2)*~n)) - ((~x)^~n), ~x)^-1), ~x) + ~e*((1//2)*((~c)^-1)*((~q)^-1))*integrate((~q + 2((~x)^((1//2)*~n)))*(Simp(~d*((~e)^-1) - ((~x)^~n) - ~q*((~x)^((1//2)*~n)), ~x)^-1), ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt((~b)^2 - 4~a*~c, 2))), ((1//2)*~e + (2~c*~d - ~b*~e)*((1//2)*((~q)^-1)))*integrate(((1//2)*~b + ~c*((~x)^~n) - (1//2)*~q)^-1, ~x) + ((1//2)*~e - (2~c*~d - ~b*~e)*((1//2)*((~q)^-1)))*integrate(((1//2)*~b + (1//2)*~q + ~c*((~x)^~n))^-1, ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~q, Rt(~a*((~c)^-1), 2))), With(List(Set(~r, Rt(2~q - ~b*((~c)^-1), 2))), ((1//2)*((~c)^-1)*((~q)^-1)*((~r)^-1))*integrate(((~q + ~r*((~x)^((1//2)*~n)) + (~x)^~n)^-1)*(~d*~r + (~d - ~e*~q)*((~x)^((1//2)*~n))), ~x) + ((1//2)*((~c)^-1)*((~q)^-1)*((~r)^-1))*integrate(((~q + (~x)^~n - ~r*((~x)^((1//2)*~n)))^-1)*(~d*~r - (~d - ~e*~q)*((~x)^((1//2)*~n))), ~x))) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule integrate(ExpandIntegrand(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^-1), ~x), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule integrate(ExpandIntegrand(((~a + ~c*((~x)^(2~n)))^-1)*((~d + ~e*((~x)^~n))^~q), ~x), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule ((~a*((~e)^2) + ~c*((~d)^2) - ~b*~d*~e)^-1)*integrate((~c*~d - ~b*~e - ~c*~e*((~x)^~n))*((~d + ~e*((~x)^~n))^(1 + ~q))*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^-1), ~x) + ((~e)^2)*((~a*((~e)^2) + ~c*((~d)^2) - ~b*~d*~e)^-1)*integrate((~d + ~e*((~x)^~n))^~q, ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule ~c*((~a*((~e)^2) + ~c*((~d)^2))^-1)*integrate((~d - ~e*((~x)^~n))*((~a + ~c*((~x)^(2~n)))^-1)*((~d + ~e*((~x)^~n))^(1 + ~q)), ~x) + ((~e)^2)*((~a*((~e)^2) + ~c*((~d)^2))^-1)*integrate((~d + ~e*((~x)^~n))^~q, ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~r, Rt((~b)^2 - 4~a*~c, 2))), 2~c*((~r)^-1)*integrate(((~d + ~e*((~x)^~n))^~q)*((~b + 2~c*((~x)^~n) - ~r)^-1), ~x) - 2~c*((~r)^-1)*integrate(((~d + ~e*((~x)^~n))^~q)*((~b + ~r + 2~c*((~x)^~n))^-1), ~x)) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~c*((~x)^~n2))^-1), ~x)

@rule With(List(Set(~r, Rt(-~a*~c, 2))), -~c*((1//2)*((~r)^-1))*integrate(((~d + ~e*((~x)^~n))^~q)*((~r + ~c*((~x)^~n))^-1), ~x) - ~c*((1//2)*((~r)^-1))*integrate(((~d + ~e*((~x)^~n))^~q)*((~r - ~c*((~x)^~n))^-1), ~x)) => integrate((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule (((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4~a*~c)^-1))*integrate(((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^(1 + ~p))*Simp(~d*(1 + ~n + ~n*~p)*((~b)^2) + ~c*(1 + 3~n + 2~n*~p)*((~x)^~n)*(~b*~d - 2~a*~e) - ~a*~b*~e - 2~a*~c*~d*(1 + 2~n + 2~n*~p), ~x), ~x) - ~x*(~d*((~b)^2) + ~c*((~x)^~n)*(~b*~d - 2~a*~e) - ~a*~b*~e - 2~a*~c*~d)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^(1 + ~p))*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*(((~b)^2 - 4~a*~c)^-1)) => integrate((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^~n2))^~p), ~x)

@rule ((1//2)*((~a)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~c*((~x)^(2~n)))^(1 + ~p))*(~d*(1 + 2~n + 2~n*~p) + ~e*(1 + 3~n + 2~n*~p)*((~x)^~n)), ~x) - ~x*(~d + ~e*((~x)^~n))*((~a + ~c*((~x)^(2~n)))^(1 + ~p))*((1//2)*((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(ExpandIntegrand((~d + ~e*((~x)^~n))*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x), ~x) => integrate((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(ExpandIntegrand((~d + ~e*((~x)^~n))*((~a + ~c*((~x)^(2~n)))^~p), ~x), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~c)^~p)*((~x)^(1 + 2~n*~p - ~n))*((~d + ~e*((~x)^~n))^(1 + ~q))*(((~e)^-1)*((1 + ~n*~q + 2~n*~p)^-1)) + integrate(((~d + ~e*((~x)^~n))^~q)*ExpandToSum((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p - ((~c)^~p)*((~x)^(2~n*~p)) - ~d*(1 + 2~n*~p - ~n)*((~c)^~p)*((~x)^(2~n*~p - ~n))*(((~e)^-1)*((1 + ~n*~q + 2~n*~p)^-1)), ~x), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule ((~c)^~p)*((~x)^(1 + 2~n*~p - ~n))*((~d + ~e*((~x)^~n))^(1 + ~q))*(((~e)^-1)*((1 + ~n*~q + 2~n*~p)^-1)) + integrate(((~d + ~e*((~x)^~n))^~q)*ExpandToSum((~a + ~c*((~x)^(2~n)))^~p - ((~c)^~p)*((~x)^(2~n*~p)) - ~d*(1 + 2~n*~p - ~n)*((~c)^~p)*((~x)^(2~n*~p - ~n))*(((~e)^-1)*((1 + ~n*~q + 2~n*~p)^-1)), ~x), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(ExpandIntegrand(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule integrate(ExpandIntegrand(((~a + ~c*((~x)^(2~n)))^~p)*((~d + ~e*((~x)^~n))^~q), ~x), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule integrate(ExpandIntegrand((~a + ~c*((~x)^(2~n)))^~p, (~d*(((~d)^2 - ((~e)^2)*((~x)^(2~n)))^-1) - ~e*((~x)^~n)*(((~d)^2 - ((~e)^2)*((~x)^(2~n)))^-1))^(-~q), ~x), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule Unintegrable(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule Unintegrable(((~a + ~c*((~x)^(2~n)))^~p)*((~d + ~e*((~x)^~n))^~q), ~x) => integrate(((~d + ~e*((~u)^~n))^~q)*((~a + ~b*((~u)^~n) + ~c*((~u)^~n2))^~p), ~x)

@rule (Coefficient(~u, ~x, 1)^-1)*Subst(integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x), ~x, ~u) => integrate(((~d + ~e*((~u)^~n))^~q)*((~a + ~c*((~u)^~n2))^~p), ~x)

@rule (Coefficient(~u, ~x, 1)^-1)*Subst(integrate(((~a + ~c*((~x)^(2~n)))^~p)*((~d + ~e*((~x)^~n))^~q), ~x), ~x, ~u) => integrate(((~d + ~e*((~x)^~mn))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(((~x)^(-~n*~q))*((~e + ~d*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~mn))^~q), ~x)

@rule integrate(((~x)^(~mn*~q))*((~a + ~c*((~x)^~n2))^~p)*((~e + ~d*((~x)^(-~mn)))^~q), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~mn) + ~c*((~x)^~mn2))^~p), ~x)

@rule integrate(((~x)^(-2~n*~p))*((~d + ~e*((~x)^~n))^~q)*((~c + ~b*((~x)^~n) + ~a*((~x)^(2~n)))^~p), ~x) => integrate(((~a + ~c*((~x)^~mn2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule integrate(((~x)^(-2~n*~p))*((~d + ~e*((~x)^~n))^~q)*((~c + ~a*((~x)^(2~n)))^~p), ~x) => integrate(((~d + ~e*((~x)^~mn))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~e)^IntPart(~q))*((~x)^(~n*FracPart(~q)))*((~d + ~e*((~x)^(-~n)))^FracPart(~q))*((1 + ~d*((~e)^-1)*((~x)^~n))^(-FracPart(~q)))*integrate(((~x)^(-~n*~q))*((1 + ~d*((~e)^-1)*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~mn))^~q), ~x)

@rule ((~e)^IntPart(~q))*((~x)^(-~mn*FracPart(~q)))*((1 + ~d*((~e)^-1)*((~x)^(-~mn)))^(-FracPart(~q)))*((~d + ~e*((~x)^~mn))^FracPart(~q))*integrate(((~x)^(~mn*~q))*((~a + ~c*((~x)^~n2))^~p)*((1 + ~d*((~e)^-1)*((~x)^(-~mn)))^~q), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~mn) + ~c*((~x)^~mn2))^~p), ~x)

@rule ((~x)^(2~n*FracPart(~p)))*((~a + ~b*((~x)^(-~n)) + ~c*((~x)^(-2~n)))^FracPart(~p))*((~c + ~b*((~x)^~n) + ~a*((~x)^(2~n)))^(-FracPart(~p)))*integrate(((~x)^(-2~n*~p))*((~d + ~e*((~x)^~n))^~q)*((~c + ~b*((~x)^~n) + ~a*((~x)^(2~n)))^~p), ~x) => integrate(((~a + ~c*((~x)^~mn2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)

@rule ((~x)^(2~n*FracPart(~p)))*((~a + ~c*((~x)^(-2~n)))^FracPart(~p))*((~c + ~a*((~x)^(2~n)))^(-FracPart(~p)))*integrate(((~x)^(-2~n*~p))*((~d + ~e*((~x)^~n))^~q)*((~c + ~a*((~x)^(2~n)))^~p), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~mn) + ~c*((~x)^~n))^~p), ~x)

@rule integrate(((~x)^(-~n*~p))*((~d + ~e*((~x)^~n))^~q)*((~b + ~a*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~mn) + ~c*((~x)^~n))^~p), ~x)

@rule ((~x)^(~n*FracPart(~p)))*((~a + ~c*((~x)^~n) + ~b*((~x)^(-~n)))^FracPart(~p))*((~b + ~a*((~x)^~n) + ~c*((~x)^(2~n)))^(-FracPart(~p)))*integrate(((~x)^(-~n*~p))*((~d + ~e*((~x)^~n))^~q)*((~b + ~a*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~f + ~g*((~x)^~n))^~r)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^FracPart(~p))*(((~b + 2~c*((~x)^~n))^(-2FracPart(~p)))*((4~c)^(-IntPart(~p))))*integrate(((~d + ~e*((~x)^~n))^~q)*((~f + ~g*((~x)^~n))^~r)*((~b + 2~c*((~x)^~n))^(2~p)), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~f + ~g*((~x)^~n))^~r)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~f + ~g*((~x)^~n))^~r)*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q)*((~f + ~g*((~x)^~n))^~r), ~x)

@rule integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~f + ~g*((~x)^~n))^~r)*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate(((~d + ~e*((~x)^~n))^~q)*((~f + ~g*((~x)^~n))^~r)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^FracPart(~p))*(((~d + ~e*((~x)^~n))^(-FracPart(~p)))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^(-FracPart(~p))))*integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~f + ~g*((~x)^~n))^~r)*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate(((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q)*((~f + ~g*((~x)^~n))^~r), ~x)

@rule ((~a + ~c*((~x)^(2~n)))^FracPart(~p))*(((~d + ~e*((~x)^~n))^(-FracPart(~p)))*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^(-FracPart(~p))))*integrate(((~d + ~e*((~x)^~n))^(~p + ~q))*((~f + ~g*((~x)^~n))^~r)*((~a*((~d)^-1) + ~c*((~e)^-1)*((~x)^~n))^~p), ~x) => integrate(((~d1 + ~e1*((~x)^~non2))^~q)*((~d2 + ~e2*((~x)^~non2))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule integrate(((~d1*~d2 + ~e1*~e2*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate(((~d1 + ~e1*((~x)^~non2))^~q)*((~d2 + ~e2*((~x)^~non2))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ((~d1 + ~e1*((~x)^((1//2)*~n)))^FracPart(~q))*((~d2 + ~e2*((~x)^((1//2)*~n)))^FracPart(~q))*((~d1*~d2 + ~e1*~e2*((~x)^~n))^(-FracPart(~q)))*integrate(((~d1*~d2 + ~e1*~e2*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate((~A + ~B*((~x)^~m))*((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^~n2))^~p), ~x)

@rule ~A*integrate(((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) + ~B*integrate(((~x)^~m)*((~d + ~e*((~x)^~n))^~q)*((~a + ~b*((~x)^~n) + ~c*((~x)^(2~n)))^~p), ~x) => integrate((~A + ~B*((~x)^~m))*((~a + ~c*((~x)^~n2))^~p)*((~d + ~e*((~x)^~n))^~q), ~x)


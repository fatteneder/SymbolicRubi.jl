@rule ((~a1 + ~b1*((~x)^((1//2)*~n)))^FracPart(~p))*((~a2 + ~b2*((~x)^((1//2)*~n)))^FracPart(~p))*((~a1*~a2 + ~b1*~b2*((~x)^~n))^(-FracPart(~p)))*integrate(~u*((~a1*~a2 + ~b1*~b2*((~x)^~n))^~p)*((~c + ~d*((~x)^~n) + ~e*((~x)^(2~n)))^~q), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule integrate(ExpandIntegrand(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x), ~x) => integrate((~e + ~f*((~x)^~n))*(((~a + ~b*((~x)^~n))^-1)*((~c + ~d*((~x)^~n))^-1)), ~x)

@rule ((~b*~c - ~a*~d)^-1)*(~b*~e - ~a*~f)*integrate((~a + ~b*((~x)^~n))^-1, ~x) - ((~b*~c - ~a*~d)^-1)*(~d*~e - ~c*~f)*integrate((~c + ~d*((~x)^~n))^-1, ~x) => integrate((~e + ~f*((~x)^~n))*(((~a + ~b*((~x)^~n))^-1)*(sqrt(~c + ~d*((~x)^~n))^-1)), ~x)

@rule ((~b)^-1)*(~b*~e - ~a*~f)*integrate(((~a + ~b*((~x)^~n))*sqrt(~c + ~d*((~x)^~n)))^-1, ~x) + ~f*((~b)^-1)*integrate(sqrt(~c + ~d*((~x)^~n))^-1, ~x) => integrate((~e + ~f*((~x)^~n))*((sqrt(~a + ~b*((~x)^~n))^-1)*(sqrt(~c + ~d*((~x)^~n))^-1)), ~x)

@rule ~f*((~b)^-1)*integrate((sqrt(~c + ~d*((~x)^~n))^-1)*sqrt(~a + ~b*((~x)^~n)), ~x) + ((~b)^-1)*(~b*~e - ~a*~f)*integrate((sqrt(~a + ~b*((~x)^~n))*sqrt(~c + ~d*((~x)^~n)))^-1, ~x) => integrate((~e + ~f*((~x)^2))*(((~c + ~d*((~x)^2))^((-3//1)*(1//2)))*(sqrt(~a + ~b*((~x)^2))^-1)), ~x)

@rule ((~b*~c - ~a*~d)^-1)*(~b*~e - ~a*~f)*integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)))^-1, ~x) - ((~b*~c - ~a*~d)^-1)*(~d*~e - ~c*~f)*integrate(((~c + ~d*((~x)^2))^((-3//1)*(1//2)))*sqrt(~a + ~b*((~x)^2)), ~x) => integrate((~e + ~f*((~x)^~n))*((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule (((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(~q - 1))*Simp(~c*(~b*~e + ~b*~e*~n*(1 + ~p) - ~a*~f) + ~d*((~x)^~n)*((1 + ~n*~q)*(~b*~e - ~a*~f) + ~b*~e*~n*(1 + ~p)), ~x), ~x) + ~x*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^~q)*(~a*~f - ~b*~e)*(((~a)^-1)*((~b)^-1)*((~n)^-1)*((1 + ~p)^-1)) => integrate((~e + ~f*((~x)^~n))*((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule (((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*((~b*~c - ~a*~d)^-1))*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^~q)*Simp(~c*(~b*~e - ~a*~f) + ~e*~n*(1 + ~p)*(~b*~c - ~a*~d) + ~d*((~x)^~n)*(1 + ~n*(2 + ~p + ~q))*(~b*~e - ~a*~f), ~x), ~x) + ~x*((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(1 + ~q))*(~a*~f - ~b*~e)*(((~a)^-1)*((~n)^-1)*((1 + ~p)^-1)*((~b*~c - ~a*~d)^-1)) => integrate((~e + ~f*((~x)^~n))*((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule (((~b)^-1)*((1 + ~n*(1 + ~p + ~q))^-1))*integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^(~q - 1))*Simp(~c*(~b*~e + ~b*~e*~n*(1 + ~p + ~q) - ~a*~f) + (~d*(~b*~e - ~a*~f) + ~f*~n*~q*(~b*~c - ~a*~d) + ~b*~d*~e*~n*(1 + ~p + ~q))*((~x)^~n), ~x), ~x) + ~f*~x*((~a + ~b*((~x)^~n))^(1 + ~p))*(((~b)^-1)*((1 + ~n*(1 + ~p + ~q))^-1))*((~c + ~d*((~x)^~n))^~q) => integrate((~e + ~f*((~x)^4))*(((~a + ~b*((~x)^4))^((-3//1)*(1//4)))*((~c + ~d*((~x)^4))^-1)), ~x)

@rule ((~b*~c - ~a*~d)^-1)*(~b*~e - ~a*~f)*integrate((~a + ~b*((~x)^4))^((-3//1)*(1//4)), ~x) - ((~b*~c - ~a*~d)^-1)*(~d*~e - ~c*~f)*integrate(((~a + ~b*((~x)^4))^(4^-1))*((~c + ~d*((~x)^4))^-1), ~x) => integrate((~e + ~f*((~x)^~n))*((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^-1), ~x)

@rule ~f*((~d)^-1)*integrate((~a + ~b*((~x)^~n))^~p, ~x) + ((~d)^-1)*(~d*~e - ~c*~f)*integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^-1), ~x) => integrate((~e + ~f*((~x)^~n))*((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x)

@rule ~e*integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x) + ~f*integrate(((~x)^~n)*((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q), ~x) => integrate(((~a + ~b*((~x)^2))*(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate(((~a + ~b*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate(((~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) => integrate(((~c + ~d*((~x)^2))*((~x)^2)*sqrt(~e + ~f*((~x)^2)))^-1, ~x)

@rule ((~c)^-1)*integrate((((~x)^2)*sqrt(~e + ~f*((~x)^2)))^-1, ~x) - ~d*((~c)^-1)*integrate(((~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) => integrate(((~a + ~b*((~x)^2))^-1)*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)), ~x)

@rule ((~b)^-1)*(~b*~c - ~a*~d)*integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~e + ~f*((~x)^2)), ~x) + ~d*((~b)^-1)*integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~e + ~f*((~x)^2)), ~x) => integrate(((~a + ~b*((~x)^2))^-1)*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)), ~x)

@rule ((~b)^-1)*(~b*~c - ~a*~d)*integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~e + ~f*((~x)^2)), ~x) + ~d*((~b)^-1)*integrate((sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~e + ~f*((~x)^2)), ~x) => integrate(((~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x)

@rule ~b*((~b*~e - ~a*~f)^-1)*integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~e + ~f*((~x)^2)), ~x) - ~f*((~b*~e - ~a*~f)^-1)*integrate((sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) => integrate(((~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x)

@rule (((~a)^-1)*(sqrt(~c)^-1)*(sqrt(~e)^-1)*(Rt(-~d*((~c)^-1), 2)^-1))*EllipticPi(~b*~c*(((~a)^-1)*((~d)^-1)), ArcSin(~x*Rt(-~d*((~c)^-1), 2)), ~c*~f*(((~d)^-1)*((~e)^-1))) => integrate(((~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x)

@rule (sqrt(~c + ~d*((~x)^2))^-1)*sqrt(1 + ~d*((~c)^-1)*((~x)^2))*integrate(((~a + ~b*((~x)^2))*sqrt(1 + ~d*((~c)^-1)*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) => integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2)), ~x)

@rule ~c*(((~a)^-1)*((~e)^-1)*(sqrt(~c + ~d*((~x)^2))^-1)*(sqrt(~c*(~e + ~f*((~x)^2))*(((~e)^-1)*((~c + ~d*((~x)^2))^-1)))^-1)*(Rt(~d*((~c)^-1), 2)^-1))*sqrt(~e + ~f*((~x)^2))*EllipticPi(1 - ~b*~c*(((~a)^-1)*((~d)^-1)), ArcTan(~x*Rt(~d*((~c)^-1), 2)), 1 - ~c*~f*(((~d)^-1)*((~e)^-1))) => integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2)), ~x)

@rule ~d*((~b)^-1)*integrate((sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) + ((~b)^-1)*(~b*~c - ~a*~d)*integrate(((~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) => integrate((((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^((-3//1)*(1//2))))*sqrt(~e + ~f*((~x)^2)), ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~e + ~f*((~x)^2)), ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate(((~c + ~d*((~x)^2))^((-3//1)*(1//2)))*sqrt(~e + ~f*((~x)^2)), ~x) => integrate(((~e + ~f*((~x)^2))^((3//1)*(1//2)))*(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^((-3//1)*(1//2)))), ~x)

@rule ((~b*~c - ~a*~d)^-1)*(~b*~e - ~a*~f)*integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~e + ~f*((~x)^2)), ~x) - ((~b*~c - ~a*~d)^-1)*(~d*~e - ~c*~f)*integrate(((~c + ~d*((~x)^2))^((-3//1)*(1//2)))*sqrt(~e + ~f*((~x)^2)), ~x) => integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^((3//1)*(1//2)))*sqrt(~e + ~f*((~x)^2)), ~x)

@rule ((~b)^-2)*((~b*~c - ~a*~d)^2)*integrate((((~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~e + ~f*((~x)^2)), ~x) + ~d*((~b)^-2)*integrate((2~b*~c + ~b*~d*((~x)^2) - ~a*~d)*(sqrt(~c + ~d*((~x)^2))^-1)*sqrt(~e + ~f*((~x)^2)), ~x) => integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^~q)*((~e + ~f*((~x)^2))^~r), ~x)

@rule ~b*((~b*~c - ~a*~d)^-2)*(~b*~e - ~a*~f)*integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^(2 + ~q))*((~e + ~f*((~x)^2))^(~r - 1)), ~x) - ((~b*~c - ~a*~d)^-2)*integrate((((~d)^2)*((~x)^2)*(~b*~e - ~a*~f) + 2~b*~c*~d*~e - ~b*~f*((~c)^2) - ~a*~e*((~d)^2))*((~c + ~d*((~x)^2))^~q)*((~e + ~f*((~x)^2))^(~r - 1)), ~x) => integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^~q)*((~e + ~f*((~x)^2))^~r), ~x)

@rule ~d*((~b)^-1)*integrate(((~c + ~d*((~x)^2))^(~q - 1))*((~e + ~f*((~x)^2))^~r), ~x) + ((~b)^-1)*(~b*~c - ~a*~d)*integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^(~q - 1))*((~e + ~f*((~x)^2))^~r), ~x) => integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^~q)*((~e + ~f*((~x)^2))^~r), ~x)

@rule ((~b)^2)*((~b*~c - ~a*~d)^-2)*integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^(2 + ~q))*((~e + ~f*((~x)^2))^~r), ~x) - ~d*((~b*~c - ~a*~d)^-2)*integrate((2~b*~c + ~b*~d*((~x)^2) - ~a*~d)*((~c + ~d*((~x)^2))^~q)*((~e + ~f*((~x)^2))^~r), ~x) => integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^~q)*((~e + ~f*((~x)^2))^~r), ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate(((~a + ~b*((~x)^2))^-1)*((~c + ~d*((~x)^2))^(1 + ~q))*((~e + ~f*((~x)^2))^~r), ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate(((~c + ~d*((~x)^2))^~q)*((~e + ~f*((~x)^2))^~r), ~x) => integrate(((~a + ~b*((~x)^2))^-2)*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)), ~x)

@rule (~c*~e*((~b)^2) - ~d*~f*((~a)^2))*((1//2)*((~a)^-1)*((~b)^-2))*integrate(((~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) + ~x*((1//2)*((~a)^-1)*((~a + ~b*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)) + ~d*~f*((1//2)*((~a)^-1)*((~b)^-2))*integrate((~a - ~b*((~x)^2))*((sqrt(~c + ~d*((~x)^2))^-1)*(sqrt(~e + ~f*((~x)^2))^-1)), ~x) => integrate((((~a + ~b*((~x)^2))^2)*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x)

@rule (~c*~e*((~b)^2) + 3~d*~f*((~a)^2) - 2~a*~b*(~c*~f + ~d*~e))*((1//2)*((~a)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1))*integrate(((~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) + ~x*((~b)^2)*((1//2)*((~a)^-1)*((~a + ~b*((~x)^2))^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)) - ~d*~f*((1//2)*((~a)^-1)*((~b*~c - ~a*~d)^-1)*((~b*~e - ~a*~f)^-1))*integrate((~a + ~b*((~x)^2))*((sqrt(~c + ~d*((~x)^2))^-1)*(sqrt(~e + ~f*((~x)^2))^-1)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule ~d*((~b)^-1)*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^(~q - 1))*((~e + ~f*((~x)^~n))^~r), ~x) + ((~b)^-1)*(~b*~c - ~a*~d)*integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^(~q - 1))*((~e + ~f*((~x)^~n))^~r), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule ~b*((~b*~c - ~a*~d)^-1)*integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^(1 + ~q))*((~e + ~f*((~x)^~n))^~r), ~x) - ~d*((~b*~c - ~a*~d)^-1)*integrate(((~a + ~b*((~x)^~n))^(1 + ~p))*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x) => integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x)

@rule (((~c)^-1)*(sqrt(~e + ~f*((~x)^2))^-1)*(sqrt(~a*(~c + ~d*((~x)^2))*(((~c)^-1)*((~a + ~b*((~x)^2))^-1)))^-1))*sqrt(~c + ~d*((~x)^2))*sqrt(~a*(~e + ~f*((~x)^2))*(((~e)^-1)*((~a + ~b*((~x)^2))^-1)))*Subst(integrate((sqrt(1 - ((~c)^-1)*((~x)^2)*(~b*~c - ~a*~d))*sqrt(1 - ((~e)^-1)*((~x)^2)*(~b*~e - ~a*~f)))^-1, ~x), ~x, ~x*(sqrt(~a + ~b*((~x)^2))^-1)) => integrate(((sqrt(~c + ~d*((~x)^2))^-1)*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~a + ~b*((~x)^2)), ~x)

@rule ~a*(((~c)^-1)*(sqrt(~e + ~f*((~x)^2))^-1)*(sqrt(~a*(~c + ~d*((~x)^2))*(((~c)^-1)*((~a + ~b*((~x)^2))^-1)))^-1))*sqrt(~c + ~d*((~x)^2))*sqrt(~a*(~e + ~f*((~x)^2))*(((~e)^-1)*((~a + ~b*((~x)^2))^-1)))*Subst(integrate(((1 - ~b*((~x)^2))*sqrt(1 - ((~c)^-1)*((~x)^2)*(~b*~c - ~a*~d))*sqrt(1 - ((~e)^-1)*((~x)^2)*(~b*~e - ~a*~f)))^-1, ~x), ~x, ~x*(sqrt(~a + ~b*((~x)^2))^-1)) => integrate((((~a + ~b*((~x)^2))^((-3//1)*(1//2)))*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2)), ~x)

@rule (((~a)^-1)*(sqrt(~e + ~f*((~x)^2))^-1)*(sqrt(~a*(~c + ~d*((~x)^2))*(((~c)^-1)*((~a + ~b*((~x)^2))^-1)))^-1))*sqrt(~c + ~d*((~x)^2))*sqrt(~a*(~e + ~f*((~x)^2))*(((~e)^-1)*((~a + ~b*((~x)^2))^-1)))*Subst(integrate((sqrt(1 - ((~e)^-1)*((~x)^2)*(~b*~e - ~a*~f))^-1)*sqrt(1 - ((~c)^-1)*((~x)^2)*(~b*~c - ~a*~d)), ~x), ~x, ~x*(sqrt(~a + ~b*((~x)^2))^-1)) => integrate((sqrt(~e + ~f*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)), ~x)

@rule ~d*~x*((1//2)*((~f)^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~a + ~b*((~x)^2))*sqrt(~e + ~f*((~x)^2)) + ~b*~c*(~d*~e - ~c*~f)*((1//2)*((~d)^-1)*((~f)^-1))*integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) - (~b*~d*~e - ~b*~c*~f - ~a*~d*~f)*((1//2)*((~d)^-1)*((~f)^-1))*integrate(((sqrt(~a + ~b*((~x)^2))^-1)*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2)), ~x) - ~c*(~d*~e - ~c*~f)*((1//2)*((~f)^-1))*integrate((((~c + ~d*((~x)^2))^((-3//1)*(1//2)))*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~a + ~b*((~x)^2)), ~x) => integrate((sqrt(~e + ~f*((~x)^2))^-1)*sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)), ~x)

@rule ~e*(~b*~e - ~a*~f)*((1//2)*((~f)^-1))*integrate((((~e + ~f*((~x)^2))^((-3//1)*(1//2)))*(sqrt(~a + ~b*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2)), ~x) + (~b*~e - ~a*~f)*(~d*~e - 2~c*~f)*((1//2)*((~f)^-2))*integrate((sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2))*sqrt(~e + ~f*((~x)^2)))^-1, ~x) + ~x*((1//2)*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)) - (~b*~d*~e - ~b*~c*~f - ~a*~d*~f)*((1//2)*((~f)^-2))*integrate(((sqrt(~a + ~b*((~x)^2))^-1)*(sqrt(~c + ~d*((~x)^2))^-1))*sqrt(~e + ~f*((~x)^2)), ~x) => integrate(((~e + ~f*((~x)^2))^((-3//1)*(1//2)))*sqrt(~a + ~b*((~x)^2))*sqrt(~c + ~d*((~x)^2)), ~x)

@rule ~b*((~f)^-1)*integrate(((sqrt(~a + ~b*((~x)^2))^-1)*(sqrt(~e + ~f*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2)), ~x) - ((~f)^-1)*(~b*~e - ~a*~f)*integrate((((~e + ~f*((~x)^2))^((-3//1)*(1//2)))*(sqrt(~a + ~b*((~x)^2))^-1))*sqrt(~c + ~d*((~x)^2)), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule With(List(Set(~u, ExpandIntegrand(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x))), Condition(integrate(~u, ~x), SumQ(~u))) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule -Subst(integrate(((~x)^-2)*((~a + ~b*((~x)^(-~n)))^~p)*((~c + ~d*((~x)^(-~n)))^~q)*((~e + ~f*((~x)^(-~n)))^~r), ~x), ~x, (~x)^-1) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule Unintegrable(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x) => integrate(((~a + ~b*((~u)^~n))^~p)*((~c + ~d*((~v)^~n))^~q)*((~e + ~f*((~w)^~n))^~r), ~x)

@rule (Coefficient(~u, ~x, 1)^-1)*Subst(integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x), ~x, ~u) => integrate(((~c + ~d*((~x)^~mn))^~q)*((~a + ~b*((~x)^~n))^~p)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule integrate(((~x)^(-~n*~q))*((~a + ~b*((~x)^~n))^~p)*((~d + ~c*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x) => integrate(((~c + ~d*((~x)^~mn))^~q)*((~a + ~b*((~x)^~n))^~p)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule integrate(((~x)^(~n*(~p + ~r)))*((~b + ~a*((~x)^(-~n)))^~p)*((~c + ~d*((~x)^(-~n)))^~q)*((~f + ~e*((~x)^(-~n)))^~r), ~x) => integrate(((~c + ~d*((~x)^~mn))^~q)*((~a + ~b*((~x)^~n))^~p)*((~e + ~f*((~x)^~n))^~r), ~x)

@rule ((~x)^(~n*FracPart(~q)))*((~d + ~c*((~x)^~n))^(-FracPart(~q)))*((~c + ~d*((~x)^(-~n)))^FracPart(~q))*integrate(((~x)^(-~n*~q))*((~a + ~b*((~x)^~n))^~p)*((~d + ~c*((~x)^~n))^~q)*((~e + ~f*((~x)^~n))^~r), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e1 + ~f1*((~x)^~n2))^~r)*((~e2 + ~f2*((~x)^~n2))^~r), ~x)

@rule integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e1*~e2 + ~f1*~f2*((~x)^~n))^~r), ~x) => integrate(((~a + ~b*((~x)^~n))^~p)*((~c + ~d*((~x)^~n))^~q)*((~e1 + ~f1*((~x)^~n2))^~r)*((~e2 + ~f2*((~x)^~n2))^~r), ~x)


@rule ((1 + ~b*((~a)^-1)*((~d*cos(~e + ~f*~x) + ~c*sin(~e + ~f*~x))^2))^(-~p))*((~a + ~b*((~d*cos(~e + ~f*~x) + ~c*sin(~e + ~f*~x))^2))^~p)*integrate((1 + ~b*((~a)^-1)*((~d*cos(~e + ~f*~x) + ~c*sin(~e + ~f*~x))^2))^~p, ~x) => integrate(((~a + ~b*(cos(~d + ~e*~x)^~p) + ~c*(sin(~d + ~e*~x)^~q))^~n)*(sin(~d + ~e*~x)^~m), ~x)

@rule Module(List(Set(~f, FreeFactors(cot(~d + ~e*~x), ~x))), -~f*((~e)^-1)*Subst(integrate(((1 + ((~f)^2)*((~x)^2))^(-1 - (1//2)*~m - (1//2)*~n*~q))*(ExpandToSum(~c + ~b*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q - (1//2)*~p)) + ~a*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q)), ~x)^~n), ~x), ~x, ((~f)^-1)*cot(~d + ~e*~x))) => integrate(((~a + ~c*(cos(~d + ~e*~x)^~q) + ~b*(sin(~d + ~e*~x)^~p))^~n)*(cos(~d + ~e*~x)^~m), ~x)

@rule Module(List(Set(~f, FreeFactors(tan(~d + ~e*~x), ~x))), ~f*((~e)^-1)*Subst(integrate(((1 + ((~f)^2)*((~x)^2))^(-1 - (1//2)*~m - (1//2)*~n*~q))*(ExpandToSum(~c + ~b*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q - (1//2)*~p)) + ~a*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q)), ~x)^~n), ~x), ~x, ((~f)^-1)*tan(~d + ~e*~x))) => integrate(((~a + ~b*(cos(~d + ~e*~x)^~p) + ~c*(sin(~d + ~e*~x)^~q))^~n)*(sin(~d + ~e*~x)^~m), ~x)

@rule Module(List(Set(~f, FreeFactors(cot(~d + ~e*~x), ~x))), -~f*((~e)^-1)*Subst(integrate(((1 + ((~f)^2)*((~x)^2))^(-1 - (1//2)*~m - (1//2)*~n*~p))*(ExpandToSum(~c*((1 + ((~f)^2)*((~x)^2))^((1//2)*~p - (1//2)*~q)) + ~a*((1 + ((~f)^2)*((~x)^2))^((1//2)*~p)) + ~b*((~f)^~p)*((~x)^~p), ~x)^~n), ~x), ~x, ((~f)^-1)*cot(~d + ~e*~x))) => integrate(((~a + ~c*(cos(~d + ~e*~x)^~q) + ~b*(sin(~d + ~e*~x)^~p))^~n)*(cos(~d + ~e*~x)^~m), ~x)

@rule Module(List(Set(~f, FreeFactors(tan(~d + ~e*~x), ~x))), ~f*((~e)^-1)*Subst(integrate(((1 + ((~f)^2)*((~x)^2))^(-1 - (1//2)*~m - (1//2)*~n*~p))*(ExpandToSum(~c*((1 + ((~f)^2)*((~x)^2))^((1//2)*~p - (1//2)*~q)) + ~a*((1 + ((~f)^2)*((~x)^2))^((1//2)*~p)) + ~b*((~f)^~p)*((~x)^~p), ~x)^~n), ~x), ~x, ((~f)^-1)*tan(~d + ~e*~x))) => integrate(((~a + ~b*(cos(~d + ~e*~x)^~p) + ~c*(sin(~d + ~e*~x)^~q))^~n)*(sin(~d + ~e*~x)^~m), ~x)

@rule Module(List(Set(~f, FreeFactors(cot(~d + ~e*~x), ~x))), -~f*((~e)^-1)*Subst(integrate(((1 + ((~f)^2)*((~x)^2))^(-1 - (1//2)*~m - (1//2)*~n*~q))*(ExpandToSum(~c + ~b*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q - (1//2)*~p)) + ~a*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q)), ~x)^~n), ~x), ~x, ((~f)^-1)*cot(~d + ~e*~x))) => integrate(((~a + ~c*(cos(~d + ~e*~x)^~q) + ~b*(sin(~d + ~e*~x)^~p))^~n)*(cos(~d + ~e*~x)^~m), ~x)

@rule Module(List(Set(~f, FreeFactors(tan(~d + ~e*~x), ~x))), ~f*((~e)^-1)*Subst(integrate(((1 + ((~f)^2)*((~x)^2))^(-1 - (1//2)*~m - (1//2)*~n*~q))*(ExpandToSum(~c + ~b*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q - (1//2)*~p)) + ~a*((1 + ((~f)^2)*((~x)^2))^((1//2)*~q)), ~x)^~n), ~x), ~x, ((~f)^-1)*tan(~d + ~e*~x))) => integrate(((~a + ~b*(cos(~d + ~e*~x)^~p) + ~c*(sin(~d + ~e*~x)^~q))^~n)*(sin(~d + ~e*~x)^~m), ~x)

@rule Module(List(Set(~f, FreeFactors(cot(~d + ~e*~x), ~x))), -~f*((~e)^-1)*Subst(integrate(((1 + ((~f)^2)*((~x)^2))^(-1 - (1//2)*~m - (1//2)*~n*~p))*(ExpandToSum(~c*((1 + ((~f)^2)*((~x)^2))^((1//2)*~p - (1//2)*~q)) + ~a*((1 + ((~f)^2)*((~x)^2))^((1//2)*~p)) + ~b*((~f)^~p)*((~x)^~p), ~x)^~n), ~x), ~x, ((~f)^-1)*cot(~d + ~e*~x))) => integrate(((~a + ~c*(cos(~d + ~e*~x)^~q) + ~b*(sin(~d + ~e*~x)^~p))^~n)*(cos(~d + ~e*~x)^~m), ~x)

